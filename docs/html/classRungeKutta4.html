<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bodies in Potential Flow: RungeKutta4 Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/ams.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js", "TeX/bm.js", "TeX/bbm.js", "TeX/dsfont.js", "TeX/mathrsfs.js", "TeX/upgreek.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bodies in Potential Flow
   &#160;<span id="projectnumber">2.0-alpha</span>
   </div>
   <div id="projectbrief">Study dynamics of inertial active matter in potential flow (irrotational, incompressible).</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classRungeKutta4.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="classRungeKutta4-members.html">List of all members</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">RungeKutta4 Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Standard Runge-Kutta 4th order integration. </p>
<p>Integrates both velocity and positional degrees of freedom simultaneously from known acceleration components. Orientational components are handled with quaterions and the Udwadia-Kalaba constrained Lagrangian Dynamics formalism is used to ensure unitary norms of each quaternion. The true D.o.F. integrated are those of the body components and individual particle components are calculated via the rigid body motion connectivity tensors. </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00053">53</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for RungeKutta4:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classRungeKutta4__coll__graph.svg" width="1214" height="4000"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a301c6c8b82c9f0808159aff069aef28e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#a301c6c8b82c9f0808159aff069aef28e">RungeKutta4</a> (std::shared_ptr&lt; <a class="el" href="classSystemData.html">SystemData</a> &gt; sys, std::shared_ptr&lt; <a class="el" href="classPotentialHydrodynamics.html">PotentialHydrodynamics</a> &gt; hydro)</td></tr>
<tr class="memdesc:a301c6c8b82c9f0808159aff069aef28e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a new runge Kutta4 object.  <a href="classRungeKutta4.html#a301c6c8b82c9f0808159aff069aef28e">More...</a><br /></td></tr>
<tr class="separator:a301c6c8b82c9f0808159aff069aef28e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2061bc97a56f4f8edd9b5465f1a99a02"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#a2061bc97a56f4f8edd9b5465f1a99a02">~RungeKutta4</a> ()</td></tr>
<tr class="memdesc:a2061bc97a56f4f8edd9b5465f1a99a02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy the runge Kutta4 object.  <a href="classRungeKutta4.html#a2061bc97a56f4f8edd9b5465f1a99a02">More...</a><br /></td></tr>
<tr class="separator:a2061bc97a56f4f8edd9b5465f1a99a02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4826f7efe1f1bbff3918b53c18a8106e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#a4826f7efe1f1bbff3918b53c18a8106e">integrate</a> (const Eigen::ThreadPoolDevice &amp;device)</td></tr>
<tr class="memdesc:a4826f7efe1f1bbff3918b53c18a8106e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Public function to call internal numerical Runge Kutta integration functions.  <a href="classRungeKutta4.html#a4826f7efe1f1bbff3918b53c18a8106e">More...</a><br /></td></tr>
<tr class="separator:a4826f7efe1f1bbff3918b53c18a8106e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a3b7310147342b4a454c6e94dc430a835"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#a3b7310147342b4a454c6e94dc430a835">integrateSecondOrder</a> (const Eigen::ThreadPoolDevice &amp;device)</td></tr>
<tr class="memdesc:a3b7310147342b4a454c6e94dc430a835"><td class="mdescLeft">&#160;</td><td class="mdescRight">2nd order Runge-Kutta 4th order integration. Integrates known acceleration body components into velocity and then positional components.  <a href="classRungeKutta4.html#a3b7310147342b4a454c6e94dc430a835">More...</a><br /></td></tr>
<tr class="separator:a3b7310147342b4a454c6e94dc430a835"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf4bede4af47cdeb464e05fe7f5d1683"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#acf4bede4af47cdeb464e05fe7f5d1683">accelerationUpdate</a> (const double t, Eigen::VectorXd &amp;pos, Eigen::VectorXd &amp;vel, Eigen::VectorXd &amp;acc, const Eigen::ThreadPoolDevice &amp;device)</td></tr>
<tr class="memdesc:acf4bede4af47cdeb464e05fe7f5d1683"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function for <code><a class="el" href="classRungeKutta4.html#a3b7310147342b4a454c6e94dc430a835" title="2nd order Runge-Kutta 4th order integration. Integrates known acceleration body components into veloc...">integrateSecondOrder()</a></code>.  <a href="classRungeKutta4.html#acf4bede4af47cdeb464e05fe7f5d1683">More...</a><br /></td></tr>
<tr class="separator:acf4bede4af47cdeb464e05fe7f5d1683"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc1cc48fea62c46948a51ca2b2000590"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#abc1cc48fea62c46948a51ca2b2000590">imageBodyPosVel</a> (Eigen::VectorXd &amp;pos, Eigen::VectorXd &amp;vel)</td></tr>
<tr class="memdesc:abc1cc48fea62c46948a51ca2b2000590"><td class="mdescLeft">&#160;</td><td class="mdescRight">Replaces 2nd 1/2 of body position and velocity D.o.F. with image of 1st 1/2 assuming the reflection plane is \( z = 0 \).  <a href="classRungeKutta4.html#abc1cc48fea62c46948a51ca2b2000590">More...</a><br /></td></tr>
<tr class="separator:abc1cc48fea62c46948a51ca2b2000590"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a946b31500f95a6cf64ac2a758e88db73"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#a946b31500f95a6cf64ac2a758e88db73">imageBodyAcc</a> (Eigen::VectorXd &amp;acc)</td></tr>
<tr class="memdesc:a946b31500f95a6cf64ac2a758e88db73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Replaces 2nd 1/2 of body acceleration D.o.F. with image of 1st 1/2 assuming the reflection plane is \( z = 0 \).  <a href="classRungeKutta4.html#a946b31500f95a6cf64ac2a758e88db73">More...</a><br /></td></tr>
<tr class="separator:a946b31500f95a6cf64ac2a758e88db73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5d72c5cd59bfcb3a42ab2fbdf92ca0e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#ac5d72c5cd59bfcb3a42ab2fbdf92ca0e">udwadiaKalaba</a> (Eigen::VectorXd &amp;acc)</td></tr>
<tr class="memdesc:ac5d72c5cd59bfcb3a42ab2fbdf92ca0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the body acceleration components given the constraints established by the Udwadia linear system (calculated in the <code><a class="el" href="classSystemData.html" title="Class contains all data structures relevant to the simulation framework. Note that after construction...">SystemData</a></code> class).  <a href="classRungeKutta4.html#ac5d72c5cd59bfcb3a42ab2fbdf92ca0e">More...</a><br /></td></tr>
<tr class="separator:ac5d72c5cd59bfcb3a42ab2fbdf92ca0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acca3997f41542bb0536436fbb64e4b40"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#acca3997f41542bb0536436fbb64e4b40">momForceFree</a> (const Eigen::ThreadPoolDevice &amp;device)</td></tr>
<tr class="memdesc:acca3997f41542bb0536436fbb64e4b40"><td class="mdescLeft">&#160;</td><td class="mdescRight">(linear/angular) momentum and (linear/angular) force free algorithm  <a href="classRungeKutta4.html#acca3997f41542bb0536436fbb64e4b40">More...</a><br /></td></tr>
<tr class="separator:acca3997f41542bb0536436fbb64e4b40"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a0d5a894049797b90958195bd83a0722c"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classSystemData.html">SystemData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a></td></tr>
<tr class="memdesc:a0d5a894049797b90958195bd83a0722c"><td class="mdescLeft">&#160;</td><td class="mdescRight">shared pointer reference to <code><a class="el" href="classSystemData.html" title="Class contains all data structures relevant to the simulation framework. Note that after construction...">SystemData</a></code> class  <a href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">More...</a><br /></td></tr>
<tr class="separator:a0d5a894049797b90958195bd83a0722c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09804a3e700013b77c9aef0067027b15"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classPotentialHydrodynamics.html">PotentialHydrodynamics</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#a09804a3e700013b77c9aef0067027b15">m_potHydro</a></td></tr>
<tr class="memdesc:a09804a3e700013b77c9aef0067027b15"><td class="mdescLeft">&#160;</td><td class="mdescRight">shared pointer reference to <code><a class="el" href="classPotentialHydrodynamics.html" title="Computes hydrodynamic tensors (mass, forces) on a finite number of spheres in potential flow.">PotentialHydrodynamics</a></code> class  <a href="classRungeKutta4.html#a09804a3e700013b77c9aef0067027b15">More...</a><br /></td></tr>
<tr class="separator:a09804a3e700013b77c9aef0067027b15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9114988acc174a2e92361148f511f8e"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#ab9114988acc174a2e92361148f511f8e">m_logFile</a></td></tr>
<tr class="memdesc:ab9114988acc174a2e92361148f511f8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">path of logfile for spdlog to write to  <a href="classRungeKutta4.html#ab9114988acc174a2e92361148f511f8e">More...</a><br /></td></tr>
<tr class="separator:ab9114988acc174a2e92361148f511f8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b86c1434e64019a28d96d00f7b13b59"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a> {&quot;RungeKutta4&quot;}</td></tr>
<tr class="memdesc:a8b86c1434e64019a28d96d00f7b13b59"><td class="mdescLeft">&#160;</td><td class="mdescRight">filename of logfile for spdlog to write to  <a href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">More...</a><br /></td></tr>
<tr class="separator:a8b86c1434e64019a28d96d00f7b13b59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bf8d09edc922a2334145dd51de93384"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#a3bf8d09edc922a2334145dd51de93384">m_dt</a> {-1.0}</td></tr>
<tr class="memdesc:a3bf8d09edc922a2334145dd51de93384"><td class="mdescLeft">&#160;</td><td class="mdescRight">(dimensional) integrator finite time step  <a href="classRungeKutta4.html#a3bf8d09edc922a2334145dd51de93384">More...</a><br /></td></tr>
<tr class="separator:a3bf8d09edc922a2334145dd51de93384"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a57ca17f9753d7699ed707584d922de"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#a9a57ca17f9753d7699ed707584d922de">m_c1_2_dt</a> {-1.0}</td></tr>
<tr class="memdesc:a9a57ca17f9753d7699ed707584d922de"><td class="mdescLeft">&#160;</td><td class="mdescRight">(dimensional) 1/2 integrator finite time step  <a href="classRungeKutta4.html#a9a57ca17f9753d7699ed707584d922de">More...</a><br /></td></tr>
<tr class="separator:a9a57ca17f9753d7699ed707584d922de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acecda2b48d584fc2a3708d3ce4b68363"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#acecda2b48d584fc2a3708d3ce4b68363">m_c1_6_dt</a> {-1.0}</td></tr>
<tr class="memdesc:acecda2b48d584fc2a3708d3ce4b68363"><td class="mdescLeft">&#160;</td><td class="mdescRight">(dimensional) 1/6 integrator finite time step  <a href="classRungeKutta4.html#acecda2b48d584fc2a3708d3ce4b68363">More...</a><br /></td></tr>
<tr class="separator:acecda2b48d584fc2a3708d3ce4b68363"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aece575515484867022bdbb31efc51d5d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#aece575515484867022bdbb31efc51d5d">m_7M</a> {-1}</td></tr>
<tr class="memdesc:aece575515484867022bdbb31efc51d5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">= 7M  <a href="classRungeKutta4.html#aece575515484867022bdbb31efc51d5d">More...</a><br /></td></tr>
<tr class="separator:aece575515484867022bdbb31efc51d5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54c47659c116900eeeedd326863c806e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#a54c47659c116900eeeedd326863c806e">m_body_dof</a> {-1}</td></tr>
<tr class="memdesc:a54c47659c116900eeeedd326863c806e"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of bodies that are "free" (not constrained)  <a href="classRungeKutta4.html#a54c47659c116900eeeedd326863c806e">More...</a><br /></td></tr>
<tr class="separator:a54c47659c116900eeeedd326863c806e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1a8095618bb94f4393894e238879afe"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#ac1a8095618bb94f4393894e238879afe">m_body_dof_7</a> {-1}</td></tr>
<tr class="memdesc:ac1a8095618bb94f4393894e238879afe"><td class="mdescLeft">&#160;</td><td class="mdescRight">= 7 * m_body_dof  <a href="classRungeKutta4.html#ac1a8095618bb94f4393894e238879afe">More...</a><br /></td></tr>
<tr class="separator:ac1a8095618bb94f4393894e238879afe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada6f973c1c4f3ffe1828068dbf9bb328"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#ada6f973c1c4f3ffe1828068dbf9bb328">m_c1_2</a> {0.50}</td></tr>
<tr class="memdesc:ada6f973c1c4f3ffe1828068dbf9bb328"><td class="mdescLeft">&#160;</td><td class="mdescRight">= 1/2  <a href="classRungeKutta4.html#ada6f973c1c4f3ffe1828068dbf9bb328">More...</a><br /></td></tr>
<tr class="separator:ada6f973c1c4f3ffe1828068dbf9bb328"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd5e848badeeeaf90f2e0a3110d16895"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#acd5e848badeeeaf90f2e0a3110d16895">m_c1_6</a> {1.0 / 6.0}</td></tr>
<tr class="memdesc:acd5e848badeeeaf90f2e0a3110d16895"><td class="mdescLeft">&#160;</td><td class="mdescRight">= 1/6  <a href="classRungeKutta4.html#acd5e848badeeeaf90f2e0a3110d16895">More...</a><br /></td></tr>
<tr class="separator:acd5e848badeeeaf90f2e0a3110d16895"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a301c6c8b82c9f0808159aff069aef28e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a301c6c8b82c9f0808159aff069aef28e">&#9670;&nbsp;</a></span>RungeKutta4()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">RungeKutta4::RungeKutta4 </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classSystemData.html">SystemData</a> &gt;&#160;</td>
          <td class="paramname"><em>sys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classPotentialHydrodynamics.html">PotentialHydrodynamics</a> &gt;&#160;</td>
          <td class="paramname"><em>hydro</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Construct a new runge Kutta4 object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sys</td><td><a class="el" href="classSystemData.html" title="Class contains all data structures relevant to the simulation framework. Note that after construction...">SystemData</a> class to gather data from </td></tr>
    <tr><td class="paramname">hydro</td><td><a class="el" href="classPotentialHydrodynamics.html" title="Computes hydrodynamic tensors (mass, forces) on a finite number of spheres in potential flow.">PotentialHydrodynamics</a> class to get hydrodynamic force data from </td></tr>
  </table>
  </dd>
</dl>
<dl class="review"><dt><b><a class="el" href="review.html#_review000002">Review:</a></b></dt><dd>: internal dynamics turned off </dd></dl>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8cpp_source.html#l00007">7</a> of file <a class="el" href="RungeKutta4_8cpp_source.html">RungeKutta4.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;{</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    <span class="comment">// save classes</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>   = sys;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <a class="code" href="classRungeKutta4.html#a09804a3e700013b77c9aef0067027b15">m_potHydro</a> = hydro;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="comment">// initialize logger</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <a class="code" href="classRungeKutta4.html#ab9114988acc174a2e92361148f511f8e">m_logFile</a>   = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;outputDir() + <span class="stringliteral">&quot;/logs/&quot;</span> + <a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a> + <span class="stringliteral">&quot;-log.txt&quot;</span>;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="keyword">auto</span> logger = spdlog::basic_logger_mt(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>, <a class="code" href="classRungeKutta4.html#ab9114988acc174a2e92361148f511f8e">m_logFile</a>);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;info(<span class="stringliteral">&quot;Initializing Runge-Kutta 4th order integrator&quot;</span>);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="comment">// create temporary Eigen device to use for tensor computations in constructor</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;critical(<span class="stringliteral">&quot;Setting up temporary single-thread eigen device&quot;</span>);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;    Eigen::ThreadPool       thread_pool = Eigen::ThreadPool(1);</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    Eigen::ThreadPoolDevice single_core_device(&amp;thread_pool, 1);</div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160; </div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="comment">// Create integrator</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;info(<span class="stringliteral">&quot;Creating integrator&quot;</span>);</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="comment">// initialize member variables</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;info(<span class="stringliteral">&quot;Setting attributes&quot;</span>);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="classRungeKutta4.html#a3bf8d09edc922a2334145dd51de93384">m_dt</a> = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;dt() * <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;tau();</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;info(<span class="stringliteral">&quot;dt (dimensional): {0}&quot;</span>, <a class="code" href="classRungeKutta4.html#a3bf8d09edc922a2334145dd51de93384">m_dt</a>);</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    <a class="code" href="classRungeKutta4.html#a9a57ca17f9753d7699ed707584d922de">m_c1_2_dt</a> = <a class="code" href="classRungeKutta4.html#ada6f973c1c4f3ffe1828068dbf9bb328">m_c1_2</a> * <a class="code" href="classRungeKutta4.html#a3bf8d09edc922a2334145dd51de93384">m_dt</a>;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;info(<span class="stringliteral">&quot;1/2 * dt (dimensional): {0}&quot;</span>, <a class="code" href="classRungeKutta4.html#a9a57ca17f9753d7699ed707584d922de">m_c1_2_dt</a>);</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="classRungeKutta4.html#acecda2b48d584fc2a3708d3ce4b68363">m_c1_6_dt</a> = <a class="code" href="classRungeKutta4.html#acd5e848badeeeaf90f2e0a3110d16895">m_c1_6</a> * <a class="code" href="classRungeKutta4.html#a3bf8d09edc922a2334145dd51de93384">m_dt</a>;</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;info(<span class="stringliteral">&quot;1/6 * dt (dimensional): {0}&quot;</span>, <a class="code" href="classRungeKutta4.html#acecda2b48d584fc2a3708d3ce4b68363">m_c1_6_dt</a>);</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160; </div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <a class="code" href="classRungeKutta4.html#aece575515484867022bdbb31efc51d5d">m_7M</a> = 7 * <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;numBodies();</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;info(<span class="stringliteral">&quot;7M: {0}&quot;</span>, <a class="code" href="classRungeKutta4.html#aece575515484867022bdbb31efc51d5d">m_7M</a>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160; </div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="comment">// degrees of freedom: divide by 2 if using image system</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <a class="code" href="classRungeKutta4.html#a54c47659c116900eeeedd326863c806e">m_body_dof</a> = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;numBodies(); <span class="comment">// = m</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;imageSystem())</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        <a class="code" href="classRungeKutta4.html#a54c47659c116900eeeedd326863c806e">m_body_dof</a> /= 2;</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="classRungeKutta4.html#ac1a8095618bb94f4393894e238879afe">m_body_dof_7</a> = 7 * <a class="code" href="classRungeKutta4.html#a54c47659c116900eeeedd326863c806e">m_body_dof</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;info(<span class="stringliteral">&quot;body_dof: {0}&quot;</span>, <a class="code" href="classRungeKutta4.html#a54c47659c116900eeeedd326863c806e">m_body_dof</a>);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;info(<span class="stringliteral">&quot;body_dof_7: {0}&quot;</span>, <a class="code" href="classRungeKutta4.html#ac1a8095618bb94f4393894e238879afe">m_body_dof_7</a>);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160; </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <span class="comment">// for initial conditions of all locater points, use the PF-free algorithm</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;critical(<span class="stringliteral">&quot;Setting initial conditions using PF-free algorithm.&quot;</span>);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160; </div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> internal_dyn_off{<a class="code" href="helper__math_8h.html#ae4378072f9d836b0d4770a1514db2be3">abs</a>(<a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;sysSpecU0()) &lt; 1e-12};</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160; </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keywordflow">if</span> (internal_dyn_off)</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;warn(<span class="stringliteral">&quot;Setting initial conditions using constant as internal dynamics off&quot;</span>);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        Eigen::VectorXd          vel_body = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;velocitiesBodies();</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">double</span>             vel_init_mag{1.7040237270147573e-07}; <span class="comment">// from isolated swimmer with R_avg = 4.0</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        <span class="keyword">const</span> Eigen::Quaterniond quat_vel_body(0.0, vel_init_mag, 0.0, 0.0);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160; </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> body_id = 0; body_id &lt; <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;numBodies(); body_id++)</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">int</span> body_id_7{7 * body_id};</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            <span class="keyword">const</span> Eigen::Quaterniond quat_body(</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;                <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;positionsBodies()(body_id_7 + 3), <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;positionsBodies()(body_id_7 + 4),</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;                <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;positionsBodies()(body_id_7 + 5), <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;positionsBodies()(body_id_7 + 6));</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keyword">const</span> Eigen::Quaterniond rot_quat_vel_body = quat_body * quat_vel_body * quat_body.inverse();</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            <span class="comment">// rotate vel mag by unit quaternion</span></div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            vel_body.segment&lt;3&gt;(body_id_7).noalias() = rot_quat_vel_body.vec();</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160; </div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <span class="comment">// account for image system</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;imageSystem()) &amp;&amp; (body_id &gt;= <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;numBodies() / 2))</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            {</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                vel_body(body_id_7 + 2) *= -1.0;</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        }</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160; </div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;setVelocitiesBodies(vel_body);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    }</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160; </div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;critical(<span class="stringliteral">&quot;Updating SystemData and PotentialHydrodynamics classes for initial conditions.&quot;</span>);</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;update(single_core_device);   <span class="comment">// update system kinematics and rbm tensors</span></div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <a class="code" href="classRungeKutta4.html#a09804a3e700013b77c9aef0067027b15">m_potHydro</a>-&gt;update(single_core_device); <span class="comment">// update hydrodynamic tensors</span></div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    <span class="keywordflow">if</span> (!internal_dyn_off)</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        <a class="code" href="classRungeKutta4.html#acca3997f41542bb0536436fbb64e4b40">momForceFree</a>(single_core_device); <span class="comment">// set initial body kinematics</span></div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    }</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160; </div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;imageSystem())</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    {</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;info(<span class="stringliteral">&quot;Setting image position, velocity, and acceleration, using real components.&quot;</span>);</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160; </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        Eigen::VectorXd body_pos = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;positionsBodies();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        Eigen::VectorXd body_vel = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;velocitiesBodies();</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        Eigen::VectorXd body_acc = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;accelerationsBodies();</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160; </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <a class="code" href="classRungeKutta4.html#abc1cc48fea62c46948a51ca2b2000590">imageBodyPosVel</a>(body_pos, body_vel);</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <a class="code" href="classRungeKutta4.html#a946b31500f95a6cf64ac2a758e88db73">imageBodyAcc</a>(body_acc);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;setPositionsBodies(body_pos);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;setVelocitiesBodies(body_vel);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;setAccelerationsBodies(body_acc);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    }</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;critical(<span class="stringliteral">&quot;Constructor complete&quot;</span>);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;flush();</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="helper__math_8h_source.html#l01408">abs()</a>, <a class="el" href="RungeKutta4_8cpp_source.html#l00265">imageBodyAcc()</a>, <a class="el" href="RungeKutta4_8cpp_source.html#l00236">imageBodyPosVel()</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00185">m_7M</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00188">m_body_dof</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00190">m_body_dof_7</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00194">m_c1_2</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00179">m_c1_2_dt</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00196">m_c1_6</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00181">m_c1_6_dt</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00177">m_dt</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00171">m_logFile</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00173">m_logName</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00167">m_potHydro</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00165">m_system</a>, and <a class="el" href="RungeKutta4_8cpp_source.html#l00348">momForceFree()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classRungeKutta4_a301c6c8b82c9f0808159aff069aef28e_cgraph.svg" width="702" height="215"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a2061bc97a56f4f8edd9b5465f1a99a02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2061bc97a56f4f8edd9b5465f1a99a02">&#9670;&nbsp;</a></span>~RungeKutta4()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RungeKutta4::~RungeKutta4 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroy the runge Kutta4 object. </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8cpp_source.html#l00115">115</a> of file <a class="el" href="RungeKutta4_8cpp_source.html">RungeKutta4.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;{</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;critical(<span class="stringliteral">&quot;Destructing Runge-Kutta 4th order&quot;</span>);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;flush();</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    spdlog::drop(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RungeKutta4_8hpp_source.html#l00173">m_logName</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a4826f7efe1f1bbff3918b53c18a8106e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4826f7efe1f1bbff3918b53c18a8106e">&#9670;&nbsp;</a></span>integrate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RungeKutta4::integrate </td>
          <td>(</td>
          <td class="paramtype">const Eigen::ThreadPoolDevice &amp;&#160;</td>
          <td class="paramname"><em>device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Public function to call internal numerical Runge Kutta integration functions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">device</td><td><code>Eigen::ThreadPoolDevice</code> to use for <code>Eigen::Tensor</code> computations </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8cpp_source.html#l00123">123</a> of file <a class="el" href="RungeKutta4_8cpp_source.html">RungeKutta4.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;{</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    <a class="code" href="classRungeKutta4.html#a3b7310147342b4a454c6e94dc430a835">integrateSecondOrder</a>(device); <span class="comment">// Udwadia-Kalaba method only gives acceleration components</span></div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RungeKutta4_8cpp_source.html#l00129">integrateSecondOrder()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classRungeKutta4_a4826f7efe1f1bbff3918b53c18a8106e_cgraph.svg" width="899" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a3b7310147342b4a454c6e94dc430a835"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b7310147342b4a454c6e94dc430a835">&#9670;&nbsp;</a></span>integrateSecondOrder()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void RungeKutta4::integrateSecondOrder </td>
          <td>(</td>
          <td class="paramtype">const Eigen::ThreadPoolDevice &amp;&#160;</td>
          <td class="paramname"><em>device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>2nd order Runge-Kutta 4th order integration. Integrates known acceleration body components into velocity and then positional components. </p>
<p>Solve system of form: \( y&#39;(t) = f( y(t), t ) \)</p>
<dl class="section see"><dt>See also</dt><dd><b>Reference:</b> <a href="https://www.physicsforums.com/threads/using-runge-kutta-method-for-position-calc.553663/post-3634957">https://www.physicsforums.com/threads/using-runge-kutta-method-for-position-calc.553663/post-3634957</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">device</td><td><code>Eigen::ThreadPoolDevice</code> to use for <code>Eigen::Tensor</code> computations </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8cpp_source.html#l00129">129</a> of file <a class="el" href="RungeKutta4_8cpp_source.html">RungeKutta4.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;{</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">/* Step 1: k1 = f( y(t_0),  t_0 )</span></div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;<span class="comment">     * initial conditions at current step */</span></div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>    t1{<a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;t()};</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    Eigen::VectorXd v1 = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;velocitiesBodies();</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    Eigen::VectorXd x1 = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;positionsBodies();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160; </div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    Eigen::VectorXd a1 = Eigen::VectorXd::Zero(<a class="code" href="classRungeKutta4.html#aece575515484867022bdbb31efc51d5d">m_7M</a>);</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="classRungeKutta4.html#acf4bede4af47cdeb464e05fe7f5d1683">accelerationUpdate</a>(t1, x1, v1, a1, device);</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">/* Step 2: k2 = f( y(t_0) + k1 * dt/2,  t_0 + dt/2 )</span></div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;<span class="comment">     * time rate-of-change k1 evaluated halfway through time step (midpoint) */</span></div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>    t2{t1 + 0.50 * <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;dt()};</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    Eigen::VectorXd v2 = v1;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    v2.noalias() += <a class="code" href="classRungeKutta4.html#a9a57ca17f9753d7699ed707584d922de">m_c1_2_dt</a> * a1;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    Eigen::VectorXd x2 = x1;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    x2.noalias() += <a class="code" href="classRungeKutta4.html#a9a57ca17f9753d7699ed707584d922de">m_c1_2_dt</a> * v2;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    Eigen::VectorXd a2 = Eigen::VectorXd::Zero(<a class="code" href="classRungeKutta4.html#aece575515484867022bdbb31efc51d5d">m_7M</a>);</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <a class="code" href="classRungeKutta4.html#acf4bede4af47cdeb464e05fe7f5d1683">accelerationUpdate</a>(t2, x2, v2, a2, device);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="comment">/* Step 3: k3 = f( y(t_0) + k2 * dt/2,  t_0 + dt/2 )</span></div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="comment">     * time rate-of-change k2 evaluated halfway through time step (midpoint) */</span></div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>    t3{t2};</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    Eigen::VectorXd v3 = v1;</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    v3.noalias() += <a class="code" href="classRungeKutta4.html#a9a57ca17f9753d7699ed707584d922de">m_c1_2_dt</a> * a2;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    Eigen::VectorXd x3 = x1;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    x3.noalias() += <a class="code" href="classRungeKutta4.html#a9a57ca17f9753d7699ed707584d922de">m_c1_2_dt</a> * v3;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160; </div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    Eigen::VectorXd a3 = Eigen::VectorXd::Zero(<a class="code" href="classRungeKutta4.html#aece575515484867022bdbb31efc51d5d">m_7M</a>);</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="classRungeKutta4.html#acf4bede4af47cdeb464e05fe7f5d1683">accelerationUpdate</a>(t3, x3, v3, a3, device);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="comment">/* Step 4: k4 = f( y(t_0) + k3 * dt,  t_0 + dt )</span></div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="comment">     * time rate-of-change k3 evaluated at end of step (endpoint) */</span></div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>    t4{t1 + <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;dt()};</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    Eigen::VectorXd v4 = v1;</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    v4.noalias() += <a class="code" href="classRungeKutta4.html#a3bf8d09edc922a2334145dd51de93384">m_dt</a> * a3;</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    Eigen::VectorXd x4 = x1;</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    x4.noalias() += <a class="code" href="classRungeKutta4.html#a3bf8d09edc922a2334145dd51de93384">m_dt</a> * v4;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160; </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;    Eigen::VectorXd a4 = Eigen::VectorXd::Zero(<a class="code" href="classRungeKutta4.html#aece575515484867022bdbb31efc51d5d">m_7M</a>);</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    <a class="code" href="classRungeKutta4.html#acf4bede4af47cdeb464e05fe7f5d1683">accelerationUpdate</a>(t4, x4, v4, a4, device);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <span class="comment">/* ANCHOR: Calculate kinematics at end of time step */</span></div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    Eigen::VectorXd v_out = a1;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    v_out.noalias() += 2.0 * a2;</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    v_out.noalias() += 2.0 * a3;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    v_out.noalias() += a4;</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    v_out *= <a class="code" href="classRungeKutta4.html#acecda2b48d584fc2a3708d3ce4b68363">m_c1_6_dt</a>;</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    v_out.noalias() += v1;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    Eigen::VectorXd x_out = v1;</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    x_out.noalias() += 2.0 * v2;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    x_out.noalias() += 2.0 * v3;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    x_out.noalias() += v4;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    x_out *= <a class="code" href="classRungeKutta4.html#acecda2b48d584fc2a3708d3ce4b68363">m_c1_6_dt</a>;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    x_out.noalias() += x1;</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    Eigen::VectorXd a_out = Eigen::VectorXd::Zero(<a class="code" href="classRungeKutta4.html#aece575515484867022bdbb31efc51d5d">m_7M</a>);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="classRungeKutta4.html#acf4bede4af47cdeb464e05fe7f5d1683">accelerationUpdate</a>(t4, x_out, v_out, a_out, device);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// reset system time to t1 as `Engine` class manages updating system time at end of each step</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;setT(t1);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RungeKutta4_8cpp_source.html#l00196">accelerationUpdate()</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00185">m_7M</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00179">m_c1_2_dt</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00181">m_c1_6_dt</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00177">m_dt</a>, and <a class="el" href="RungeKutta4_8hpp_source.html#l00165">m_system</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00123">integrate()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classRungeKutta4_a3b7310147342b4a454c6e94dc430a835_cgraph.svg" width="695" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classRungeKutta4_a3b7310147342b4a454c6e94dc430a835_icgraph.svg" width="415" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="acf4bede4af47cdeb464e05fe7f5d1683"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf4bede4af47cdeb464e05fe7f5d1683">&#9670;&nbsp;</a></span>accelerationUpdate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void RungeKutta4::accelerationUpdate </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>acc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const Eigen::ThreadPoolDevice &amp;&#160;</td>
          <td class="paramname"><em>device</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function for <code><a class="el" href="classRungeKutta4.html#a3b7310147342b4a454c6e94dc430a835" title="2nd order Runge-Kutta 4th order integration. Integrates known acceleration body components into veloc...">integrateSecondOrder()</a></code>. </p>
<p>Function will update simulation time, then system data, then hydrodynamic data, and finally call <code><a class="el" href="classRungeKutta4.html#ac5d72c5cd59bfcb3a42ab2fbdf92ca0e" title="Calculates the body acceleration components given the constraints established by the Udwadia linear s...">udwadiaKalaba()</a></code> to calculate the body acceleration components at a given system time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>current integration time </td></tr>
    <tr><td class="paramname">pos</td><td>body position vector that will be overwritten (if image system) </td></tr>
    <tr><td class="paramname">vel</td><td>body velocity vector that will be overwritten (if image system) </td></tr>
    <tr><td class="paramname">acc</td><td>(output) body acceleration vector that will be overwritten </td></tr>
    <tr><td class="paramname">device</td><td><code>Eigen::ThreadPoolDevice</code> to use for <code>Eigen::Tensor</code> computations </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8cpp_source.html#l00196">196</a> of file <a class="el" href="RungeKutta4_8cpp_source.html">RungeKutta4.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;{</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// NOTE: Order of function calls must remain the same</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;setT(t);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;imageSystem())</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        <a class="code" href="classRungeKutta4.html#abc1cc48fea62c46948a51ca2b2000590">imageBodyPosVel</a>(pos, vel);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    }</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;setPositionsBodies(pos);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;setVelocitiesBodies(vel);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;update(device);</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="classRungeKutta4.html#a09804a3e700013b77c9aef0067027b15">m_potHydro</a>-&gt;update(device);</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;imageSystem())</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="comment">// only update Udwadia system for &quot;real&quot; system not image dipoles</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> num_real_bodies{<a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;numBodies() / 2};</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> num_real_bodies_7{7 * num_real_bodies};</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        Eigen::VectorXd acc_real_body = acc.segment(0, num_real_bodies_7);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160; </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <a class="code" href="classRungeKutta4.html#ac5d72c5cd59bfcb3a42ab2fbdf92ca0e">udwadiaKalaba</a>(acc_real_body);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="comment">// update acceleration components using constraints</span></div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        acc.segment(0, num_real_bodies_7).noalias() = acc_real_body;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <a class="code" href="classRungeKutta4.html#a946b31500f95a6cf64ac2a758e88db73">imageBodyAcc</a>(acc);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    {</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="comment">// update Udwadia system for all bodies</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <a class="code" href="classRungeKutta4.html#ac5d72c5cd59bfcb3a42ab2fbdf92ca0e">udwadiaKalaba</a>(acc);</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;setAccelerationsBodies(acc);</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RungeKutta4_8cpp_source.html#l00265">imageBodyAcc()</a>, <a class="el" href="RungeKutta4_8cpp_source.html#l00236">imageBodyPosVel()</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00167">m_potHydro</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00165">m_system</a>, and <a class="el" href="RungeKutta4_8cpp_source.html#l00284">udwadiaKalaba()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00129">integrateSecondOrder()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classRungeKutta4_acf4bede4af47cdeb464e05fe7f5d1683_cgraph.svg" width="447" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classRungeKutta4_acf4bede4af47cdeb464e05fe7f5d1683_icgraph.svg" width="639" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="abc1cc48fea62c46948a51ca2b2000590"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc1cc48fea62c46948a51ca2b2000590">&#9670;&nbsp;</a></span>imageBodyPosVel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void RungeKutta4::imageBodyPosVel </td>
          <td>(</td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>vel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Replaces 2nd 1/2 of body position and velocity D.o.F. with image of 1st 1/2 assuming the reflection plane is \( z = 0 \). </p>
<dl class="section see"><dt>See also</dt><dd>For discussion of how to invert z-axis of quaternion: <a href="https://stackoverflow.com/a/33999726">https://stackoverflow.com/a/33999726</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pos</td><td>(output) body position vector that will be overwritten </td></tr>
    <tr><td class="paramname">vel</td><td>(output) body velocity vector that will be overwritten </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8cpp_source.html#l00236">236</a> of file <a class="el" href="RungeKutta4_8cpp_source.html">RungeKutta4.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;{</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_img_bodies{<a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;numBodies() / 2};</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160; </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> img_body_id = num_img_bodies; img_body_id &lt; <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;numBodies(); img_body_id++)</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="comment">// `Eigen::Vector` indices</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> real_body_id_7{7 * (img_body_id - num_img_bodies)};</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> img_body_id_7{7 * img_body_id};</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="comment">/* ANCHOR: Position image system: mirror image about xy-plane (transform z --&gt; -z) */</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        pos.segment&lt;7&gt;(img_body_id_7).noalias() = pos.segment&lt;7&gt;(real_body_id_7);</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="comment">// (linear components) flip z component, leave x-y unchanged</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        pos(img_body_id_7 + 2) *= -1;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160; </div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="comment">// (quaternion components) flip x-y components of quaternion vector part (see note in header file: look for &quot;C1</span></div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        <span class="comment">// and C2 are mirrored along the z-axis&quot;)</span></div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        pos.segment&lt;2&gt;(img_body_id_7 + 4) *= -1;</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="comment">/* ANCHOR: Velocity image system: mirror image about xy-plane (transform z --&gt; -z)  */</span></div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        vel.segment&lt;7&gt;(img_body_id_7).noalias() = vel.segment&lt;7&gt;(real_body_id_7);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        vel(img_body_id_7 + 2) *= -1;</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        vel.segment&lt;2&gt;(img_body_id_7 + 4) *= -1;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    }</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RungeKutta4_8hpp_source.html#l00165">m_system</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00196">accelerationUpdate()</a>, and <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classRungeKutta4_abc1cc48fea62c46948a51ca2b2000590_icgraph.svg" width="906" height="104"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a946b31500f95a6cf64ac2a758e88db73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a946b31500f95a6cf64ac2a758e88db73">&#9670;&nbsp;</a></span>imageBodyAcc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void RungeKutta4::imageBodyAcc </td>
          <td>(</td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>acc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Replaces 2nd 1/2 of body acceleration D.o.F. with image of 1st 1/2 assuming the reflection plane is \( z = 0 \). </p>
<dl class="section see"><dt>See also</dt><dd>For discussion of how to invert z-axis of quaternion: <a href="https://stackoverflow.com/a/33999726">https://stackoverflow.com/a/33999726</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">acc</td><td>(output) body acceleration vector that will be overwritten </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8cpp_source.html#l00265">265</a> of file <a class="el" href="RungeKutta4_8cpp_source.html">RungeKutta4.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;{</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_img_bodies{<a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;numBodies() / 2};</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160; </div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> img_body_id = num_img_bodies; img_body_id &lt; <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;numBodies(); img_body_id++)</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    {</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="comment">// `Eigen::Vector` indices</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> real_body_id_7{7 * (img_body_id - num_img_bodies)};</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> img_body_id_7{7 * img_body_id};</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160; </div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        <span class="comment">/* ANCHOR: Acceleration image system: mirror image about xy-plane (transform z --&gt; -z)   */</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        acc.segment&lt;7&gt;(img_body_id_7).noalias() = acc.segment&lt;7&gt;(real_body_id_7);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        acc(img_body_id_7 + 2) *= -1;</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        acc.segment&lt;2&gt;(img_body_id_7 + 4) *= -1;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RungeKutta4_8hpp_source.html#l00165">m_system</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00196">accelerationUpdate()</a>, and <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classRungeKutta4_a946b31500f95a6cf64ac2a758e88db73_icgraph.svg" width="888" height="104"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ac5d72c5cd59bfcb3a42ab2fbdf92ca0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5d72c5cd59bfcb3a42ab2fbdf92ca0e">&#9670;&nbsp;</a></span>udwadiaKalaba()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void RungeKutta4::udwadiaKalaba </td>
          <td>(</td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>acc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the body acceleration components given the constraints established by the Udwadia linear system (calculated in the <code><a class="el" href="classSystemData.html" title="Class contains all data structures relevant to the simulation framework. Note that after construction...">SystemData</a></code> class). </p>
<dl class="section see"><dt>See also</dt><dd><b>Original paper on constrained Lagrangian dynamics:</b> Udwadia, Firdaus E., and Robert E. Kalaba. "A new
perspective on constrained motion." Proceedings of the Royal Society of London. Series A: Mathematical and Physical Sciences 439.1906 (1992): 407-410.</dd>
<dd>
<b>Application of algorithm to unit quaternion vectors:</b> Udwadia, Firdaus E., and Aaron D. Schutte. "An
alternative derivation of the quaternion equations of motion for rigid-body rotational dynamics." (2010): 044505.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">acc</td><td>(output) body acceleration vector that will be overwritten </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8cpp_source.html#l00284">284</a> of file <a class="el" href="RungeKutta4_8cpp_source.html">RungeKutta4.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;{</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="comment">/* NOTE: Following the formalism developed in Udwadia &amp; Kalaba (1992) Proc. R. Soc. Lond. A</span></div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;<span class="comment">     * Solve system of the form M_eff * acc = Q + Q_con</span></div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;<span class="comment">     * Q is the forces present in unconstrained system</span></div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;<span class="comment">     * Q_con is the generalized constraint forces */</span></div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="comment">// calculate Q</span></div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    Eigen::VectorXd Q = Eigen::VectorXd::Zero(<a class="code" href="classRungeKutta4.html#ac1a8095618bb94f4393894e238879afe">m_body_dof_7</a>); <span class="comment">// (7m, 1)</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="comment">// hydrodynamic force</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;fluidDensity() &gt; 0)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        Q.noalias() += <a class="code" href="classRungeKutta4.html#a09804a3e700013b77c9aef0067027b15">m_potHydro</a>-&gt;fHydroNoInertia().segment(0, <a class="code" href="classRungeKutta4.html#ac1a8095618bb94f4393894e238879afe">m_body_dof_7</a>);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="comment">/* calculate Q_con = K (b - A * M_eff^{-1} * Q)</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;<span class="comment">     * Linear constraint system: A * acc = b</span></div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="comment">     * Linear proportionality: K = M_eff^{1/2} * (A * M_eff^{-1/2})^{+};</span></div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="comment">     * + is Moore-Penrose inverse */</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <span class="keyword">const</span> Eigen::MatrixXd M_eff = <a class="code" href="classRungeKutta4.html#a09804a3e700013b77c9aef0067027b15">m_potHydro</a>-&gt;mTotalBodyCoords().block(0, 0, <a class="code" href="classRungeKutta4.html#ac1a8095618bb94f4393894e238879afe">m_body_dof_7</a>, <a class="code" href="classRungeKutta4.html#ac1a8095618bb94f4393894e238879afe">m_body_dof_7</a>); <span class="comment">// (7m, 7m)</span></div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    Eigen::SelfAdjointEigenSolver&lt;Eigen::MatrixXd&gt; eigensolver(M_eff);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">// compute eigen-decomposition of M_eff</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="keywordflow">if</span> (eigensolver.info() != Eigen::Success)</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;error(<span class="stringliteral">&quot;Computing eigendecomposition of effective total mass matrix failed at t={0}&quot;</span>,</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                                      <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;t());</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Computing eigendecomposition of effective total mass matrix failed&quot;</span>);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160; </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    <span class="comment">// verify M is positive semi-definite</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;<span class="preprocessor">#if !defined(NDEBUG)</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    <span class="keywordflow">if</span> (!M_eff.isApprox(M_eff.transpose()) || (eigensolver.eigenvalues().array() &lt; 0.0).any())</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;M_eff is non semi-positive definite matrix!&quot;</span>);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    }</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160; </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    <span class="comment">// calculate M^{1/2} &amp; M^{-1/2}</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keyword">const</span> Eigen::MatrixXd M_eff_halfPower         = eigensolver.operatorSqrt();        <span class="comment">// (7m, 7m)</span></div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="keyword">const</span> Eigen::MatrixXd M_eff_negativeHalfPower = eigensolver.operatorInverseSqrt(); <span class="comment">// (7m, 7m)</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="comment">// calculate K</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keyword">const</span> Eigen::MatrixXd AM_nHalf      = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;udwadiaA() * M_eff_negativeHalfPower; <span class="comment">// (c, 7m) = (c, 7m) (7m, 7m)</span></div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keyword">const</span> Eigen::MatrixXd AM_nHalf_pInv = AM_nHalf.completeOrthogonalDecomposition().pseudoInverse(); <span class="comment">// (7m, c)</span></div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keyword">const</span> Eigen::MatrixXd K             = M_eff_halfPower * AM_nHalf_pInv;                            <span class="comment">// (7m, c)</span></div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160; </div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="comment">// calculate Q_con</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keyword">const</span> Eigen::MatrixXd M_eff_inv   = M_eff.inverse();                   <span class="comment">// (7m, 7m)</span></div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="keyword">const</span> Eigen::MatrixXd M_eff_invQ  = M_eff_inv * Q;                     <span class="comment">// (7m, 1)</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keyword">const</span> Eigen::VectorXd AM_eff_invQ = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;udwadiaA() * M_eff_invQ; <span class="comment">// (c, 1) = (c, 7m) (7m, 1)</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    Eigen::VectorXd       b_tilde     = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;udwadiaB();              <span class="comment">// (c, 1)</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    b_tilde.noalias() -= AM_eff_invQ;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keyword">const</span> Eigen::VectorXd Q_con = K * b_tilde; <span class="comment">// (7m, 1) = (7m, c) (c, 1)</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// calculate accelerations</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    Eigen::VectorXd Q_total = Q; <span class="comment">// (7m, 1)</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    Q_total.noalias() += Q_con;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    acc.noalias() = M_eff_inv * Q_total; <span class="comment">// (7m, 1)</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RungeKutta4_8hpp_source.html#l00190">m_body_dof_7</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00173">m_logName</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00167">m_potHydro</a>, and <a class="el" href="RungeKutta4_8hpp_source.html#l00165">m_system</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00196">accelerationUpdate()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classRungeKutta4_ac5d72c5cd59bfcb3a42ab2fbdf92ca0e_icgraph.svg" width="882" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="acca3997f41542bb0536436fbb64e4b40"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acca3997f41542bb0536436fbb64e4b40">&#9670;&nbsp;</a></span>momForceFree()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void RungeKutta4::momForceFree </td>
          <td>(</td>
          <td class="paramtype">const Eigen::ThreadPoolDevice &amp;&#160;</td>
          <td class="paramname"><em>device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>(linear/angular) momentum and (linear/angular) force free algorithm </p>
<p>before calling this method, make sure to call articulationVel(), articulationAcc(), and rLoc() in systemData class. REVIEW: Only looking at linear components of momentum and force (ignoring the angular and consequently, quaternion components). This is assuming that the initial rotational velocity and acceleration are zero!</p>
<dl class="review"><dt><b><a class="el" href="review.html#_review000003">Review:</a></b></dt><dd>: Assumes that all bodies are collinear and in-phase with one another, If swimmer design changes, the elements taken from M_total must change too </dd></dl>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8cpp_source.html#l00348">348</a> of file <a class="el" href="RungeKutta4_8cpp_source.html">RungeKutta4.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;{</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_particles{3};                   <span class="comment">// Nb</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_particles_3{3 * num_particles}; <span class="comment">// 3 * Nb</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keyword">const</span> Eigen::array&lt;Eigen::Index, 3&gt; extents_333 = {3, 3, 3};</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">/* ANCHOR: Assemble the tensor quantities */</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    Eigen::Matrix&lt;double, 3, -1&gt; rbmconn = Eigen::MatrixXd::Zero(3, num_particles_3); <span class="comment">// (3 x 3 Nb)</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    Eigen::Matrix3d              Id      = Eigen::MatrixXd::Identity(3, 3);</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    Eigen::MatrixXd M_eff = Eigen::MatrixXd::Zero(num_particles_3, num_particles_3); <span class="comment">// (3 Nb x 3 Nb)</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160; </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    Eigen::Tensor&lt;double, 3&gt; grad_M_eff =</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        Eigen::Tensor&lt;double, 3&gt;(num_particles_3, num_particles_3, num_particles_3); <span class="comment">// (3 Nb x 3 Nb x 3 Nb)</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    grad_M_eff.setZero();</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    Eigen::VectorXd vel_artic = Eigen::VectorXd::Zero(num_particles_3); <span class="comment">// (3 Nb x 1)</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    Eigen::VectorXd acc_artic = Eigen::VectorXd::Zero(num_particles_3); <span class="comment">// (3 Nb x 1)</span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> particle_id = 0; particle_id &lt; num_particles; particle_id++)</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    {</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> particle_id_3{3 * particle_id};</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> particle_id_7{7 * particle_id};</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        rbmconn.block&lt;3, 3&gt;(0, particle_id_3).noalias() = Id; <span class="comment">// translation-translation couple</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160; </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; num_particles; j++)</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;        {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            M_eff.block&lt;3, 3&gt;(particle_id_3, 3 * j).noalias() =</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                <a class="code" href="classRungeKutta4.html#a09804a3e700013b77c9aef0067027b15">m_potHydro</a>-&gt;mTotal().block&lt;3, 3&gt;(particle_id_7, 7 * j); <span class="comment">// translation-translation couple</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160; </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; (0 + num_particles); k++)</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            {</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                <span class="keyword">const</span> Eigen::array&lt;Eigen::Index, 3&gt; offsets_3   = {particle_id_3, 3 * j, 3 * k};</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                <span class="keyword">const</span> Eigen::array&lt;Eigen::Index, 3&gt; offsets_773 = {particle_id_7, 7 * j, 3 * k};</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160; </div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                grad_M_eff.slice(offsets_3, extents_333).device(device) =</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                    <a class="code" href="classRungeKutta4.html#a09804a3e700013b77c9aef0067027b15">m_potHydro</a>-&gt;gradMAdded().slice(offsets_773, extents_333);</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;            }</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;        }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160; </div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        vel_artic.segment&lt;3&gt;(particle_id_3).noalias() =</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;velocitiesParticlesArticulation().segment&lt;3&gt;(particle_id_7); <span class="comment">// linear components</span></div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160; </div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        acc_artic.segment&lt;3&gt;(particle_id_3).noalias() =</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;accelerationsParticlesArticulation().segment&lt;3&gt;(particle_id_7); <span class="comment">// linear components</span></div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    }</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160; </div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keyword">const</span> Eigen::Matrix&lt;double, -1, 3&gt; rbmconn_T = rbmconn.transpose();</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160; </div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="comment">/* ANCHOR: Calculate velocity components */</span></div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="comment">// calculate M_tilde = Sigma * M_total * Sigma^T;  (3 x 3)</span></div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="keyword">const</span> Eigen::Matrix&lt;double, -1, 3&gt; M_tilde_hold = M_eff * rbmconn_T;</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keyword">const</span> Eigen::Matrix3d              M_tilde      = rbmconn * M_tilde_hold;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <span class="comment">/* STUB: Solve for rigid body motion velocity components */</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">// calculate P_script = Sigma * M_total * V_articulation;  (3 x 1)</span></div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keyword">const</span> Eigen::VectorXd P_script_hold = M_eff * vel_artic;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keyword">const</span> Eigen::Vector3d P_script      = rbmconn * P_script_hold;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160; </div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="comment">// calculate U_swim = - M_tilde_inv * P_script; U_swim has translation components</span></div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keyword">const</span> Eigen::Vector3d U_swim = -M_tilde.fullPivLu().solve(P_script); <span class="comment">// linear components</span></div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">// convert U_swim to 4d vector for quaternion rotation</span></div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keyword">const</span> Eigen::Quaterniond U_swim_4d(0.0, U_swim(0), U_swim(1), U_swim(2));</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">/* ANCHOR: Output velocity data back to m_system */</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    Eigen::VectorXd vel_body = Eigen::VectorXd::Zero(<a class="code" href="classRungeKutta4.html#aece575515484867022bdbb31efc51d5d">m_7M</a>);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160; </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> body_id = 0; body_id &lt; (<a class="code" href="classRungeKutta4.html#a54c47659c116900eeeedd326863c806e">m_body_dof</a>); body_id++)</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> body_id_7{7 * body_id};</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="comment">// body unit quaternion</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        <span class="keyword">const</span> Eigen::Vector4d    theta = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;positionsBodies().segment&lt;4&gt;(body_id_7 + 3);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        <span class="keyword">const</span> Eigen::Quaterniond theta_body(theta(0), theta(1), theta(2), theta(3));</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        <span class="keyword">const</span> Eigen::Quaterniond U_swim_rot_4d = theta_body * U_swim_4d * theta_body.inverse();</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keyword">const</span> Eigen::Vector3d    U_swim_rot_3d = U_swim_rot_4d.vec();</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160; </div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        vel_body.segment&lt;3&gt;(body_id_7).noalias() = U_swim_rot_3d;</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160; </div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;setVelocitiesBodies(vel_body);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160; </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="comment">/* ANCHOR: Calculate acceleration components */</span></div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;update(device); <span class="comment">// update velocity components with locater motion</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160; </div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    Eigen::VectorXd vel_part = Eigen::VectorXd::Zero(num_particles_3); <span class="comment">// (3 Nb x 1)</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160; </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> particle_id = 0; particle_id &lt; (0 + num_particles); particle_id++)</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    {</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> particle_id_3{3 * particle_id};</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> particle_id_7{7 * particle_id};</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        vel_part.segment&lt;3&gt;(particle_id_3).noalias() =</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;            <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;velocitiesParticles().segment&lt;3&gt;(particle_id_7); <span class="comment">// linear components</span></div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    }</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160; </div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="comment">// convert particle velocities to `Eigen::Tensor`</span></div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    Eigen::Tensor&lt;double, 1&gt; tens_vel_part = Eigen::Tensor&lt;double, 1&gt;(num_particles_3);</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    tens_vel_part.device(device)           = <a class="code" href="helper__eigenTensorConversion_8hpp.html#a3a32f7de3f099464192073a93b34d580">TensorCast</a>(vel_part, num_particles_3);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160; </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="comment">// `Eigen::Tensor` contract indices</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keyword">const</span> Eigen::array&lt;Eigen::IndexPair&lt;int&gt;, 1&gt; contract_ijl_l = {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        Eigen::IndexPair&lt;int&gt;(2, 0)}; <span class="comment">// {i, j, l} . {l} --&gt; {i, j}</span></div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160; </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    <span class="comment">// calculate gradM U</span></div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    Eigen::Tensor&lt;double, 2&gt; tens_gradM_U = Eigen::Tensor&lt;double, 2&gt;(num_particles_3, num_particles_3);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    tens_gradM_U.device(device)           = grad_M_eff.contract(tens_vel_part, contract_ijl_l);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="keyword">const</span> Eigen::MatrixXd gradM_U         = <a class="code" href="helper__eigenTensorConversion_8hpp.html#a556d08b55a6ad7cd703b6db06194e5cf">MatrixCast</a>(tens_gradM_U, num_particles_3, num_particles_3, device);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160; </div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <span class="comment">/* STUB: Solve for rigid body motion velocity components */</span></div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    <span class="comment">// calculate F_script = Sigma * (M_total * A_articulation + (gradM U) U);  (3 x 1)</span></div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    Eigen::VectorXd F_script_hold = M_eff * acc_artic;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    F_script_hold.noalias() += gradM_U * vel_part;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <span class="keyword">const</span> Eigen::Vector3d F_script = rbmconn * F_script_hold;</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160; </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <span class="comment">// calculate A_swim = - M_tilde_inv * P_script; A_swim has translation components</span></div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keyword">const</span> Eigen::Vector3d A_swim = -M_tilde.fullPivLu().solve(F_script); <span class="comment">// linear components</span></div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160; </div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">// convert A_swim to 4d vector for quaternion rotation</span></div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    Eigen::Quaterniond A_swim_4d(0.0, A_swim(0), A_swim(1), A_swim(2));</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">/* ANCHOR: Output velocity data back to m_system */</span></div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    Eigen::VectorXd acc_body = Eigen::VectorXd::Zero(<a class="code" href="classRungeKutta4.html#aece575515484867022bdbb31efc51d5d">m_7M</a>);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160; </div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> body_id = 0; body_id &lt; (<a class="code" href="classRungeKutta4.html#a54c47659c116900eeeedd326863c806e">m_body_dof</a>); body_id++)</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    {</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> body_id_7{7 * body_id};</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="comment">// body unit quaternion</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <span class="keyword">const</span> Eigen::Vector4d    theta = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;positionsBodies().segment&lt;4&gt;(body_id_7 + 3);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <span class="keyword">const</span> Eigen::Quaterniond theta_body(theta(0), theta(1), theta(2), theta(3));</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160; </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="keyword">const</span> Eigen::Quaterniond A_swim_rot_4d = theta_body * A_swim_4d * theta_body.inverse();</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keyword">const</span> Eigen::Vector3d    A_swim_rot_3d = A_swim_rot_4d.vec();</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        acc_body.segment&lt;3&gt;(body_id_7).noalias() = A_swim_rot_3d;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    }</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160; </div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;setAccelerationsBodies(acc_body);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;update(device); <span class="comment">// update acceleration components with locater motion</span></div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RungeKutta4_8hpp_source.html#l00185">m_7M</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00188">m_body_dof</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00167">m_potHydro</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00165">m_system</a>, <a class="el" href="helper__eigenTensorConversion_8hpp_source.html#l00120">MatrixCast()</a>, and <a class="el" href="helper__eigenTensorConversion_8hpp_source.html#l00177">TensorCast()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classRungeKutta4_acca3997f41542bb0536436fbb64e4b40_cgraph.svg" width="454" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classRungeKutta4_acca3997f41542bb0536436fbb64e4b40_icgraph.svg" width="436" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a0d5a894049797b90958195bd83a0722c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d5a894049797b90958195bd83a0722c">&#9670;&nbsp;</a></span>m_system</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="classSystemData.html">SystemData</a>&gt; RungeKutta4::m_system</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>shared pointer reference to <code><a class="el" href="classSystemData.html" title="Class contains all data structures relevant to the simulation framework. Note that after construction...">SystemData</a></code> class </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00165">165</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00196">accelerationUpdate()</a>, <a class="el" href="RungeKutta4_8cpp_source.html#l00265">imageBodyAcc()</a>, <a class="el" href="RungeKutta4_8cpp_source.html#l00236">imageBodyPosVel()</a>, <a class="el" href="RungeKutta4_8cpp_source.html#l00129">integrateSecondOrder()</a>, <a class="el" href="RungeKutta4_8cpp_source.html#l00348">momForceFree()</a>, <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>, and <a class="el" href="RungeKutta4_8cpp_source.html#l00284">udwadiaKalaba()</a>.</p>

</div>
</div>
<a id="a09804a3e700013b77c9aef0067027b15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09804a3e700013b77c9aef0067027b15">&#9670;&nbsp;</a></span>m_potHydro</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="classPotentialHydrodynamics.html">PotentialHydrodynamics</a>&gt; RungeKutta4::m_potHydro</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>shared pointer reference to <code><a class="el" href="classPotentialHydrodynamics.html" title="Computes hydrodynamic tensors (mass, forces) on a finite number of spheres in potential flow.">PotentialHydrodynamics</a></code> class </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00167">167</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00196">accelerationUpdate()</a>, <a class="el" href="RungeKutta4_8cpp_source.html#l00348">momForceFree()</a>, <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>, and <a class="el" href="RungeKutta4_8cpp_source.html#l00284">udwadiaKalaba()</a>.</p>

</div>
</div>
<a id="ab9114988acc174a2e92361148f511f8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9114988acc174a2e92361148f511f8e">&#9670;&nbsp;</a></span>m_logFile</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string RungeKutta4::m_logFile</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>path of logfile for spdlog to write to </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00171">171</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>.</p>

</div>
</div>
<a id="a8b86c1434e64019a28d96d00f7b13b59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b86c1434e64019a28d96d00f7b13b59">&#9670;&nbsp;</a></span>m_logName</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string RungeKutta4::m_logName {&quot;RungeKutta4&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>filename of logfile for spdlog to write to </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00173">173</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>, <a class="el" href="RungeKutta4_8cpp_source.html#l00284">udwadiaKalaba()</a>, and <a class="el" href="RungeKutta4_8cpp_source.html#l00115">~RungeKutta4()</a>.</p>

</div>
</div>
<a id="a3bf8d09edc922a2334145dd51de93384"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bf8d09edc922a2334145dd51de93384">&#9670;&nbsp;</a></span>m_dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double RungeKutta4::m_dt {-1.0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>(dimensional) integrator finite time step </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00177">177</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00129">integrateSecondOrder()</a>, and <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>.</p>

</div>
</div>
<a id="a9a57ca17f9753d7699ed707584d922de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a57ca17f9753d7699ed707584d922de">&#9670;&nbsp;</a></span>m_c1_2_dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double RungeKutta4::m_c1_2_dt {-1.0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>(dimensional) 1/2 integrator finite time step </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00179">179</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00129">integrateSecondOrder()</a>, and <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>.</p>

</div>
</div>
<a id="acecda2b48d584fc2a3708d3ce4b68363"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acecda2b48d584fc2a3708d3ce4b68363">&#9670;&nbsp;</a></span>m_c1_6_dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double RungeKutta4::m_c1_6_dt {-1.0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>(dimensional) 1/6 integrator finite time step </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00181">181</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00129">integrateSecondOrder()</a>, and <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>.</p>

</div>
</div>
<a id="aece575515484867022bdbb31efc51d5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aece575515484867022bdbb31efc51d5d">&#9670;&nbsp;</a></span>m_7M</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int RungeKutta4::m_7M {-1}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>= 7M </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00185">185</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00129">integrateSecondOrder()</a>, <a class="el" href="RungeKutta4_8cpp_source.html#l00348">momForceFree()</a>, and <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>.</p>

</div>
</div>
<a id="a54c47659c116900eeeedd326863c806e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a54c47659c116900eeeedd326863c806e">&#9670;&nbsp;</a></span>m_body_dof</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int RungeKutta4::m_body_dof {-1}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>number of bodies that are "free" (not constrained) </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00188">188</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00348">momForceFree()</a>, and <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>.</p>

</div>
</div>
<a id="ac1a8095618bb94f4393894e238879afe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1a8095618bb94f4393894e238879afe">&#9670;&nbsp;</a></span>m_body_dof_7</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int RungeKutta4::m_body_dof_7 {-1}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>= 7 * m_body_dof </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00190">190</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>, and <a class="el" href="RungeKutta4_8cpp_source.html#l00284">udwadiaKalaba()</a>.</p>

</div>
</div>
<a id="ada6f973c1c4f3ffe1828068dbf9bb328"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada6f973c1c4f3ffe1828068dbf9bb328">&#9670;&nbsp;</a></span>m_c1_2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double RungeKutta4::m_c1_2 {0.50}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>= 1/2 </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00194">194</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>.</p>

</div>
</div>
<a id="acd5e848badeeeaf90f2e0a3110d16895"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd5e848badeeeaf90f2e0a3110d16895">&#9670;&nbsp;</a></span>m_c1_6</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double RungeKutta4::m_c1_6 {1.0 / 6.0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>= 1/6 </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00196">196</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/integrators/<a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a></li>
<li>src/integrators/<a class="el" href="RungeKutta4_8cpp_source.html">RungeKutta4.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclassRungeKutta4_html_a3bf8d09edc922a2334145dd51de93384"><div class="ttname"><a href="classRungeKutta4.html#a3bf8d09edc922a2334145dd51de93384">RungeKutta4::m_dt</a></div><div class="ttdeci">double m_dt</div><div class="ttdoc">(dimensional) integrator finite time step</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8hpp_source.html#l00177">RungeKutta4.hpp:177</a></div></div>
<div class="ttc" id="ahelper__eigenTensorConversion_8hpp_html_a556d08b55a6ad7cd703b6db06194e5cf"><div class="ttname"><a href="helper__eigenTensorConversion_8hpp.html#a556d08b55a6ad7cd703b6db06194e5cf">MatrixCast</a></div><div class="ttdeci">auto MatrixCast(const Eigen::TensorBase&lt; T, Eigen::ReadOnlyAccessors &gt; &amp;expr, const sizeType rows, const sizeType cols, const Device &amp;device=Device())</div><div class="ttdef"><b>Definition:</b> <a href="helper__eigenTensorConversion_8hpp_source.html#l00120">helper_eigenTensorConversion.hpp:120</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_abc1cc48fea62c46948a51ca2b2000590"><div class="ttname"><a href="classRungeKutta4.html#abc1cc48fea62c46948a51ca2b2000590">RungeKutta4::imageBodyPosVel</a></div><div class="ttdeci">void imageBodyPosVel(Eigen::VectorXd &amp;pos, Eigen::VectorXd &amp;vel)</div><div class="ttdoc">Replaces 2nd 1/2 of body position and velocity D.o.F. with image of 1st 1/2 assuming the reflection p...</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8cpp_source.html#l00236">RungeKutta4.cpp:236</a></div></div>
<div class="ttc" id="ahelper__eigenTensorConversion_8hpp_html_a3a32f7de3f099464192073a93b34d580"><div class="ttname"><a href="helper__eigenTensorConversion_8hpp.html#a3a32f7de3f099464192073a93b34d580">TensorCast</a></div><div class="ttdeci">Eigen::Tensor&lt; typename Derived::Scalar, rank &gt; TensorCast(const Eigen::EigenBase&lt; Derived &gt; &amp;matrix, const std::array&lt; T, rank &gt; &amp;dims)</div><div class="ttdoc">Convert Eigen::Matrix --&gt; Eigen::Tensor.</div><div class="ttdef"><b>Definition:</b> <a href="helper__eigenTensorConversion_8hpp_source.html#l00177">helper_eigenTensorConversion.hpp:177</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_a0d5a894049797b90958195bd83a0722c"><div class="ttname"><a href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">RungeKutta4::m_system</a></div><div class="ttdeci">std::shared_ptr&lt; SystemData &gt; m_system</div><div class="ttdoc">shared pointer reference to SystemData class</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8hpp_source.html#l00165">RungeKutta4.hpp:165</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_a9a57ca17f9753d7699ed707584d922de"><div class="ttname"><a href="classRungeKutta4.html#a9a57ca17f9753d7699ed707584d922de">RungeKutta4::m_c1_2_dt</a></div><div class="ttdeci">double m_c1_2_dt</div><div class="ttdoc">(dimensional) 1/2 integrator finite time step</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8hpp_source.html#l00179">RungeKutta4.hpp:179</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_acf4bede4af47cdeb464e05fe7f5d1683"><div class="ttname"><a href="classRungeKutta4.html#acf4bede4af47cdeb464e05fe7f5d1683">RungeKutta4::accelerationUpdate</a></div><div class="ttdeci">void accelerationUpdate(const double t, Eigen::VectorXd &amp;pos, Eigen::VectorXd &amp;vel, Eigen::VectorXd &amp;acc, const Eigen::ThreadPoolDevice &amp;device)</div><div class="ttdoc">Helper function for integrateSecondOrder().</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8cpp_source.html#l00196">RungeKutta4.cpp:196</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_acecda2b48d584fc2a3708d3ce4b68363"><div class="ttname"><a href="classRungeKutta4.html#acecda2b48d584fc2a3708d3ce4b68363">RungeKutta4::m_c1_6_dt</a></div><div class="ttdeci">double m_c1_6_dt</div><div class="ttdoc">(dimensional) 1/6 integrator finite time step</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8hpp_source.html#l00181">RungeKutta4.hpp:181</a></div></div>
<div class="ttc" id="ahelper__math_8h_html_ae4378072f9d836b0d4770a1514db2be3"><div class="ttname"><a href="helper__math_8h.html#ae4378072f9d836b0d4770a1514db2be3">abs</a></div><div class="ttdeci">__host__ __device__ int2 abs(int2 v)</div><div class="ttdef"><b>Definition:</b> <a href="helper__math_8h_source.html#l01408">helper_math.h:1408</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_acca3997f41542bb0536436fbb64e4b40"><div class="ttname"><a href="classRungeKutta4.html#acca3997f41542bb0536436fbb64e4b40">RungeKutta4::momForceFree</a></div><div class="ttdeci">void momForceFree(const Eigen::ThreadPoolDevice &amp;device)</div><div class="ttdoc">(linear/angular) momentum and (linear/angular) force free algorithm</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8cpp_source.html#l00348">RungeKutta4.cpp:348</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_ada6f973c1c4f3ffe1828068dbf9bb328"><div class="ttname"><a href="classRungeKutta4.html#ada6f973c1c4f3ffe1828068dbf9bb328">RungeKutta4::m_c1_2</a></div><div class="ttdeci">const double m_c1_2</div><div class="ttdoc">= 1/2</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8hpp_source.html#l00194">RungeKutta4.hpp:194</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_ac5d72c5cd59bfcb3a42ab2fbdf92ca0e"><div class="ttname"><a href="classRungeKutta4.html#ac5d72c5cd59bfcb3a42ab2fbdf92ca0e">RungeKutta4::udwadiaKalaba</a></div><div class="ttdeci">void udwadiaKalaba(Eigen::VectorXd &amp;acc)</div><div class="ttdoc">Calculates the body acceleration components given the constraints established by the Udwadia linear s...</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8cpp_source.html#l00284">RungeKutta4.cpp:284</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_ab9114988acc174a2e92361148f511f8e"><div class="ttname"><a href="classRungeKutta4.html#ab9114988acc174a2e92361148f511f8e">RungeKutta4::m_logFile</a></div><div class="ttdeci">std::string m_logFile</div><div class="ttdoc">path of logfile for spdlog to write to</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8hpp_source.html#l00171">RungeKutta4.hpp:171</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_a54c47659c116900eeeedd326863c806e"><div class="ttname"><a href="classRungeKutta4.html#a54c47659c116900eeeedd326863c806e">RungeKutta4::m_body_dof</a></div><div class="ttdeci">int m_body_dof</div><div class="ttdoc">number of bodies that are &quot;free&quot; (not constrained)</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8hpp_source.html#l00188">RungeKutta4.hpp:188</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_a09804a3e700013b77c9aef0067027b15"><div class="ttname"><a href="classRungeKutta4.html#a09804a3e700013b77c9aef0067027b15">RungeKutta4::m_potHydro</a></div><div class="ttdeci">std::shared_ptr&lt; PotentialHydrodynamics &gt; m_potHydro</div><div class="ttdoc">shared pointer reference to PotentialHydrodynamics class</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8hpp_source.html#l00167">RungeKutta4.hpp:167</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_a946b31500f95a6cf64ac2a758e88db73"><div class="ttname"><a href="classRungeKutta4.html#a946b31500f95a6cf64ac2a758e88db73">RungeKutta4::imageBodyAcc</a></div><div class="ttdeci">void imageBodyAcc(Eigen::VectorXd &amp;acc)</div><div class="ttdoc">Replaces 2nd 1/2 of body acceleration D.o.F. with image of 1st 1/2 assuming the reflection plane is .</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8cpp_source.html#l00265">RungeKutta4.cpp:265</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_a3b7310147342b4a454c6e94dc430a835"><div class="ttname"><a href="classRungeKutta4.html#a3b7310147342b4a454c6e94dc430a835">RungeKutta4::integrateSecondOrder</a></div><div class="ttdeci">void integrateSecondOrder(const Eigen::ThreadPoolDevice &amp;device)</div><div class="ttdoc">2nd order Runge-Kutta 4th order integration. Integrates known acceleration body components into veloc...</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8cpp_source.html#l00129">RungeKutta4.cpp:129</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_a8b86c1434e64019a28d96d00f7b13b59"><div class="ttname"><a href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">RungeKutta4::m_logName</a></div><div class="ttdeci">const std::string m_logName</div><div class="ttdoc">filename of logfile for spdlog to write to</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8hpp_source.html#l00173">RungeKutta4.hpp:173</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_ac1a8095618bb94f4393894e238879afe"><div class="ttname"><a href="classRungeKutta4.html#ac1a8095618bb94f4393894e238879afe">RungeKutta4::m_body_dof_7</a></div><div class="ttdeci">int m_body_dof_7</div><div class="ttdoc">= 7 * m_body_dof</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8hpp_source.html#l00190">RungeKutta4.hpp:190</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_acd5e848badeeeaf90f2e0a3110d16895"><div class="ttname"><a href="classRungeKutta4.html#acd5e848badeeeaf90f2e0a3110d16895">RungeKutta4::m_c1_6</a></div><div class="ttdeci">const double m_c1_6</div><div class="ttdoc">= 1/6</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8hpp_source.html#l00196">RungeKutta4.hpp:196</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_aece575515484867022bdbb31efc51d5d"><div class="ttname"><a href="classRungeKutta4.html#aece575515484867022bdbb31efc51d5d">RungeKutta4::m_7M</a></div><div class="ttdeci">int m_7M</div><div class="ttdoc">= 7M</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8hpp_source.html#l00185">RungeKutta4.hpp:185</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classRungeKutta4.html">RungeKutta4</a></li>
    <li class="footer">Generated on Wed Dec 1 2021 15:15:38 for Bodies in Potential Flow by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
