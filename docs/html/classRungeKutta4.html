<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Bodies in Potential Flow: RungeKutta4 Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/ams.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js", "TeX/bm.js", "TeX/bbm.js", "TeX/dsfont.js", "TeX/mathrsfs.js", "TeX/upgreek.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Bodies in Potential Flow
   &#160;<span id="projectnumber">2.0-alpha</span>
   </div>
   <div id="projectbrief">Study dynamics of inertial active matter in potential flow (irrotational, incompressible).</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('classRungeKutta4.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="classRungeKutta4-members.html">List of all members</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a>  </div>
  <div class="headertitle">
<div class="title">RungeKutta4 Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Standard Runge-Kutta 4th order integration. </p>
<p>Integrates both velocity and positional degrees of freedom simultaneously from known acceleration components. Orientational components are handled with quaterions and the Udwadia-Kalaba constrained Lagrangian Dynamics formalism is used to ensure unitary norms of each quaternion. The true D.o.F. integrated are those of the body components and individual particle components are calculated via the rigid body motion connectivity tensors. </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00053">53</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>
</div>
<p><code>#include &lt;<a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for RungeKutta4:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classRungeKutta4__coll__graph.svg" width="1214" height="3751"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a301c6c8b82c9f0808159aff069aef28e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#a301c6c8b82c9f0808159aff069aef28e">RungeKutta4</a> (std::shared_ptr&lt; <a class="el" href="classSystemData.html">SystemData</a> &gt; sys, std::shared_ptr&lt; <a class="el" href="classPotentialHydrodynamics.html">PotentialHydrodynamics</a> &gt; hydro)</td></tr>
<tr class="memdesc:a301c6c8b82c9f0808159aff069aef28e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Construct a new runge Kutta4 object.  <a href="classRungeKutta4.html#a301c6c8b82c9f0808159aff069aef28e">More...</a><br /></td></tr>
<tr class="separator:a301c6c8b82c9f0808159aff069aef28e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2061bc97a56f4f8edd9b5465f1a99a02"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#a2061bc97a56f4f8edd9b5465f1a99a02">~RungeKutta4</a> ()</td></tr>
<tr class="memdesc:a2061bc97a56f4f8edd9b5465f1a99a02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destroy the runge Kutta4 object.  <a href="classRungeKutta4.html#a2061bc97a56f4f8edd9b5465f1a99a02">More...</a><br /></td></tr>
<tr class="separator:a2061bc97a56f4f8edd9b5465f1a99a02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a442be59b7291fd57895e5900ff9dccd8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#a442be59b7291fd57895e5900ff9dccd8">integrate</a> (Eigen::ThreadPoolDevice &amp;device)</td></tr>
<tr class="memdesc:a442be59b7291fd57895e5900ff9dccd8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Public function to call internal numerical Runge Kutta integration functions.  <a href="classRungeKutta4.html#a442be59b7291fd57895e5900ff9dccd8">More...</a><br /></td></tr>
<tr class="separator:a442be59b7291fd57895e5900ff9dccd8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a62b7028de266e35a88e1cd4f8e588fd5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#a62b7028de266e35a88e1cd4f8e588fd5">integrateSecondOrder</a> (Eigen::ThreadPoolDevice &amp;device)</td></tr>
<tr class="memdesc:a62b7028de266e35a88e1cd4f8e588fd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">2nd order Runge-Kutta 4th order integration. Integrates known acceleration body components into velocity and then positional components.  <a href="classRungeKutta4.html#a62b7028de266e35a88e1cd4f8e588fd5">More...</a><br /></td></tr>
<tr class="separator:a62b7028de266e35a88e1cd4f8e588fd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa9be7a023f272032338d223d900c4c5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#aaa9be7a023f272032338d223d900c4c5">accelerationUpdate</a> (const double t, Eigen::VectorXd &amp;pos, Eigen::VectorXd &amp;vel, Eigen::VectorXd &amp;acc, Eigen::ThreadPoolDevice &amp;device)</td></tr>
<tr class="memdesc:aaa9be7a023f272032338d223d900c4c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Helper function for <code><a class="el" href="classRungeKutta4.html#a62b7028de266e35a88e1cd4f8e588fd5" title="2nd order Runge-Kutta 4th order integration. Integrates known acceleration body components into veloc...">integrateSecondOrder()</a></code>.  <a href="classRungeKutta4.html#aaa9be7a023f272032338d223d900c4c5">More...</a><br /></td></tr>
<tr class="separator:aaa9be7a023f272032338d223d900c4c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc1cc48fea62c46948a51ca2b2000590"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#abc1cc48fea62c46948a51ca2b2000590">imageBodyPosVel</a> (Eigen::VectorXd &amp;pos, Eigen::VectorXd &amp;vel)</td></tr>
<tr class="memdesc:abc1cc48fea62c46948a51ca2b2000590"><td class="mdescLeft">&#160;</td><td class="mdescRight">Replaces 2nd 1/2 of body position and velocity D.o.F. with image of 1st 1/2 assuming the reflection plane is \( z = 0 \).  <a href="classRungeKutta4.html#abc1cc48fea62c46948a51ca2b2000590">More...</a><br /></td></tr>
<tr class="separator:abc1cc48fea62c46948a51ca2b2000590"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a946b31500f95a6cf64ac2a758e88db73"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#a946b31500f95a6cf64ac2a758e88db73">imageBodyAcc</a> (Eigen::VectorXd &amp;acc)</td></tr>
<tr class="memdesc:a946b31500f95a6cf64ac2a758e88db73"><td class="mdescLeft">&#160;</td><td class="mdescRight">Replaces 2nd 1/2 of body acceleration D.o.F. with image of 1st 1/2 assuming the reflection plane is \( z = 0 \).  <a href="classRungeKutta4.html#a946b31500f95a6cf64ac2a758e88db73">More...</a><br /></td></tr>
<tr class="separator:a946b31500f95a6cf64ac2a758e88db73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5d72c5cd59bfcb3a42ab2fbdf92ca0e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#ac5d72c5cd59bfcb3a42ab2fbdf92ca0e">udwadiaKalaba</a> (Eigen::VectorXd &amp;acc)</td></tr>
<tr class="memdesc:ac5d72c5cd59bfcb3a42ab2fbdf92ca0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the body acceleration components given the constraints established by the Udwadia linear system (calculated in the <code><a class="el" href="classSystemData.html" title="Class contains all data structures relevant to the simulation framework. Note that after construction...">SystemData</a></code> class).  <a href="classRungeKutta4.html#ac5d72c5cd59bfcb3a42ab2fbdf92ca0e">More...</a><br /></td></tr>
<tr class="separator:ac5d72c5cd59bfcb3a42ab2fbdf92ca0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a0d5a894049797b90958195bd83a0722c"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classSystemData.html">SystemData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a></td></tr>
<tr class="memdesc:a0d5a894049797b90958195bd83a0722c"><td class="mdescLeft">&#160;</td><td class="mdescRight">shared pointer reference to <code><a class="el" href="classSystemData.html" title="Class contains all data structures relevant to the simulation framework. Note that after construction...">SystemData</a></code> class  <a href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">More...</a><br /></td></tr>
<tr class="separator:a0d5a894049797b90958195bd83a0722c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09804a3e700013b77c9aef0067027b15"><td class="memItemLeft" align="right" valign="top">std::shared_ptr&lt; <a class="el" href="classPotentialHydrodynamics.html">PotentialHydrodynamics</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#a09804a3e700013b77c9aef0067027b15">m_potHydro</a></td></tr>
<tr class="memdesc:a09804a3e700013b77c9aef0067027b15"><td class="mdescLeft">&#160;</td><td class="mdescRight">shared pointer reference to <code><a class="el" href="classPotentialHydrodynamics.html" title="Computes hydrodynamic tensors (mass, forces) on a finite number of spheres in potential flow.">PotentialHydrodynamics</a></code> class  <a href="classRungeKutta4.html#a09804a3e700013b77c9aef0067027b15">More...</a><br /></td></tr>
<tr class="separator:a09804a3e700013b77c9aef0067027b15"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9114988acc174a2e92361148f511f8e"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#ab9114988acc174a2e92361148f511f8e">m_logFile</a></td></tr>
<tr class="memdesc:ab9114988acc174a2e92361148f511f8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">path of logfile for spdlog to write to  <a href="classRungeKutta4.html#ab9114988acc174a2e92361148f511f8e">More...</a><br /></td></tr>
<tr class="separator:ab9114988acc174a2e92361148f511f8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b86c1434e64019a28d96d00f7b13b59"><td class="memItemLeft" align="right" valign="top">const std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a> {&quot;RungeKutta4&quot;}</td></tr>
<tr class="memdesc:a8b86c1434e64019a28d96d00f7b13b59"><td class="mdescLeft">&#160;</td><td class="mdescRight">filename of logfile for spdlog to write to  <a href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">More...</a><br /></td></tr>
<tr class="separator:a8b86c1434e64019a28d96d00f7b13b59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bf8d09edc922a2334145dd51de93384"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#a3bf8d09edc922a2334145dd51de93384">m_dt</a> {-1.0}</td></tr>
<tr class="memdesc:a3bf8d09edc922a2334145dd51de93384"><td class="mdescLeft">&#160;</td><td class="mdescRight">(dimensional) integrator finite time step  <a href="classRungeKutta4.html#a3bf8d09edc922a2334145dd51de93384">More...</a><br /></td></tr>
<tr class="separator:a3bf8d09edc922a2334145dd51de93384"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a57ca17f9753d7699ed707584d922de"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#a9a57ca17f9753d7699ed707584d922de">m_c1_2_dt</a> {-1.0}</td></tr>
<tr class="memdesc:a9a57ca17f9753d7699ed707584d922de"><td class="mdescLeft">&#160;</td><td class="mdescRight">(dimensional) 1/2 integrator finite time step  <a href="classRungeKutta4.html#a9a57ca17f9753d7699ed707584d922de">More...</a><br /></td></tr>
<tr class="separator:a9a57ca17f9753d7699ed707584d922de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acecda2b48d584fc2a3708d3ce4b68363"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#acecda2b48d584fc2a3708d3ce4b68363">m_c1_6_dt</a> {-1.0}</td></tr>
<tr class="memdesc:acecda2b48d584fc2a3708d3ce4b68363"><td class="mdescLeft">&#160;</td><td class="mdescRight">(dimensional) 1/6 integrator finite time step  <a href="classRungeKutta4.html#acecda2b48d584fc2a3708d3ce4b68363">More...</a><br /></td></tr>
<tr class="separator:acecda2b48d584fc2a3708d3ce4b68363"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aece575515484867022bdbb31efc51d5d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#aece575515484867022bdbb31efc51d5d">m_7M</a> {-1}</td></tr>
<tr class="memdesc:aece575515484867022bdbb31efc51d5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">= 7M  <a href="classRungeKutta4.html#aece575515484867022bdbb31efc51d5d">More...</a><br /></td></tr>
<tr class="separator:aece575515484867022bdbb31efc51d5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada6f973c1c4f3ffe1828068dbf9bb328"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#ada6f973c1c4f3ffe1828068dbf9bb328">m_c1_2</a> {0.50}</td></tr>
<tr class="memdesc:ada6f973c1c4f3ffe1828068dbf9bb328"><td class="mdescLeft">&#160;</td><td class="mdescRight">= 1/2  <a href="classRungeKutta4.html#ada6f973c1c4f3ffe1828068dbf9bb328">More...</a><br /></td></tr>
<tr class="separator:ada6f973c1c4f3ffe1828068dbf9bb328"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd5e848badeeeaf90f2e0a3110d16895"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classRungeKutta4.html#acd5e848badeeeaf90f2e0a3110d16895">m_c1_6</a> {1.0 / 6.0}</td></tr>
<tr class="memdesc:acd5e848badeeeaf90f2e0a3110d16895"><td class="mdescLeft">&#160;</td><td class="mdescRight">= 1/6  <a href="classRungeKutta4.html#acd5e848badeeeaf90f2e0a3110d16895">More...</a><br /></td></tr>
<tr class="separator:acd5e848badeeeaf90f2e0a3110d16895"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a301c6c8b82c9f0808159aff069aef28e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a301c6c8b82c9f0808159aff069aef28e">&#9670;&nbsp;</a></span>RungeKutta4()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">RungeKutta4::RungeKutta4 </td>
          <td>(</td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classSystemData.html">SystemData</a> &gt;&#160;</td>
          <td class="paramname"><em>sys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::shared_ptr&lt; <a class="el" href="classPotentialHydrodynamics.html">PotentialHydrodynamics</a> &gt;&#160;</td>
          <td class="paramname"><em>hydro</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Construct a new runge Kutta4 object. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sys</td><td><a class="el" href="classSystemData.html" title="Class contains all data structures relevant to the simulation framework. Note that after construction...">SystemData</a> class to gather data from </td></tr>
    <tr><td class="paramname">hydro</td><td><a class="el" href="classPotentialHydrodynamics.html" title="Computes hydrodynamic tensors (mass, forces) on a finite number of spheres in potential flow.">PotentialHydrodynamics</a> class to get hydrodynamic force data from </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8cpp_source.html#l00007">7</a> of file <a class="el" href="RungeKutta4_8cpp_source.html">RungeKutta4.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;{</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;    <span class="comment">// save classes</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;    <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>   = sys;</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;    <a class="code" href="classRungeKutta4.html#a09804a3e700013b77c9aef0067027b15">m_potHydro</a> = hydro;</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;    <span class="comment">// initialize logger</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;    <a class="code" href="classRungeKutta4.html#ab9114988acc174a2e92361148f511f8e">m_logFile</a>   = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;outputDir() + <span class="stringliteral">&quot;/logs/&quot;</span> + <a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a> + <span class="stringliteral">&quot;-log.txt&quot;</span>;</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;    <span class="keyword">auto</span> logger = spdlog::basic_logger_mt(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>, <a class="code" href="classRungeKutta4.html#ab9114988acc174a2e92361148f511f8e">m_logFile</a>);</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;info(<span class="stringliteral">&quot;Initializing Runge-Kutta 4th order integrator&quot;</span>);</div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    <span class="comment">// Create integrator</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;info(<span class="stringliteral">&quot;Creating integrator&quot;</span>);</div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160; </div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;    <span class="comment">// initialize member variables</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;    <a class="code" href="classRungeKutta4.html#a3bf8d09edc922a2334145dd51de93384">m_dt</a> = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;dt() * <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;tau();</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;info(<span class="stringliteral">&quot;dt (dimensional): {0}&quot;</span>, <a class="code" href="classRungeKutta4.html#a3bf8d09edc922a2334145dd51de93384">m_dt</a>);</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;    <a class="code" href="classRungeKutta4.html#a9a57ca17f9753d7699ed707584d922de">m_c1_2_dt</a> = <a class="code" href="classRungeKutta4.html#ada6f973c1c4f3ffe1828068dbf9bb328">m_c1_2</a> * <a class="code" href="classRungeKutta4.html#a3bf8d09edc922a2334145dd51de93384">m_dt</a>;</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;info(<span class="stringliteral">&quot;1/2 * dt (dimensional): {0}&quot;</span>, <a class="code" href="classRungeKutta4.html#a9a57ca17f9753d7699ed707584d922de">m_c1_2_dt</a>);</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <a class="code" href="classRungeKutta4.html#acecda2b48d584fc2a3708d3ce4b68363">m_c1_6_dt</a> = <a class="code" href="classRungeKutta4.html#acd5e848badeeeaf90f2e0a3110d16895">m_c1_6</a> * <a class="code" href="classRungeKutta4.html#a3bf8d09edc922a2334145dd51de93384">m_dt</a>;</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;info(<span class="stringliteral">&quot;1/6 * dt (dimensional): {0}&quot;</span>, <a class="code" href="classRungeKutta4.html#acecda2b48d584fc2a3708d3ce4b68363">m_c1_6_dt</a>);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160; </div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="classRungeKutta4.html#aece575515484867022bdbb31efc51d5d">m_7M</a> = 7 * <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;numBodies();</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160; </div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;info(<span class="stringliteral">&quot;Constructor complete&quot;</span>);</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;flush();</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RungeKutta4_8hpp_source.html#l00171">m_7M</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00175">m_c1_2</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00165">m_c1_2_dt</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00177">m_c1_6</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00167">m_c1_6_dt</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00163">m_dt</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00157">m_logFile</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00159">m_logName</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00153">m_potHydro</a>, and <a class="el" href="RungeKutta4_8hpp_source.html#l00151">m_system</a>.</p>

</div>
</div>
<a id="a2061bc97a56f4f8edd9b5465f1a99a02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2061bc97a56f4f8edd9b5465f1a99a02">&#9670;&nbsp;</a></span>~RungeKutta4()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">RungeKutta4::~RungeKutta4 </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Destroy the runge Kutta4 object. </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8cpp_source.html#l00035">35</a> of file <a class="el" href="RungeKutta4_8cpp_source.html">RungeKutta4.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;{</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;info(<span class="stringliteral">&quot;Destructing Runge-Kutta 4th order&quot;</span>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;flush();</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    spdlog::drop(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RungeKutta4_8hpp_source.html#l00159">m_logName</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a442be59b7291fd57895e5900ff9dccd8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a442be59b7291fd57895e5900ff9dccd8">&#9670;&nbsp;</a></span>integrate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RungeKutta4::integrate </td>
          <td>(</td>
          <td class="paramtype">Eigen::ThreadPoolDevice &amp;&#160;</td>
          <td class="paramname"><em>device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Public function to call internal numerical Runge Kutta integration functions. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">device</td><td><code>Eigen::ThreadPoolDevice</code> to use for <code>Eigen::Tensor</code> computations </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8cpp_source.html#l00043">43</a> of file <a class="el" href="RungeKutta4_8cpp_source.html">RungeKutta4.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="classRungeKutta4.html#a62b7028de266e35a88e1cd4f8e588fd5">integrateSecondOrder</a>(device); <span class="comment">// Udwadia-Kalaba method only gives acceleration components</span></div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RungeKutta4_8cpp_source.html#l00049">integrateSecondOrder()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classRungeKutta4_a442be59b7291fd57895e5900ff9dccd8_cgraph.svg" width="899" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a62b7028de266e35a88e1cd4f8e588fd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62b7028de266e35a88e1cd4f8e588fd5">&#9670;&nbsp;</a></span>integrateSecondOrder()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void RungeKutta4::integrateSecondOrder </td>
          <td>(</td>
          <td class="paramtype">Eigen::ThreadPoolDevice &amp;&#160;</td>
          <td class="paramname"><em>device</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>2nd order Runge-Kutta 4th order integration. Integrates known acceleration body components into velocity and then positional components. </p>
<p>Solve system of form: \( y&#39;(t) = f( y(t), t ) \)</p>
<dl class="section see"><dt>See also</dt><dd><b>Reference:</b> <a href="https://www.physicsforums.com/threads/using-runge-kutta-method-for-position-calc.553663/post-3634957">https://www.physicsforums.com/threads/using-runge-kutta-method-for-position-calc.553663/post-3634957</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">device</td><td><code>Eigen::ThreadPoolDevice</code> to use for <code>Eigen::Tensor</code> computations </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8cpp_source.html#l00049">49</a> of file <a class="el" href="RungeKutta4_8cpp_source.html">RungeKutta4.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;{</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <span class="comment">/* Step 1: k1 = f( y(t_0),  t_0 ),</span></div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;<span class="comment">     * initial conditions at current step */</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>    t1{<a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;t()};</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    Eigen::VectorXd v1 = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;velocitiesBodies();</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    Eigen::VectorXd x1 = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;positionsBodies();</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    Eigen::VectorXd a1 = Eigen::VectorXd::Zero(<a class="code" href="classRungeKutta4.html#aece575515484867022bdbb31efc51d5d">m_7M</a>);</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <a class="code" href="classRungeKutta4.html#aaa9be7a023f272032338d223d900c4c5">accelerationUpdate</a>(t1, x1, v1, a1, device);</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">/* Step 2: k2 = f( y(t_0) + k1 * dt/2,  t_0 + dt/2 )</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;<span class="comment">     * time rate-of-change k1 evaluated halfway through time step (midpoint) */</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>    t2{t1 + 0.50 * <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;dt()};</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    Eigen::VectorXd v2 = v1;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    v2.noalias() += <a class="code" href="classRungeKutta4.html#a9a57ca17f9753d7699ed707584d922de">m_c1_2_dt</a> * a1;</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    Eigen::VectorXd x2 = x1;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    x2.noalias() += <a class="code" href="classRungeKutta4.html#a9a57ca17f9753d7699ed707584d922de">m_c1_2_dt</a> * v2;</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160; </div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    Eigen::VectorXd a2 = Eigen::VectorXd::Zero(<a class="code" href="classRungeKutta4.html#aece575515484867022bdbb31efc51d5d">m_7M</a>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="classRungeKutta4.html#aaa9be7a023f272032338d223d900c4c5">accelerationUpdate</a>(t2, x2, v2, a2, device);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160; </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">/* Step 3: k3 = f( y(t_0) + k2 * dt/2,  t_0 + dt/2 )</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;<span class="comment">     * time rate-of-change k2 evaluated halfway through time step (midpoint) */</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>    t3{t2};</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    Eigen::VectorXd v3 = v1;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    v3.noalias() += <a class="code" href="classRungeKutta4.html#a9a57ca17f9753d7699ed707584d922de">m_c1_2_dt</a> * a2;</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    Eigen::VectorXd x3 = x1;</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    x3.noalias() += <a class="code" href="classRungeKutta4.html#a9a57ca17f9753d7699ed707584d922de">m_c1_2_dt</a> * v3;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160; </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    Eigen::VectorXd a3 = Eigen::VectorXd::Zero(<a class="code" href="classRungeKutta4.html#aece575515484867022bdbb31efc51d5d">m_7M</a>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    <a class="code" href="classRungeKutta4.html#aaa9be7a023f272032338d223d900c4c5">accelerationUpdate</a>(t3, x3, v3, a3, device);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160; </div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <span class="comment">/* Step 4: k4 = f( y(t_0) + k3 * dt,  t_0 + dt )</span></div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment">     * time rate-of-change k3 evaluated at end of step (endpoint) */</span></div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span>    t4{t1 + <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;dt()};</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    Eigen::VectorXd v4 = v1;</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    v4.noalias() += <a class="code" href="classRungeKutta4.html#a3bf8d09edc922a2334145dd51de93384">m_dt</a> * a3;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    Eigen::VectorXd x4 = x1;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    x4.noalias() += <a class="code" href="classRungeKutta4.html#a3bf8d09edc922a2334145dd51de93384">m_dt</a> * v4;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160; </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    Eigen::VectorXd a4 = Eigen::VectorXd::Zero(<a class="code" href="classRungeKutta4.html#aece575515484867022bdbb31efc51d5d">m_7M</a>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <a class="code" href="classRungeKutta4.html#aaa9be7a023f272032338d223d900c4c5">accelerationUpdate</a>(t4, x4, v4, a4, device);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="comment">/* ANCHOR: Calculate kinematics at end of time step */</span></div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    Eigen::VectorXd v_out = a1;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    v_out.noalias() += 2.0 * a2;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    v_out.noalias() += 2.0 * a3;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    v_out.noalias() += a4;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    v_out *= <a class="code" href="classRungeKutta4.html#acecda2b48d584fc2a3708d3ce4b68363">m_c1_6_dt</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    v_out.noalias() += v1;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    Eigen::VectorXd x_out = v1;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    x_out.noalias() += 2.0 * v2;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    x_out.noalias() += 2.0 * v3;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    x_out.noalias() += v4;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    x_out *= <a class="code" href="classRungeKutta4.html#acecda2b48d584fc2a3708d3ce4b68363">m_c1_6_dt</a>;</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    x_out.noalias() += x1;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    Eigen::VectorXd a_out = Eigen::VectorXd::Zero(<a class="code" href="classRungeKutta4.html#aece575515484867022bdbb31efc51d5d">m_7M</a>);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="classRungeKutta4.html#aaa9be7a023f272032338d223d900c4c5">accelerationUpdate</a>(t4, x_out, v_out, a_out, device);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// reset system time to t1 as `Engine` class manages updating system time at end of each step</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;setT(t1);</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RungeKutta4_8cpp_source.html#l00116">accelerationUpdate()</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00171">m_7M</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00165">m_c1_2_dt</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00167">m_c1_6_dt</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00163">m_dt</a>, and <a class="el" href="RungeKutta4_8hpp_source.html#l00151">m_system</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00043">integrate()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classRungeKutta4_a62b7028de266e35a88e1cd4f8e588fd5_cgraph.svg" width="695" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classRungeKutta4_a62b7028de266e35a88e1cd4f8e588fd5_icgraph.svg" width="415" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aaa9be7a023f272032338d223d900c4c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa9be7a023f272032338d223d900c4c5">&#9670;&nbsp;</a></span>accelerationUpdate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void RungeKutta4::accelerationUpdate </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>acc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::ThreadPoolDevice &amp;&#160;</td>
          <td class="paramname"><em>device</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Helper function for <code><a class="el" href="classRungeKutta4.html#a62b7028de266e35a88e1cd4f8e588fd5" title="2nd order Runge-Kutta 4th order integration. Integrates known acceleration body components into veloc...">integrateSecondOrder()</a></code>. </p>
<p>Function will update simulation time, then system data, then hydrodynamic data, and finally call <code><a class="el" href="classRungeKutta4.html#ac5d72c5cd59bfcb3a42ab2fbdf92ca0e" title="Calculates the body acceleration components given the constraints established by the Udwadia linear s...">udwadiaKalaba()</a></code> to calculate the body acceleration components at a given system time.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">t</td><td>current integration time </td></tr>
    <tr><td class="paramname">pos</td><td>body position vector that will be overwritten (if image system) </td></tr>
    <tr><td class="paramname">vel</td><td>body velocity vector that will be overwritten (if image system) </td></tr>
    <tr><td class="paramname">acc</td><td>(output) body acceleration vector that will be overwritten </td></tr>
    <tr><td class="paramname">device</td><td><code>Eigen::ThreadPoolDevice</code> to use for <code>Eigen::Tensor</code> computations </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8cpp_source.html#l00116">116</a> of file <a class="el" href="RungeKutta4_8cpp_source.html">RungeKutta4.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;{</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="comment">// NOTE: Order of function calls must remain the same</span></div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;setT(t);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    <span class="comment">// TODO: Related to Issue #3</span></div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;imageSystem())</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <a class="code" href="classRungeKutta4.html#abc1cc48fea62c46948a51ca2b2000590">imageBodyPosVel</a>(pos, vel);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;setPositionsBodies(pos);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;    <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;setVelocitiesBodies(vel);</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160; </div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;update(device);</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <a class="code" href="classRungeKutta4.html#a09804a3e700013b77c9aef0067027b15">m_potHydro</a>-&gt;update(device);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    <span class="comment">// TODO: Related to Issue #3</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;imageSystem())</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;    {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="comment">// only update Udwadia system for &quot;real&quot; system not image dipoles</span></div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> num_img_bodies{<a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;numBodies() / 2};</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> num_img_bodies_7{7 * num_img_bodies};</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160; </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        Eigen::VectorXd acc_real_body = acc.segment(0, num_img_bodies_7);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160; </div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        <a class="code" href="classRungeKutta4.html#ac5d72c5cd59bfcb3a42ab2fbdf92ca0e">udwadiaKalaba</a>(acc_real_body);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="comment">// update acceleration components using constraints</span></div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        acc.segment(0, num_img_bodies_7).noalias() = acc_real_body;</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <a class="code" href="classRungeKutta4.html#a946b31500f95a6cf64ac2a758e88db73">imageBodyAcc</a>(acc);</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    }</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <span class="comment">// update Udwadia system for all bodies</span></div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <a class="code" href="classRungeKutta4.html#ac5d72c5cd59bfcb3a42ab2fbdf92ca0e">udwadiaKalaba</a>(acc);</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    }</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;setAccelerationsBodies(acc);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RungeKutta4_8cpp_source.html#l00190">imageBodyAcc()</a>, <a class="el" href="RungeKutta4_8cpp_source.html#l00158">imageBodyPosVel()</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00153">m_potHydro</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00151">m_system</a>, and <a class="el" href="RungeKutta4_8cpp_source.html#l00212">udwadiaKalaba()</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00049">integrateSecondOrder()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classRungeKutta4_aaa9be7a023f272032338d223d900c4c5_cgraph.svg" width="447" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classRungeKutta4_aaa9be7a023f272032338d223d900c4c5_icgraph.svg" width="639" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="abc1cc48fea62c46948a51ca2b2000590"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc1cc48fea62c46948a51ca2b2000590">&#9670;&nbsp;</a></span>imageBodyPosVel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void RungeKutta4::imageBodyPosVel </td>
          <td>(</td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>vel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Replaces 2nd 1/2 of body position and velocity D.o.F. with image of 1st 1/2 assuming the reflection plane is \( z = 0 \). </p>
<dl class="section see"><dt>See also</dt><dd>For discussion of how to invert z-axis of quaternion: <a href="https://stackoverflow.com/a/33999726">https://stackoverflow.com/a/33999726</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pos</td><td>(output) body position vector that will be overwritten </td></tr>
    <tr><td class="paramname">vel</td><td>(output) body velocity vector that will be overwritten </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8cpp_source.html#l00158">158</a> of file <a class="el" href="RungeKutta4_8cpp_source.html">RungeKutta4.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;{</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_img_bodies = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;numBodies() / 2;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> img_body_id = num_img_bodies; img_body_id &lt; <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;numBodies(); img_body_id++)</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    {</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="comment">// indices</span></div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> body_id_7{7 * (img_body_id - num_img_bodies)};</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> img_body_id_7{7 * img_body_id};</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        <span class="comment">/* ANCHOR: Position image system: mirror image about xy-plane (transform z --&gt; -z) */</span></div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        pos.segment&lt;7&gt;(img_body_id_7) = pos.segment&lt;7&gt;(body_id_7);</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        <span class="comment">// (linear components) flip z component, leave x-y unchanged</span></div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        pos.segment&lt;1&gt;(img_body_id_7 + 2) *= -1;</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="comment">// (quaternion components) flip x-y components of quaternion vector part (see note in header file: look for &quot;C1</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="comment">// and C2 are mirrored along the Z-axis&quot;)</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        pos.segment&lt;2&gt;(img_body_id_7 + 4) *= -1;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        <span class="comment">/* ANCHOR: Velocity image system: invert x-y components to have image dipoles  */</span></div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        vel.segment&lt;7&gt;(img_body_id_7) = vel.segment&lt;7&gt;(body_id_7);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="comment">// (linear components) flip x-y components, leave z unchanged</span></div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        vel.segment&lt;2&gt;(img_body_id_7) *= -1;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160; </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="comment">// (quaternion components) same transform as positional transform</span></div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        vel.segment&lt;2&gt;(img_body_id_7 + 4) *= -1;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RungeKutta4_8hpp_source.html#l00151">m_system</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00116">accelerationUpdate()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classRungeKutta4_abc1cc48fea62c46948a51ca2b2000590_icgraph.svg" width="899" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a946b31500f95a6cf64ac2a758e88db73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a946b31500f95a6cf64ac2a758e88db73">&#9670;&nbsp;</a></span>imageBodyAcc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void RungeKutta4::imageBodyAcc </td>
          <td>(</td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>acc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Replaces 2nd 1/2 of body acceleration D.o.F. with image of 1st 1/2 assuming the reflection plane is \( z = 0 \). </p>
<dl class="section see"><dt>See also</dt><dd>For discussion of how to invert z-axis of quaternion: <a href="https://stackoverflow.com/a/33999726">https://stackoverflow.com/a/33999726</a></dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">acc</td><td>(output) body acceleration vector that will be overwritten </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8cpp_source.html#l00190">190</a> of file <a class="el" href="RungeKutta4_8cpp_source.html">RungeKutta4.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;{</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> num_img_bodies = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;numBodies() / 2;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> img_body_id = num_img_bodies; img_body_id &lt; <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;numBodies(); img_body_id++)</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="comment">// indices</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> body_id_7{7 * (img_body_id - num_img_bodies)};</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> img_body_id_7{7 * img_body_id};</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160; </div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="comment">/* ANCHOR: Acceleration image system: invert x-y components to have image dipoles  */</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        acc.segment&lt;7&gt;(img_body_id_7) = acc.segment&lt;7&gt;(body_id_7);</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160; </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="comment">// (linear components) flip x-y components, leave z unchanged</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        acc.segment&lt;2&gt;(img_body_id_7) *= -1;</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="comment">// (quaternion components) same transform as positional transform</span></div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        acc.segment&lt;2&gt;(img_body_id_7 + 4) *= -1;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    }</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RungeKutta4_8hpp_source.html#l00151">m_system</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00116">accelerationUpdate()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classRungeKutta4_a946b31500f95a6cf64ac2a758e88db73_icgraph.svg" width="882" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ac5d72c5cd59bfcb3a42ab2fbdf92ca0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5d72c5cd59bfcb3a42ab2fbdf92ca0e">&#9670;&nbsp;</a></span>udwadiaKalaba()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void RungeKutta4::udwadiaKalaba </td>
          <td>(</td>
          <td class="paramtype">Eigen::VectorXd &amp;&#160;</td>
          <td class="paramname"><em>acc</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Calculates the body acceleration components given the constraints established by the Udwadia linear system (calculated in the <code><a class="el" href="classSystemData.html" title="Class contains all data structures relevant to the simulation framework. Note that after construction...">SystemData</a></code> class). </p>
<dl class="section see"><dt>See also</dt><dd><b>Original paper on constrained Lagrangian dynamics:</b> Udwadia, Firdaus E., and Robert E. Kalaba. "A new
perspective on constrained motion." Proceedings of the Royal Society of London. Series A: Mathematical and Physical Sciences 439.1906 (1992): 407-410.</dd>
<dd>
<b>Application of algorithm to unit quaternion vectors:</b> Udwadia, Firdaus E., and Aaron D. Schutte. "An
alternative derivation of the quaternion equations of motion for rigid-body rotational dynamics." (2010): 044505.</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">acc</td><td>(output) body acceleration vector that will be overwritten </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8cpp_source.html#l00212">212</a> of file <a class="el" href="RungeKutta4_8cpp_source.html">RungeKutta4.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;{</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">/* NOTE: Following the formalism developed in Udwadia &amp; Kalaba (1992) Proc. R. Soc. Lond. A</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;<span class="comment">     * Solve system of the form M_eff * acc = Q + Q_con</span></div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">     * Q is the forces present in unconstrained system</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="comment">     * Q_con is the generalized constraint forces */</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160; </div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <span class="keywordtype">int</span> body_dof{<a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;numBodies()}; <span class="comment">// = m</span></div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;imageSystem())</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        body_dof /= 2;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> body_dof_7{body_dof * 7};</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160; </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="comment">// calculate Q</span></div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    Eigen::VectorXd Q = Eigen::VectorXd::Zero(body_dof_7); <span class="comment">// (7m, 1)</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160; </div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="comment">// hydrodynamic force</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;fluidDensity() &gt; 0)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        Q.noalias() += <a class="code" href="classRungeKutta4.html#a09804a3e700013b77c9aef0067027b15">m_potHydro</a>-&gt;fHydroNoInertia().segment(0, body_dof_7);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    }</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160; </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="comment">/* calculate Q_con = K (b - A * M_eff^{-1} * Q)</span></div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;<span class="comment">     * Linear constraint system: A * acc = b</span></div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;<span class="comment">     * Linear proportionality: K = M_eff^{1/2} * (A * M_eff^{-1/2})^{+};</span></div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;<span class="comment">     * + is Moore-Penrose inverse */</span></div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160; </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;    <span class="keyword">const</span> Eigen::MatrixXd M_eff = <a class="code" href="classRungeKutta4.html#a09804a3e700013b77c9aef0067027b15">m_potHydro</a>-&gt;mTotalBodyCoords().block(0, 0, body_dof_7, body_dof_7); <span class="comment">// (7m, 7m)</span></div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160; </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    Eigen::SelfAdjointEigenSolver&lt;Eigen::MatrixXd&gt; eigensolver(M_eff);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160; </div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="comment">// compute eigen-decomposition of M_eff</span></div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">if</span> (eigensolver.info() != Eigen::Success)</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        spdlog::get(<a class="code" href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">m_logName</a>)-&gt;error(<span class="stringliteral">&quot;Computing eigendecomposition of effective total mass matrix failed at t={0}&quot;</span>,</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                                      <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;t());</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;Computing eigendecomposition of effective total mass matrix failed&quot;</span>);</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;    }</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160; </div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;    <span class="comment">// verify M is positive semi-definite</span></div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;<span class="preprocessor">#if !defined(NDEBUG)</span></div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;    <span class="keywordflow">if</span> (!M_eff.isApprox(M_eff.transpose()) || (eigensolver.eigenvalues().array() &lt; 0.0).any())</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;        <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">&quot;M_eff is non semi-positive definite matrix!&quot;</span>);</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    }</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">// calculate M^{1/2} &amp; M^{-1/2}</span></div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="keyword">const</span> Eigen::MatrixXd M_eff_halfPower         = eigensolver.operatorSqrt();        <span class="comment">// (7m, 7m)</span></div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keyword">const</span> Eigen::MatrixXd M_eff_negativeHalfPower = eigensolver.operatorInverseSqrt(); <span class="comment">// (7m, 7m)</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="comment">// calculate K</span></div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;    <span class="keyword">const</span> Eigen::MatrixXd AM_nHalf      = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;udwadiaA() * M_eff_negativeHalfPower; <span class="comment">// (c, 7m) = (c, 7m) (7m, 7m)</span></div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keyword">const</span> Eigen::MatrixXd AM_nHalf_pInv = AM_nHalf.completeOrthogonalDecomposition().pseudoInverse(); <span class="comment">// (7m, c)</span></div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keyword">const</span> Eigen::MatrixXd K             = M_eff_halfPower * AM_nHalf_pInv;                            <span class="comment">// (7m, c)</span></div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;    <span class="comment">// calculate Q_con</span></div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;    <span class="keyword">const</span> Eigen::MatrixXd M_eff_inv   = M_eff.inverse();                   <span class="comment">// (7m, 7m)</span></div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keyword">const</span> Eigen::MatrixXd M_eff_invQ  = M_eff_inv * Q;                     <span class="comment">// (7m, 1)</span></div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <span class="keyword">const</span> Eigen::VectorXd AM_eff_invQ = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;udwadiaA() * M_eff_invQ; <span class="comment">// (c, 1) = (c, 7m) (7m, 1)</span></div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;    Eigen::VectorXd       b_tilde     = <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;udwadiaB();              <span class="comment">// (c, 1)</span></div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;    b_tilde.noalias() -= AM_eff_invQ;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    <span class="keyword">const</span> Eigen::VectorXd Q_con = K * b_tilde; <span class="comment">// (7m, 1) = (7m, c) (c, 1)</span></div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="comment">// calculate accelerations</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    Eigen::VectorXd Q_total = Q; <span class="comment">// (7m, 1)</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    Q_total.noalias() += Q_con;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    acc.noalias() = M_eff_inv * Q_total; <span class="comment">// (7m, 1)</span></div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="comment">// debugging print statements</span></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    Eigen::IOFormat CleanFmt(4, 0, <span class="stringliteral">&quot;, &quot;</span>, <span class="stringliteral">&quot;\n&quot;</span>, <span class="stringliteral">&quot;[&quot;</span>, <span class="stringliteral">&quot;]&quot;</span>);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;M_eff:\n&quot;</span> &lt;&lt; M_eff.format(CleanFmt) &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;M_eff_inv:\n&quot;</span> &lt;&lt; M_eff_inv.format(CleanFmt) &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;K:\n&quot;</span> &lt;&lt; K.format(CleanFmt) &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;udwadiaA:\n&quot;</span> &lt;&lt; <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;udwadiaA().format(CleanFmt) &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;udwadiaB:\n&quot;</span> &lt;&lt; <a class="code" href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">m_system</a>-&gt;udwadiaB().format(CleanFmt) &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    std::cout &lt;&lt; <span class="stringliteral">&quot;acc:\n&quot;</span> &lt;&lt; acc.format(CleanFmt) &lt;&lt; <span class="stringliteral">&quot;\n\n&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="RungeKutta4_8hpp_source.html#l00159">m_logName</a>, <a class="el" href="RungeKutta4_8hpp_source.html#l00153">m_potHydro</a>, and <a class="el" href="RungeKutta4_8hpp_source.html#l00151">m_system</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00116">accelerationUpdate()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="classRungeKutta4_ac5d72c5cd59bfcb3a42ab2fbdf92ca0e_icgraph.svg" width="882" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a0d5a894049797b90958195bd83a0722c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d5a894049797b90958195bd83a0722c">&#9670;&nbsp;</a></span>m_system</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="classSystemData.html">SystemData</a>&gt; RungeKutta4::m_system</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>shared pointer reference to <code><a class="el" href="classSystemData.html" title="Class contains all data structures relevant to the simulation framework. Note that after construction...">SystemData</a></code> class </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00151">151</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00116">accelerationUpdate()</a>, <a class="el" href="RungeKutta4_8cpp_source.html#l00190">imageBodyAcc()</a>, <a class="el" href="RungeKutta4_8cpp_source.html#l00158">imageBodyPosVel()</a>, <a class="el" href="RungeKutta4_8cpp_source.html#l00049">integrateSecondOrder()</a>, <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>, and <a class="el" href="RungeKutta4_8cpp_source.html#l00212">udwadiaKalaba()</a>.</p>

</div>
</div>
<a id="a09804a3e700013b77c9aef0067027b15"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09804a3e700013b77c9aef0067027b15">&#9670;&nbsp;</a></span>m_potHydro</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::shared_ptr&lt;<a class="el" href="classPotentialHydrodynamics.html">PotentialHydrodynamics</a>&gt; RungeKutta4::m_potHydro</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>shared pointer reference to <code><a class="el" href="classPotentialHydrodynamics.html" title="Computes hydrodynamic tensors (mass, forces) on a finite number of spheres in potential flow.">PotentialHydrodynamics</a></code> class </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00153">153</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00116">accelerationUpdate()</a>, <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>, and <a class="el" href="RungeKutta4_8cpp_source.html#l00212">udwadiaKalaba()</a>.</p>

</div>
</div>
<a id="ab9114988acc174a2e92361148f511f8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab9114988acc174a2e92361148f511f8e">&#9670;&nbsp;</a></span>m_logFile</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::string RungeKutta4::m_logFile</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>path of logfile for spdlog to write to </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00157">157</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>.</p>

</div>
</div>
<a id="a8b86c1434e64019a28d96d00f7b13b59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b86c1434e64019a28d96d00f7b13b59">&#9670;&nbsp;</a></span>m_logName</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::string RungeKutta4::m_logName {&quot;RungeKutta4&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>filename of logfile for spdlog to write to </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00159">159</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>, <a class="el" href="RungeKutta4_8cpp_source.html#l00212">udwadiaKalaba()</a>, and <a class="el" href="RungeKutta4_8cpp_source.html#l00035">~RungeKutta4()</a>.</p>

</div>
</div>
<a id="a3bf8d09edc922a2334145dd51de93384"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bf8d09edc922a2334145dd51de93384">&#9670;&nbsp;</a></span>m_dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double RungeKutta4::m_dt {-1.0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>(dimensional) integrator finite time step </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00163">163</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00049">integrateSecondOrder()</a>, and <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>.</p>

</div>
</div>
<a id="a9a57ca17f9753d7699ed707584d922de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a57ca17f9753d7699ed707584d922de">&#9670;&nbsp;</a></span>m_c1_2_dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double RungeKutta4::m_c1_2_dt {-1.0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>(dimensional) 1/2 integrator finite time step </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00165">165</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00049">integrateSecondOrder()</a>, and <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>.</p>

</div>
</div>
<a id="acecda2b48d584fc2a3708d3ce4b68363"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acecda2b48d584fc2a3708d3ce4b68363">&#9670;&nbsp;</a></span>m_c1_6_dt</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double RungeKutta4::m_c1_6_dt {-1.0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>(dimensional) 1/6 integrator finite time step </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00167">167</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00049">integrateSecondOrder()</a>, and <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>.</p>

</div>
</div>
<a id="aece575515484867022bdbb31efc51d5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aece575515484867022bdbb31efc51d5d">&#9670;&nbsp;</a></span>m_7M</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int RungeKutta4::m_7M {-1}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>= 7M </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00171">171</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00049">integrateSecondOrder()</a>, and <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>.</p>

</div>
</div>
<a id="ada6f973c1c4f3ffe1828068dbf9bb328"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada6f973c1c4f3ffe1828068dbf9bb328">&#9670;&nbsp;</a></span>m_c1_2</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double RungeKutta4::m_c1_2 {0.50}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>= 1/2 </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00175">175</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>.</p>

</div>
</div>
<a id="acd5e848badeeeaf90f2e0a3110d16895"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd5e848badeeeaf90f2e0a3110d16895">&#9670;&nbsp;</a></span>m_c1_6</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const double RungeKutta4::m_c1_6 {1.0 / 6.0}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>= 1/6 </p>

<p class="definition">Definition at line <a class="el" href="RungeKutta4_8hpp_source.html#l00177">177</a> of file <a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a>.</p>

<p class="reference">Referenced by <a class="el" href="RungeKutta4_8cpp_source.html#l00007">RungeKutta4()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>src/integrators/<a class="el" href="RungeKutta4_8hpp_source.html">RungeKutta4.hpp</a></li>
<li>src/integrators/<a class="el" href="RungeKutta4_8cpp_source.html">RungeKutta4.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aclassRungeKutta4_html_a3bf8d09edc922a2334145dd51de93384"><div class="ttname"><a href="classRungeKutta4.html#a3bf8d09edc922a2334145dd51de93384">RungeKutta4::m_dt</a></div><div class="ttdeci">double m_dt</div><div class="ttdoc">(dimensional) integrator finite time step</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8hpp_source.html#l00163">RungeKutta4.hpp:163</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_abc1cc48fea62c46948a51ca2b2000590"><div class="ttname"><a href="classRungeKutta4.html#abc1cc48fea62c46948a51ca2b2000590">RungeKutta4::imageBodyPosVel</a></div><div class="ttdeci">void imageBodyPosVel(Eigen::VectorXd &amp;pos, Eigen::VectorXd &amp;vel)</div><div class="ttdoc">Replaces 2nd 1/2 of body position and velocity D.o.F. with image of 1st 1/2 assuming the reflection p...</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8cpp_source.html#l00158">RungeKutta4.cpp:158</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_a0d5a894049797b90958195bd83a0722c"><div class="ttname"><a href="classRungeKutta4.html#a0d5a894049797b90958195bd83a0722c">RungeKutta4::m_system</a></div><div class="ttdeci">std::shared_ptr&lt; SystemData &gt; m_system</div><div class="ttdoc">shared pointer reference to SystemData class</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8hpp_source.html#l00151">RungeKutta4.hpp:151</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_a9a57ca17f9753d7699ed707584d922de"><div class="ttname"><a href="classRungeKutta4.html#a9a57ca17f9753d7699ed707584d922de">RungeKutta4::m_c1_2_dt</a></div><div class="ttdeci">double m_c1_2_dt</div><div class="ttdoc">(dimensional) 1/2 integrator finite time step</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8hpp_source.html#l00165">RungeKutta4.hpp:165</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_acecda2b48d584fc2a3708d3ce4b68363"><div class="ttname"><a href="classRungeKutta4.html#acecda2b48d584fc2a3708d3ce4b68363">RungeKutta4::m_c1_6_dt</a></div><div class="ttdeci">double m_c1_6_dt</div><div class="ttdoc">(dimensional) 1/6 integrator finite time step</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8hpp_source.html#l00167">RungeKutta4.hpp:167</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_ada6f973c1c4f3ffe1828068dbf9bb328"><div class="ttname"><a href="classRungeKutta4.html#ada6f973c1c4f3ffe1828068dbf9bb328">RungeKutta4::m_c1_2</a></div><div class="ttdeci">const double m_c1_2</div><div class="ttdoc">= 1/2</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8hpp_source.html#l00175">RungeKutta4.hpp:175</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_ac5d72c5cd59bfcb3a42ab2fbdf92ca0e"><div class="ttname"><a href="classRungeKutta4.html#ac5d72c5cd59bfcb3a42ab2fbdf92ca0e">RungeKutta4::udwadiaKalaba</a></div><div class="ttdeci">void udwadiaKalaba(Eigen::VectorXd &amp;acc)</div><div class="ttdoc">Calculates the body acceleration components given the constraints established by the Udwadia linear s...</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8cpp_source.html#l00212">RungeKutta4.cpp:212</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_ab9114988acc174a2e92361148f511f8e"><div class="ttname"><a href="classRungeKutta4.html#ab9114988acc174a2e92361148f511f8e">RungeKutta4::m_logFile</a></div><div class="ttdeci">std::string m_logFile</div><div class="ttdoc">path of logfile for spdlog to write to</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8hpp_source.html#l00157">RungeKutta4.hpp:157</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_a62b7028de266e35a88e1cd4f8e588fd5"><div class="ttname"><a href="classRungeKutta4.html#a62b7028de266e35a88e1cd4f8e588fd5">RungeKutta4::integrateSecondOrder</a></div><div class="ttdeci">void integrateSecondOrder(Eigen::ThreadPoolDevice &amp;device)</div><div class="ttdoc">2nd order Runge-Kutta 4th order integration. Integrates known acceleration body components into veloc...</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8cpp_source.html#l00049">RungeKutta4.cpp:49</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_a09804a3e700013b77c9aef0067027b15"><div class="ttname"><a href="classRungeKutta4.html#a09804a3e700013b77c9aef0067027b15">RungeKutta4::m_potHydro</a></div><div class="ttdeci">std::shared_ptr&lt; PotentialHydrodynamics &gt; m_potHydro</div><div class="ttdoc">shared pointer reference to PotentialHydrodynamics class</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8hpp_source.html#l00153">RungeKutta4.hpp:153</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_aaa9be7a023f272032338d223d900c4c5"><div class="ttname"><a href="classRungeKutta4.html#aaa9be7a023f272032338d223d900c4c5">RungeKutta4::accelerationUpdate</a></div><div class="ttdeci">void accelerationUpdate(const double t, Eigen::VectorXd &amp;pos, Eigen::VectorXd &amp;vel, Eigen::VectorXd &amp;acc, Eigen::ThreadPoolDevice &amp;device)</div><div class="ttdoc">Helper function for integrateSecondOrder().</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8cpp_source.html#l00116">RungeKutta4.cpp:116</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_a946b31500f95a6cf64ac2a758e88db73"><div class="ttname"><a href="classRungeKutta4.html#a946b31500f95a6cf64ac2a758e88db73">RungeKutta4::imageBodyAcc</a></div><div class="ttdeci">void imageBodyAcc(Eigen::VectorXd &amp;acc)</div><div class="ttdoc">Replaces 2nd 1/2 of body acceleration D.o.F. with image of 1st 1/2 assuming the reflection plane is .</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8cpp_source.html#l00190">RungeKutta4.cpp:190</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_a8b86c1434e64019a28d96d00f7b13b59"><div class="ttname"><a href="classRungeKutta4.html#a8b86c1434e64019a28d96d00f7b13b59">RungeKutta4::m_logName</a></div><div class="ttdeci">const std::string m_logName</div><div class="ttdoc">filename of logfile for spdlog to write to</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8hpp_source.html#l00159">RungeKutta4.hpp:159</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_acd5e848badeeeaf90f2e0a3110d16895"><div class="ttname"><a href="classRungeKutta4.html#acd5e848badeeeaf90f2e0a3110d16895">RungeKutta4::m_c1_6</a></div><div class="ttdeci">const double m_c1_6</div><div class="ttdoc">= 1/6</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8hpp_source.html#l00177">RungeKutta4.hpp:177</a></div></div>
<div class="ttc" id="aclassRungeKutta4_html_aece575515484867022bdbb31efc51d5d"><div class="ttname"><a href="classRungeKutta4.html#aece575515484867022bdbb31efc51d5d">RungeKutta4::m_7M</a></div><div class="ttdeci">int m_7M</div><div class="ttdoc">= 7M</div><div class="ttdef"><b>Definition:</b> <a href="RungeKutta4_8hpp_source.html#l00171">RungeKutta4.hpp:171</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="classRungeKutta4.html">RungeKutta4</a></li>
    <li class="footer">Generated on Fri Nov 5 2021 13:06:47 for Bodies in Potential Flow by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
