<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BodiesinPotentialFlow: src/data_io/gsd.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js", "TeX/ams.js", "TeX/AMSmath.js", "TeX/AMSsymbols.js", "TeX/bm.js", "TeX/bbm.js", "TeX/dsfont.js", "TeX/mathrsfs.js", "TeX/upgreek.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="doxygen-awesome.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BodiesinPotentialFlow
   &#160;<span id="projectnumber">2.0-alpha</span>
   </div>
   <div id="projectbrief">Studydynamicsofinertialactivematterinpotentialflow(irrotational,incompressible).</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('gsd_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Prototypes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">gsd.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Implements the GSD C API.  
<a href="#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Prototypes</h2></td></tr>
<tr class="memitem:a9b05d58560daee2512f03bedf7b2926d"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a9b05d58560daee2512f03bedf7b2926d">gsd_util_zero_memory</a> (void *d, size_t size_to_zero)</td></tr>
<tr class="separator:a9b05d58560daee2512f03bedf7b2926d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fb7746d93a1c856ca7ef64fa3548cbe"><td class="memItemLeft" align="right" valign="top">static ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a3fb7746d93a1c856ca7ef64fa3548cbe">gsd_io_pwrite_retry</a> (int fd, const void *buf, size_t count, int64_t offset)</td></tr>
<tr class="separator:a3fb7746d93a1c856ca7ef64fa3548cbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1f41abbefbfe35337e7053d766c089b"><td class="memItemLeft" align="right" valign="top">static ssize_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#ac1f41abbefbfe35337e7053d766c089b">gsd_io_pread_retry</a> (int fd, void *buf, size_t count, int64_t offset)</td></tr>
<tr class="separator:ac1f41abbefbfe35337e7053d766c089b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebfeb70fcbc089409a7179af7d814554"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#aebfeb70fcbc089409a7179af7d814554">gsd_name_id_map_allocate</a> (struct <a class="el" href="structgsd__name__id__map.html">gsd_name_id_map</a> *map, size_t size)</td></tr>
<tr class="separator:aebfeb70fcbc089409a7179af7d814554"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8249dc854c432e55e8ee07a8d3e8546c"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a8249dc854c432e55e8ee07a8d3e8546c">gsd_name_id_map_free</a> (struct <a class="el" href="structgsd__name__id__map.html">gsd_name_id_map</a> *map)</td></tr>
<tr class="separator:a8249dc854c432e55e8ee07a8d3e8546c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d8087323ec29c58d907b9462b4a31da"><td class="memItemLeft" align="right" valign="top">static unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a6d8087323ec29c58d907b9462b4a31da">gsd_hash_str</a> (const unsigned char *str)</td></tr>
<tr class="separator:a6d8087323ec29c58d907b9462b4a31da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c8c2e5a49ac4eb01a95be2e0df06eb9"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a6c8c2e5a49ac4eb01a95be2e0df06eb9">gsd_name_id_map_insert</a> (struct <a class="el" href="structgsd__name__id__map.html">gsd_name_id_map</a> *map, const char *str, uint16_t id)</td></tr>
<tr class="separator:a6c8c2e5a49ac4eb01a95be2e0df06eb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31b9400272036b121040e9fc0a9e626b"><td class="memItemLeft" align="right" valign="top">static uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a31b9400272036b121040e9fc0a9e626b">gsd_name_id_map_find</a> (struct <a class="el" href="structgsd__name__id__map.html">gsd_name_id_map</a> *map, const char *str)</td></tr>
<tr class="separator:a31b9400272036b121040e9fc0a9e626b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab5d19295bedec41b7919caec2cb22759"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#ab5d19295bedec41b7919caec2cb22759">gsd_is_entry_valid</a> (struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *handle, size_t idx)</td></tr>
<tr class="separator:ab5d19295bedec41b7919caec2cb22759"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeaf487909ab334303fa478cf4a126d6f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#aeaf487909ab334303fa478cf4a126d6f">gsd_byte_buffer_allocate</a> (struct <a class="el" href="structgsd__byte__buffer.html">gsd_byte_buffer</a> *buf, size_t reserve)</td></tr>
<tr class="separator:aeaf487909ab334303fa478cf4a126d6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a717f9dafe011e68434e181c76253af"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a7a717f9dafe011e68434e181c76253af">gsd_byte_buffer_append</a> (struct <a class="el" href="structgsd__byte__buffer.html">gsd_byte_buffer</a> *buf, const char *data, size_t size)</td></tr>
<tr class="separator:a7a717f9dafe011e68434e181c76253af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae50726c30c5bf629b6af1ef88020302f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#ae50726c30c5bf629b6af1ef88020302f">gsd_byte_buffer_free</a> (struct <a class="el" href="structgsd__byte__buffer.html">gsd_byte_buffer</a> *buf)</td></tr>
<tr class="separator:ae50726c30c5bf629b6af1ef88020302f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1948c93f77d642c4e3797fe7e5f2095"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#ae1948c93f77d642c4e3797fe7e5f2095">gsd_index_buffer_allocate</a> (struct <a class="el" href="structgsd__index__buffer.html">gsd_index_buffer</a> *buf, size_t reserve)</td></tr>
<tr class="separator:ae1948c93f77d642c4e3797fe7e5f2095"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fe75caf6c4df550af2455a0c40bfbdf"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a6fe75caf6c4df550af2455a0c40bfbdf">gsd_index_buffer_map</a> (struct <a class="el" href="structgsd__index__buffer.html">gsd_index_buffer</a> *buf, struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *handle)</td></tr>
<tr class="separator:a6fe75caf6c4df550af2455a0c40bfbdf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e12a38df69cf73fa771b005748cb3e5"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a9e12a38df69cf73fa771b005748cb3e5">gsd_index_buffer_free</a> (struct <a class="el" href="structgsd__index__buffer.html">gsd_index_buffer</a> *buf)</td></tr>
<tr class="separator:a9e12a38df69cf73fa771b005748cb3e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a258b64725f90f60d969752d65fba9850"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a258b64725f90f60d969752d65fba9850">gsd_index_buffer_add</a> (struct <a class="el" href="structgsd__index__buffer.html">gsd_index_buffer</a> *buf, struct <a class="el" href="structgsd__index__entry.html">gsd_index_entry</a> **entry)</td></tr>
<tr class="separator:a258b64725f90f60d969752d65fba9850"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ffe758eed9a5bae487f514a0a45e97d"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a3ffe758eed9a5bae487f514a0a45e97d">gsd_cmp_index_entry</a> (const struct <a class="el" href="structgsd__index__entry.html">gsd_index_entry</a> *a, const struct <a class="el" href="structgsd__index__entry.html">gsd_index_entry</a> *b)</td></tr>
<tr class="separator:a3ffe758eed9a5bae487f514a0a45e97d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7b8e133941184a32c2d90414dfba6a5"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#ab7b8e133941184a32c2d90414dfba6a5">gsd_heap_parent</a> (size_t i)</td></tr>
<tr class="separator:ab7b8e133941184a32c2d90414dfba6a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaec0ae1e441692725a568aee8c8ef627"><td class="memItemLeft" align="right" valign="top">static size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#aaec0ae1e441692725a568aee8c8ef627">gsd_heap_left_child</a> (size_t i)</td></tr>
<tr class="separator:aaec0ae1e441692725a568aee8c8ef627"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a987a1d460f7ca33476fc57bcc1ff8439"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a987a1d460f7ca33476fc57bcc1ff8439">gsd_heap_swap</a> (struct <a class="el" href="structgsd__index__buffer.html">gsd_index_buffer</a> *buf, size_t a, size_t b)</td></tr>
<tr class="separator:a987a1d460f7ca33476fc57bcc1ff8439"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accc971ec12e75a165ffef6e1ee854681"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#accc971ec12e75a165ffef6e1ee854681">gsd_heap_shift_down</a> (struct <a class="el" href="structgsd__index__buffer.html">gsd_index_buffer</a> *buf, size_t start, size_t end)</td></tr>
<tr class="separator:accc971ec12e75a165ffef6e1ee854681"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0de3f89cdd57571b57401c91feef2f66"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a0de3f89cdd57571b57401c91feef2f66">gsd_heapify</a> (struct <a class="el" href="structgsd__index__buffer.html">gsd_index_buffer</a> *buf)</td></tr>
<tr class="separator:a0de3f89cdd57571b57401c91feef2f66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c20ccb47eed1a3ea9995a47a8eebdbd"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a6c20ccb47eed1a3ea9995a47a8eebdbd">gsd_index_buffer_sort</a> (struct <a class="el" href="structgsd__index__buffer.html">gsd_index_buffer</a> *buf)</td></tr>
<tr class="separator:a6c20ccb47eed1a3ea9995a47a8eebdbd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6dddb94661e99e54f6c01b1a443e27f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#ae6dddb94661e99e54f6c01b1a443e27f">gsd_expand_file_index</a> (struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *handle, size_t size_required)</td></tr>
<tr class="separator:ae6dddb94661e99e54f6c01b1a443e27f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61daeaa70162e9bac3d241832b460278"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a61daeaa70162e9bac3d241832b460278">gsd_flush_write_buffer</a> (struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *handle)</td></tr>
<tr class="separator:a61daeaa70162e9bac3d241832b460278"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab147cf4d77c10fd8085e5023e9afe55f"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#ab147cf4d77c10fd8085e5023e9afe55f">gsd_flush_name_buffer</a> (struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *handle)</td></tr>
<tr class="separator:ab147cf4d77c10fd8085e5023e9afe55f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1a0a7dcf4015edcadbb47a6451b4a4b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#aa1a0a7dcf4015edcadbb47a6451b4a4b">gsd_append_name</a> (uint16_t *id, struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *handle, const char *name)</td></tr>
<tr class="separator:aa1a0a7dcf4015edcadbb47a6451b4a4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acb769baf09c31a5ad6cba95bd348c194"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#acb769baf09c31a5ad6cba95bd348c194">gsd_initialize_file</a> (int fd, const char *application, const char *schema, uint32_t schema_version)</td></tr>
<tr class="separator:acb769baf09c31a5ad6cba95bd348c194"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac159dfbfd790607f85073ad2d8464a8b"><td class="memItemLeft" align="right" valign="top">static int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#ac159dfbfd790607f85073ad2d8464a8b">gsd_initialize_handle</a> (struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *handle)</td></tr>
<tr class="separator:ac159dfbfd790607f85073ad2d8464a8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a493ef951956c9f98adff89a80ddb3fa6"><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a493ef951956c9f98adff89a80ddb3fa6">gsd_make_version</a> (unsigned int major, unsigned int minor)</td></tr>
<tr class="separator:a493ef951956c9f98adff89a80ddb3fa6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58654880dd98b2bc32e429810b7d2623"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a58654880dd98b2bc32e429810b7d2623">gsd_create</a> (const char *fname, const char *application, const char *schema, uint32_t schema_version)</td></tr>
<tr class="separator:a58654880dd98b2bc32e429810b7d2623"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0b0b7fb6b385707ffc83989d54bc81b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#aa0b0b7fb6b385707ffc83989d54bc81b">gsd_create_and_open</a> (struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *handle, const char *fname, const char *application, const char *schema, uint32_t schema_version, const enum <a class="el" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98">gsd_open_flag</a> flags, int exclusive_create)</td></tr>
<tr class="separator:aa0b0b7fb6b385707ffc83989d54bc81b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8933dcce55fd8101b5688f382c10a8e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#ad8933dcce55fd8101b5688f382c10a8e">gsd_open</a> (struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *handle, const char *fname, const enum <a class="el" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98">gsd_open_flag</a> flags)</td></tr>
<tr class="separator:ad8933dcce55fd8101b5688f382c10a8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a02ac7984034069d508b1c7ccbe702bac"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a02ac7984034069d508b1c7ccbe702bac">gsd_truncate</a> (struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *handle)</td></tr>
<tr class="separator:a02ac7984034069d508b1c7ccbe702bac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08b4f76e3e19eda194def8c0c4b2b7a3"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a08b4f76e3e19eda194def8c0c4b2b7a3">gsd_close</a> (struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *handle)</td></tr>
<tr class="separator:a08b4f76e3e19eda194def8c0c4b2b7a3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa03810337c5eebcbe716d8633eaefc5e"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#aa03810337c5eebcbe716d8633eaefc5e">gsd_end_frame</a> (struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *handle)</td></tr>
<tr class="separator:aa03810337c5eebcbe716d8633eaefc5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae22447904b925f284bf987fae448488a"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#ae22447904b925f284bf987fae448488a">gsd_write_chunk</a> (struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *handle, const char *name, enum <a class="el" href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118">gsd_type</a> type, uint64_t N, uint32_t M, uint8_t flags, const void *data)</td></tr>
<tr class="separator:ae22447904b925f284bf987fae448488a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7479046d4d6e15c33cb24034ddd87562"><td class="memItemLeft" align="right" valign="top">uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a7479046d4d6e15c33cb24034ddd87562">gsd_get_nframes</a> (struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *handle)</td></tr>
<tr class="separator:a7479046d4d6e15c33cb24034ddd87562"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c76bbf6c28b953cff198a44852c732f"><td class="memItemLeft" align="right" valign="top">const struct <a class="el" href="structgsd__index__entry.html">gsd_index_entry</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a3c76bbf6c28b953cff198a44852c732f">gsd_find_chunk</a> (struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *handle, uint64_t frame, const char *name)</td></tr>
<tr class="separator:a3c76bbf6c28b953cff198a44852c732f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2db2e3e8a72948bf413e7f09469ec8a6"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a2db2e3e8a72948bf413e7f09469ec8a6">gsd_read_chunk</a> (struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *handle, void *data, const struct <a class="el" href="structgsd__index__entry.html">gsd_index_entry</a> *chunk)</td></tr>
<tr class="separator:a2db2e3e8a72948bf413e7f09469ec8a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1d1a8a5f73b37df0c706f41df3bdd69"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#ab1d1a8a5f73b37df0c706f41df3bdd69">gsd_sizeof_type</a> (enum <a class="el" href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118">gsd_type</a> type)</td></tr>
<tr class="separator:ab1d1a8a5f73b37df0c706f41df3bdd69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a081b6fad5e27f4f8cfabd0030af7ebf5"><td class="memItemLeft" align="right" valign="top">const char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a081b6fad5e27f4f8cfabd0030af7ebf5">gsd_find_matching_chunk_name</a> (struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *handle, const char *match, const char *prev)</td></tr>
<tr class="separator:a081b6fad5e27f4f8cfabd0030af7ebf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb92d5142812c19bf4ee33cbde439131"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#adb92d5142812c19bf4ee33cbde439131">gsd_upgrade</a> (struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *handle)</td></tr>
<tr class="separator:adb92d5142812c19bf4ee33cbde439131"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Implements the GSD C API. </p>

<p class="definition">Definition in file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
</div><div class="textblock"><code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &lt;sys/mman.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &lt;stddef.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &quot;<a class="el" href="gsd_8h_source.html">gsd.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for gsd.c:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c__incl.svg" width="914" height="187"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<p><a href="gsd_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a78c99ffd76a7bb3c8c74db76207e9ab4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a78c99ffd76a7bb3c8c74db76207e9ab4">_XOPEN_SOURCE</a>&#160;&#160;&#160;500</td></tr>
<tr class="separator:a78c99ffd76a7bb3c8c74db76207e9ab4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9f43681316968fd912811ffd0e1401d5"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#a9f43681316968fd912811ffd0e1401d5">GSD_USE_MMAP</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a9f43681316968fd912811ffd0e1401d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a06fc87d81c62e9abb8790b6e5713c55b"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="gsd_8c.html#a06fc87d81c62e9abb8790b6e5713c55bab2d4762a429d1bedec72663852e3c4ba">GSD_INITIAL_INDEX_SIZE</a> = 128
 }</td></tr>
<tr class="memdesc:a06fc87d81c62e9abb8790b6e5713c55b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initial index size.  <a href="gsd_8c.html#a06fc87d81c62e9abb8790b6e5713c55b">More...</a><br /></td></tr>
<tr class="separator:a06fc87d81c62e9abb8790b6e5713c55b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf764cbdea00d65edcd07bb9953ad2b7"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="gsd_8c.html#adf764cbdea00d65edcd07bb9953ad2b7af18592611faceacda42f0c336394bae2">GSD_INITIAL_NAME_BUFFER_SIZE</a> = 1024
 }</td></tr>
<tr class="memdesc:adf764cbdea00d65edcd07bb9953ad2b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initial namelist size.  <a href="gsd_8c.html#adf764cbdea00d65edcd07bb9953ad2b7">More...</a><br /></td></tr>
<tr class="separator:adf764cbdea00d65edcd07bb9953ad2b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99fb83031ce9923c84392b4e92f956b5"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="gsd_8c.html#a99fb83031ce9923c84392b4e92f956b5abe3e9ee339884a28a33d20ea27d0c8a7">GSD_INITIAL_FRAME_INDEX_SIZE</a> = 16
 }</td></tr>
<tr class="memdesc:a99fb83031ce9923c84392b4e92f956b5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of initial frame index.  <a href="gsd_8c.html#a99fb83031ce9923c84392b4e92f956b5">More...</a><br /></td></tr>
<tr class="separator:a99fb83031ce9923c84392b4e92f956b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc6126af1d45847bc59afa0aa3216b04"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="gsd_8c.html#abc6126af1d45847bc59afa0aa3216b04add62126eb596d9d505d4f4c33062528e">GSD_WRITE_BUFFER_SIZE</a> = 16 * 1024 * 1024
 }</td></tr>
<tr class="memdesc:abc6126af1d45847bc59afa0aa3216b04"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of write buffer.  <a href="gsd_8c.html#abc6126af1d45847bc59afa0aa3216b04">More...</a><br /></td></tr>
<tr class="separator:abc6126af1d45847bc59afa0aa3216b04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc29c2ff13d900c2f185ee95427fb06c"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="gsd_8c.html#adc29c2ff13d900c2f185ee95427fb06ca4cede151f20532731cb30ac33609508f">GSD_COPY_BUFFER_SIZE</a> = 128 * 1024
 }</td></tr>
<tr class="memdesc:adc29c2ff13d900c2f185ee95427fb06c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of copy buffer.  <a href="gsd_8c.html#adc29c2ff13d900c2f185ee95427fb06c">More...</a><br /></td></tr>
<tr class="separator:adc29c2ff13d900c2f185ee95427fb06c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a61dadd085c1777f559549e05962b2c9e"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="gsd_8c.html#a61dadd085c1777f559549e05962b2c9ea09f6f8b0215767f2ed4321a8e26cc287">GSD_NAME_MAP_SIZE</a> = 57557
 }</td></tr>
<tr class="memdesc:a61dadd085c1777f559549e05962b2c9e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Size of hash map.  <a href="gsd_8c.html#a61dadd085c1777f559549e05962b2c9e">More...</a><br /></td></tr>
<tr class="separator:a61dadd085c1777f559549e05962b2c9e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a726ca809ffd3d67ab4b8476646f26635"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom">{ <a class="el" href="gsd_8c.html#a726ca809ffd3d67ab4b8476646f26635a9e41ab940950d400d353438f87a6f559">GSD_CURRENT_FILE_VERSION</a> = 2
 }</td></tr>
<tr class="memdesc:a726ca809ffd3d67ab4b8476646f26635"><td class="mdescLeft">&#160;</td><td class="mdescRight">Current GSD file specification.  <a href="gsd_8c.html#a726ca809ffd3d67ab4b8476646f26635">More...</a><br /></td></tr>
<tr class="separator:a726ca809ffd3d67ab4b8476646f26635"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:acf7c38e3e5534e06ba18607f11c1e00e"><td class="memItemLeft" align="right" valign="top">const uint64_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gsd_8c.html#acf7c38e3e5534e06ba18607f11c1e00e">GSD_MAGIC_ID</a> = 0x65DF65DF65DF65DF</td></tr>
<tr class="memdesc:acf7c38e3e5534e06ba18607f11c1e00e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Magic value identifying a GSD file.  <a href="gsd_8c.html#acf7c38e3e5534e06ba18607f11c1e00e">More...</a><br /></td></tr>
<tr class="separator:acf7c38e3e5534e06ba18607f11c1e00e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a78c99ffd76a7bb3c8c74db76207e9ab4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78c99ffd76a7bb3c8c74db76207e9ab4">&#9670;&nbsp;</a></span>_XOPEN_SOURCE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _XOPEN_SOURCE&#160;&#160;&#160;500</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00016">16</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>

</div>
</div>
<a id="a9f43681316968fd912811ffd0e1401d5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f43681316968fd912811ffd0e1401d5">&#9670;&nbsp;</a></span>GSD_USE_MMAP</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define GSD_USE_MMAP&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00019">19</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a06fc87d81c62e9abb8790b6e5713c55b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06fc87d81c62e9abb8790b6e5713c55b">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initial index size. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a06fc87d81c62e9abb8790b6e5713c55bab2d4762a429d1bedec72663852e3c4ba"></a>GSD_INITIAL_INDEX_SIZE&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00043">43</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <a class="code" href="gsd_8c.html#a06fc87d81c62e9abb8790b6e5713c55bab2d4762a429d1bedec72663852e3c4ba">GSD_INITIAL_INDEX_SIZE</a> = 128</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    };</div>
</div><!-- fragment -->
</div>
</div>
<a id="adf764cbdea00d65edcd07bb9953ad2b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf764cbdea00d65edcd07bb9953ad2b7">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initial namelist size. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="adf764cbdea00d65edcd07bb9953ad2b7af18592611faceacda42f0c336394bae2"></a>GSD_INITIAL_NAME_BUFFER_SIZE&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00049">49</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="gsd_8c.html#adf764cbdea00d65edcd07bb9953ad2b7af18592611faceacda42f0c336394bae2">GSD_INITIAL_NAME_BUFFER_SIZE</a> = 1024</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a99fb83031ce9923c84392b4e92f956b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99fb83031ce9923c84392b4e92f956b5">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Size of initial frame index. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a99fb83031ce9923c84392b4e92f956b5abe3e9ee339884a28a33d20ea27d0c8a7"></a>GSD_INITIAL_FRAME_INDEX_SIZE&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00055">55</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <a class="code" href="gsd_8c.html#a99fb83031ce9923c84392b4e92f956b5abe3e9ee339884a28a33d20ea27d0c8a7">GSD_INITIAL_FRAME_INDEX_SIZE</a> = 16</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    };</div>
</div><!-- fragment -->
</div>
</div>
<a id="abc6126af1d45847bc59afa0aa3216b04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc6126af1d45847bc59afa0aa3216b04">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Size of write buffer. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="abc6126af1d45847bc59afa0aa3216b04add62126eb596d9d505d4f4c33062528e"></a>GSD_WRITE_BUFFER_SIZE&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00061">61</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    {</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <a class="code" href="gsd_8c.html#abc6126af1d45847bc59afa0aa3216b04add62126eb596d9d505d4f4c33062528e">GSD_WRITE_BUFFER_SIZE</a> = 16 * 1024 * 1024</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    };</div>
</div><!-- fragment -->
</div>
</div>
<a id="adc29c2ff13d900c2f185ee95427fb06c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc29c2ff13d900c2f185ee95427fb06c">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Size of copy buffer. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="adc29c2ff13d900c2f185ee95427fb06ca4cede151f20532731cb30ac33609508f"></a>GSD_COPY_BUFFER_SIZE&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00067">67</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="gsd_8c.html#adc29c2ff13d900c2f185ee95427fb06ca4cede151f20532731cb30ac33609508f">GSD_COPY_BUFFER_SIZE</a> = 128 * 1024</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a61dadd085c1777f559549e05962b2c9e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61dadd085c1777f559549e05962b2c9e">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Size of hash map. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a61dadd085c1777f559549e05962b2c9ea09f6f8b0215767f2ed4321a8e26cc287"></a>GSD_NAME_MAP_SIZE&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00073">73</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="gsd_8c.html#a61dadd085c1777f559549e05962b2c9ea09f6f8b0215767f2ed4321a8e26cc287">GSD_NAME_MAP_SIZE</a> = 57557</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;    };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a726ca809ffd3d67ab4b8476646f26635"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a726ca809ffd3d67ab4b8476646f26635">&#9670;&nbsp;</a></span>anonymous enum</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">anonymous enum</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Current GSD file specification. </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a726ca809ffd3d67ab4b8476646f26635a9e41ab940950d400d353438f87a6f559"></a>GSD_CURRENT_FILE_VERSION&#160;</td><td class="fielddoc"></td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00079">79</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    {</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="gsd_8c.html#a726ca809ffd3d67ab4b8476646f26635a9e41ab940950d400d353438f87a6f559">GSD_CURRENT_FILE_VERSION</a> = 2</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    };</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a9b05d58560daee2512f03bedf7b2926d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b05d58560daee2512f03bedf7b2926d">&#9670;&nbsp;</a></span>gsd_util_zero_memory()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void gsd_util_zero_memory </td>
          <td>(</td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>d</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size_to_zero</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Zero memory</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">d</td><td>pointer to memory region </td></tr>
    <tr><td class="paramname">size_to_zero</td><td>size of the area to zero in bytes </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00130">130</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    memset(d, 0, size_to_zero);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l00491">gsd_byte_buffer_append()</a>, <a class="el" href="gsd_8c_source.html#l00535">gsd_byte_buffer_free()</a>, <a class="el" href="gsd_8c_source.html#l01587">gsd_create_and_open()</a>, <a class="el" href="gsd_8c_source.html#l00933">gsd_expand_file_index()</a>, <a class="el" href="gsd_8c_source.html#l01148">gsd_flush_name_buffer()</a>, <a class="el" href="gsd_8c_source.html#l00744">gsd_index_buffer_add()</a>, <a class="el" href="gsd_8c_source.html#l00706">gsd_index_buffer_free()</a>, <a class="el" href="gsd_8c_source.html#l01322">gsd_initialize_file()</a>, <a class="el" href="gsd_8c_source.html#l01642">gsd_open()</a>, <a class="el" href="gsd_8c_source.html#l02300">gsd_upgrade()</a>, and <a class="el" href="gsd_8c_source.html#l01916">gsd_write_chunk()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a9b05d58560daee2512f03bedf7b2926d_icgraph.svg" width="1222" height="666"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a3fb7746d93a1c856ca7ef64fa3548cbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fb7746d93a1c856ca7ef64fa3548cbe">&#9670;&nbsp;</a></span>gsd_io_pwrite_retry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static ssize_t gsd_io_pwrite_retry </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00148">148</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    {</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordtype">size_t</span> total_bytes_written = 0;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* ptr = (<span class="keywordtype">char</span>*)buf;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="comment">// perform multiple pwrite calls to complete a large write successfully</span></div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">while</span> (total_bytes_written &lt; count)</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        {</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordtype">size_t</span> to_write = count - total_bytes_written;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;<span class="preprocessor">#if defined(_WIN32) || defined(__APPLE__)</span></div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="comment">// win32 and apple raise an error for writes greater than INT_MAX</span></div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        <span class="keywordflow">if</span> (to_write &gt; INT_MAX / 2)</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            to_write = INT_MAX / 2;</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160; </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        errno = 0;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        ssize_t bytes_written</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;            = pwrite(fd, ptr + total_bytes_written, to_write, offset + total_bytes_written);</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        <span class="keywordflow">if</span> (bytes_written == -1 || (bytes_written == 0 &amp;&amp; errno != 0))</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;            {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            }</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160; </div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        total_bytes_written += bytes_written;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="keywordflow">return</span> total_bytes_written;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00075">GSD_ERROR_IO</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l01842">gsd_end_frame()</a>, <a class="el" href="gsd_8c_source.html#l00933">gsd_expand_file_index()</a>, <a class="el" href="gsd_8c_source.html#l01148">gsd_flush_name_buffer()</a>, <a class="el" href="gsd_8c_source.html#l01081">gsd_flush_write_buffer()</a>, <a class="el" href="gsd_8c_source.html#l01322">gsd_initialize_file()</a>, <a class="el" href="gsd_8c_source.html#l02300">gsd_upgrade()</a>, and <a class="el" href="gsd_8c_source.html#l01916">gsd_write_chunk()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a3fb7746d93a1c856ca7ef64fa3548cbe_icgraph.svg" width="962" height="322"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ac1f41abbefbfe35337e7053d766c089b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1f41abbefbfe35337e7053d766c089b">&#9670;&nbsp;</a></span>gsd_io_pread_retry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static ssize_t gsd_io_pread_retry </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int64_t&#160;</td>
          <td class="paramname"><em>offset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00190">190</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="keywordtype">size_t</span> total_bytes_read = 0;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="keywordtype">char</span>* ptr = (<span class="keywordtype">char</span>*)buf;</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">// perform multiple pread calls to complete a large write successfully</span></div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keywordflow">while</span> (total_bytes_read &lt; count)</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        {</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;        <span class="keywordtype">size_t</span> to_read = count - total_bytes_read;</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor">#if defined(_WIN32) || defined(__APPLE__)</span></div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="comment">// win32 and apple raise errors for reads greater than INT_MAX</span></div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        <span class="keywordflow">if</span> (to_read &gt; INT_MAX / 2)</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            to_read = INT_MAX / 2;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        errno = 0;</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        ssize_t bytes_read = pread(fd, ptr + total_bytes_read, to_read, offset + total_bytes_read);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">if</span> (bytes_read == -1 || (bytes_read == 0 &amp;&amp; errno != 0))</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            {</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;            }</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160; </div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        total_bytes_read += bytes_read;</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        <span class="comment">// handle end of file</span></div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        <span class="keywordflow">if</span> (bytes_read == 0)</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;            {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="keywordflow">return</span> total_bytes_read;</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;            }</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">return</span> total_bytes_read;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00075">GSD_ERROR_IO</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l00933">gsd_expand_file_index()</a>, <a class="el" href="gsd_8c_source.html#l00593">gsd_index_buffer_map()</a>, <a class="el" href="gsd_8c_source.html#l01401">gsd_initialize_handle()</a>, and <a class="el" href="gsd_8c_source.html#l02133">gsd_read_chunk()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_ac1f41abbefbfe35337e7053d766c089b_icgraph.svg" width="999" height="392"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aebfeb70fcbc089409a7179af7d814554"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebfeb70fcbc089409a7179af7d814554">&#9670;&nbsp;</a></span>gsd_name_id_map_allocate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int gsd_name_id_map_allocate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__name__id__map.html">gsd_name_id_map</a> *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00232">232</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    {</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="keywordflow">if</span> (map == NULL || map-&gt;<a class="code" href="structgsd__name__id__map.html#a204ade834899e92a218b23e211ce3ba9">v</a> || size == 0 || map-&gt;<a class="code" href="structgsd__name__id__map.html#a3019ca67584d12f957fcf694c3ea6ca0">size</a> != 0)</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;        {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;        }</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160; </div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    map-&gt;<a class="code" href="structgsd__name__id__map.html#a204ade834899e92a218b23e211ce3ba9">v</a> = calloc(size, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__name__id__pair.html">gsd_name_id_pair</a>));</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <span class="keywordflow">if</span> (map-&gt;<a class="code" href="structgsd__name__id__map.html#a204ade834899e92a218b23e211ce3ba9">v</a> == NULL)</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba927545200d5ae6b308d536988ff37637">GSD_ERROR_MEMORY_ALLOCATION_FAILED</a>;</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        }</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160; </div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    map-&gt;<a class="code" href="structgsd__name__id__map.html#a3019ca67584d12f957fcf694c3ea6ca0">size</a> = size;</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160; </div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00078">GSD_ERROR_INVALID_ARGUMENT</a>, <a class="el" href="gsd_8h_source.html#l00090">GSD_ERROR_MEMORY_ALLOCATION_FAILED</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, <a class="el" href="gsd_8h_source.html#l00216">gsd_name_id_map::size</a>, and <a class="el" href="gsd_8h_source.html#l00213">gsd_name_id_map::v</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l01401">gsd_initialize_handle()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_aebfeb70fcbc089409a7179af7d814554_icgraph.svg" width="784" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a8249dc854c432e55e8ee07a8d3e8546c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8249dc854c432e55e8ee07a8d3e8546c">&#9670;&nbsp;</a></span>gsd_name_id_map_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int gsd_name_id_map_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__name__id__map.html">gsd_name_id_map</a> *&#160;</td>
          <td class="paramname"><em>map</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00257">257</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;    <span class="keywordflow">if</span> (map == NULL || map-&gt;<a class="code" href="structgsd__name__id__map.html#a204ade834899e92a218b23e211ce3ba9">v</a> == NULL || map-&gt;<a class="code" href="structgsd__name__id__map.html#a3019ca67584d12f957fcf694c3ea6ca0">size</a> == 0)</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        {</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160; </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">// free all of the linked lists</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; map-&gt;<a class="code" href="structgsd__name__id__map.html#a3019ca67584d12f957fcf694c3ea6ca0">size</a>; i++)</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        free(map-&gt;<a class="code" href="structgsd__name__id__map.html#a204ade834899e92a218b23e211ce3ba9">v</a>[i].<a class="code" href="structgsd__name__id__pair.html#a7ad4d0f48666c48af52cf76d54fffa71">name</a>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        <span class="keyword">struct </span><a class="code" href="structgsd__name__id__pair.html">gsd_name_id_pair</a>* cur = map-&gt;<a class="code" href="structgsd__name__id__map.html#a204ade834899e92a218b23e211ce3ba9">v</a>[i].<a class="code" href="structgsd__name__id__pair.html#ab2cafab77fcdd289751cacec8ec77d0f">next</a>;</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">while</span> (cur != NULL)</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="keyword">struct </span><a class="code" href="structgsd__name__id__pair.html">gsd_name_id_pair</a>* prev = cur;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            cur = cur-&gt;<a class="code" href="structgsd__name__id__pair.html#ab2cafab77fcdd289751cacec8ec77d0f">next</a>;</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;            free(prev-&gt;<a class="code" href="structgsd__name__id__pair.html#a7ad4d0f48666c48af52cf76d54fffa71">name</a>);</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;            free(prev);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        }</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160; </div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="comment">// free the main map</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    free(map-&gt;<a class="code" href="structgsd__name__id__map.html#a204ade834899e92a218b23e211ce3ba9">v</a>);</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    map-&gt;<a class="code" href="structgsd__name__id__map.html#a204ade834899e92a218b23e211ce3ba9">v</a> = 0;</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    map-&gt;<a class="code" href="structgsd__name__id__map.html#a3019ca67584d12f957fcf694c3ea6ca0">size</a> = 0;</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160; </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00078">GSD_ERROR_INVALID_ARGUMENT</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, <a class="el" href="gsd_8h_source.html#l00197">gsd_name_id_pair::name</a>, <a class="el" href="gsd_8h_source.html#l00200">gsd_name_id_pair::next</a>, <a class="el" href="gsd_8h_source.html#l00216">gsd_name_id_map::size</a>, and <a class="el" href="gsd_8h_source.html#l00213">gsd_name_id_map::v</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l01763">gsd_close()</a>, and <a class="el" href="gsd_8c_source.html#l01677">gsd_truncate()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a8249dc854c432e55e8ee07a8d3e8546c_icgraph.svg" width="544" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a6d8087323ec29c58d907b9462b4a31da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d8087323ec29c58d907b9462b4a31da">&#9670;&nbsp;</a></span>gsd_hash_str()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static unsigned long gsd_hash_str </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>str</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00296">296</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> hash = 5381; <span class="comment">// NOLINT</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    <span class="keywordtype">int</span> c;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">while</span> ((c = *str++))</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        hash = ((hash &lt;&lt; 5) + hash) + c; <span class="comment">/* hash * 33 + c NOLINT */</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;        }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;    <span class="keywordflow">return</span> hash;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l00377">gsd_name_id_map_find()</a>, and <a class="el" href="gsd_8c_source.html#l00318">gsd_name_id_map_insert()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a6d8087323ec29c58d907b9462b4a31da_icgraph.svg" width="1160" height="494"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a6c8c2e5a49ac4eb01a95be2e0df06eb9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c8c2e5a49ac4eb01a95be2e0df06eb9">&#9670;&nbsp;</a></span>gsd_name_id_map_insert()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int gsd_name_id_map_insert </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__name__id__map.html">gsd_name_id_map</a> *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>str</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>id</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00318">318</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    <span class="keywordflow">if</span> (map == NULL || map-&gt;<a class="code" href="structgsd__name__id__map.html#a204ade834899e92a218b23e211ce3ba9">v</a> == NULL || map-&gt;<a class="code" href="structgsd__name__id__map.html#a3019ca67584d12f957fcf694c3ea6ca0">size</a> == 0)</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        }</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    <span class="keywordtype">size_t</span> hash = <a class="code" href="gsd_8c.html#a6d8087323ec29c58d907b9462b4a31da">gsd_hash_str</a>((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)str) % map-&gt;<a class="code" href="structgsd__name__id__map.html#a3019ca67584d12f957fcf694c3ea6ca0">size</a>;</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; </div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    <span class="comment">// base case: no conflict</span></div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">if</span> (map-&gt;<a class="code" href="structgsd__name__id__map.html#a204ade834899e92a218b23e211ce3ba9">v</a>[hash].<a class="code" href="structgsd__name__id__pair.html#a7ad4d0f48666c48af52cf76d54fffa71">name</a> == NULL)</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;        {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        map-&gt;<a class="code" href="structgsd__name__id__map.html#a204ade834899e92a218b23e211ce3ba9">v</a>[hash].<a class="code" href="structgsd__name__id__pair.html#a7ad4d0f48666c48af52cf76d54fffa71">name</a> = calloc(strlen(str) + 1, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        <span class="keywordflow">if</span> (map-&gt;<a class="code" href="structgsd__name__id__map.html#a204ade834899e92a218b23e211ce3ba9">v</a>[hash].<a class="code" href="structgsd__name__id__pair.html#a7ad4d0f48666c48af52cf76d54fffa71">name</a> == NULL)</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;            {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba927545200d5ae6b308d536988ff37637">GSD_ERROR_MEMORY_ALLOCATION_FAILED</a>;</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            }</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        memcpy(map-&gt;<a class="code" href="structgsd__name__id__map.html#a204ade834899e92a218b23e211ce3ba9">v</a>[hash].<a class="code" href="structgsd__name__id__pair.html#a7ad4d0f48666c48af52cf76d54fffa71">name</a>, str, strlen(str) + 1);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        map-&gt;<a class="code" href="structgsd__name__id__map.html#a204ade834899e92a218b23e211ce3ba9">v</a>[hash].<a class="code" href="structgsd__name__id__pair.html#aa6fe10f8f10da3cf607289e051724fd0">id</a> = <a class="code" href="structgsd__name__id__pair.html#aa6fe10f8f10da3cf607289e051724fd0">id</a>;</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;        map-&gt;<a class="code" href="structgsd__name__id__map.html#a204ade834899e92a218b23e211ce3ba9">v</a>[hash].<a class="code" href="structgsd__name__id__pair.html#ab2cafab77fcdd289751cacec8ec77d0f">next</a> = NULL;</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        }</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        {</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        <span class="comment">// go to the end of the conflict list</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keyword">struct </span><a class="code" href="structgsd__name__id__pair.html">gsd_name_id_pair</a>* insert_point = map-&gt;<a class="code" href="structgsd__name__id__map.html#a204ade834899e92a218b23e211ce3ba9">v</a> + hash;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">while</span> (insert_point-&gt;<a class="code" href="structgsd__name__id__pair.html#ab2cafab77fcdd289751cacec8ec77d0f">next</a> != NULL)</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;            {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;            insert_point = insert_point-&gt;<a class="code" href="structgsd__name__id__pair.html#ab2cafab77fcdd289751cacec8ec77d0f">next</a>;</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;            }</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160; </div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        <span class="comment">// allocate and insert a new entry</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        insert_point-&gt;<a class="code" href="structgsd__name__id__pair.html#ab2cafab77fcdd289751cacec8ec77d0f">next</a> = malloc(<span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__name__id__pair.html">gsd_name_id_pair</a>));</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordflow">if</span> (insert_point-&gt;<a class="code" href="structgsd__name__id__pair.html#ab2cafab77fcdd289751cacec8ec77d0f">next</a> == NULL)</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;            {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba927545200d5ae6b308d536988ff37637">GSD_ERROR_MEMORY_ALLOCATION_FAILED</a>;</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            }</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160; </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        insert_point-&gt;<a class="code" href="structgsd__name__id__pair.html#ab2cafab77fcdd289751cacec8ec77d0f">next</a>-&gt;<a class="code" href="structgsd__name__id__pair.html#a7ad4d0f48666c48af52cf76d54fffa71">name</a> = calloc(strlen(str) + 1, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        <span class="keywordflow">if</span> (insert_point-&gt;<a class="code" href="structgsd__name__id__pair.html#ab2cafab77fcdd289751cacec8ec77d0f">next</a>-&gt;<a class="code" href="structgsd__name__id__pair.html#a7ad4d0f48666c48af52cf76d54fffa71">name</a> == NULL)</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba927545200d5ae6b308d536988ff37637">GSD_ERROR_MEMORY_ALLOCATION_FAILED</a>;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;            }</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        memcpy(insert_point-&gt;<a class="code" href="structgsd__name__id__pair.html#ab2cafab77fcdd289751cacec8ec77d0f">next</a>-&gt;<a class="code" href="structgsd__name__id__pair.html#a7ad4d0f48666c48af52cf76d54fffa71">name</a>, str, strlen(str) + 1);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        insert_point-&gt;<a class="code" href="structgsd__name__id__pair.html#ab2cafab77fcdd289751cacec8ec77d0f">next</a>-&gt;<a class="code" href="structgsd__name__id__pair.html#aa6fe10f8f10da3cf607289e051724fd0">id</a> = <a class="code" href="structgsd__name__id__pair.html#aa6fe10f8f10da3cf607289e051724fd0">id</a>;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;        insert_point-&gt;<a class="code" href="structgsd__name__id__pair.html#ab2cafab77fcdd289751cacec8ec77d0f">next</a>-&gt;<a class="code" href="structgsd__name__id__pair.html#ab2cafab77fcdd289751cacec8ec77d0f">next</a> = NULL;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;        }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00078">GSD_ERROR_INVALID_ARGUMENT</a>, <a class="el" href="gsd_8h_source.html#l00090">GSD_ERROR_MEMORY_ALLOCATION_FAILED</a>, <a class="el" href="gsd_8c_source.html#l00296">gsd_hash_str()</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, <a class="el" href="gsd_8h_source.html#l00203">gsd_name_id_pair::id</a>, <a class="el" href="gsd_8h_source.html#l00197">gsd_name_id_pair::name</a>, <a class="el" href="gsd_8h_source.html#l00200">gsd_name_id_pair::next</a>, <a class="el" href="gsd_8h_source.html#l00216">gsd_name_id_map::size</a>, and <a class="el" href="gsd_8h_source.html#l00213">gsd_name_id_map::v</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l01264">gsd_append_name()</a>, and <a class="el" href="gsd_8c_source.html#l01401">gsd_initialize_handle()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a6c8c2e5a49ac4eb01a95be2e0df06eb9_cgraph.svg" width="330" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a6c8c2e5a49ac4eb01a95be2e0df06eb9_icgraph.svg" width="984" height="291"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a31b9400272036b121040e9fc0a9e626b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31b9400272036b121040e9fc0a9e626b">&#9670;&nbsp;</a></span>gsd_name_id_map_find()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static uint16_t gsd_name_id_map_find </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__name__id__map.html">gsd_name_id_map</a> *&#160;</td>
          <td class="paramname"><em>map</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>str</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00377">377</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordflow">if</span> (map == NULL || map-&gt;<a class="code" href="structgsd__name__id__map.html#a204ade834899e92a218b23e211ce3ba9">v</a> == NULL || map-&gt;<a class="code" href="structgsd__name__id__map.html#a3019ca67584d12f957fcf694c3ea6ca0">size</a> == 0)</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        {</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;        <span class="keywordflow">return</span> UINT16_MAX;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;        }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    <span class="keywordtype">size_t</span> hash = <a class="code" href="gsd_8c.html#a6d8087323ec29c58d907b9462b4a31da">gsd_hash_str</a>((<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span>*)str) % map-&gt;<a class="code" href="structgsd__name__id__map.html#a3019ca67584d12f957fcf694c3ea6ca0">size</a>;</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="keyword">struct </span><a class="code" href="structgsd__name__id__pair.html">gsd_name_id_pair</a>* cur = map-&gt;<a class="code" href="structgsd__name__id__map.html#a204ade834899e92a218b23e211ce3ba9">v</a> + hash;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160; </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keywordflow">while</span> (cur != NULL)</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;        <span class="keywordflow">if</span> (cur-&gt;<a class="code" href="structgsd__name__id__pair.html#a7ad4d0f48666c48af52cf76d54fffa71">name</a> == NULL)</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            <span class="comment">// not found</span></div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;            <span class="keywordflow">return</span> UINT16_MAX;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            }</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        <span class="keywordflow">if</span> (strcmp(str, cur-&gt;<a class="code" href="structgsd__name__id__pair.html#a7ad4d0f48666c48af52cf76d54fffa71">name</a>) == 0)</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;            {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;            <span class="comment">// found</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <span class="keywordflow">return</span> cur-&gt;<a class="code" href="structgsd__name__id__pair.html#aa6fe10f8f10da3cf607289e051724fd0">id</a>;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;            }</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160; </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        <span class="comment">// keep looking</span></div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;        cur = cur-&gt;<a class="code" href="structgsd__name__id__pair.html#ab2cafab77fcdd289751cacec8ec77d0f">next</a>;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        }</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">// not found in any conflict</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keywordflow">return</span> UINT16_MAX;</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8c_source.html#l00296">gsd_hash_str()</a>, <a class="el" href="gsd_8h_source.html#l00203">gsd_name_id_pair::id</a>, <a class="el" href="gsd_8h_source.html#l00197">gsd_name_id_pair::name</a>, <a class="el" href="gsd_8h_source.html#l00200">gsd_name_id_pair::next</a>, <a class="el" href="gsd_8h_source.html#l00216">gsd_name_id_map::size</a>, and <a class="el" href="gsd_8h_source.html#l00213">gsd_name_id_map::v</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l02039">gsd_find_chunk()</a>, and <a class="el" href="gsd_8c_source.html#l01916">gsd_write_chunk()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a31b9400272036b121040e9fc0a9e626b_cgraph.svg" width="318" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a31b9400272036b121040e9fc0a9e626b_icgraph.svg" width="987" height="291"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ab5d19295bedec41b7919caec2cb22759"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5d19295bedec41b7919caec2cb22759">&#9670;&nbsp;</a></span>gsd_is_entry_valid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int gsd_is_entry_valid </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>idx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00417">417</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    {</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    <span class="keyword">const</span> <span class="keyword">struct </span><a class="code" href="structgsd__index__entry.html">gsd_index_entry</a> entry = handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>[idx];</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160; </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    <span class="comment">// check for valid type</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="gsd_8c.html#ab1d1a8a5f73b37df0c706f41df3bdd69">gsd_sizeof_type</a>((<span class="keyword">enum</span> <a class="code" href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118">gsd_type</a>)entry.<a class="code" href="structgsd__index__entry.html#aebddbeda0dacc7125308440c46b9230a">type</a>) == 0)</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">// validate that we don&#39;t read past the end of the file</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    <span class="keywordtype">size_t</span> size = entry.<a class="code" href="structgsd__index__entry.html#ae913d46842b10fe8b5b74da3a7075726">N</a> * entry.<a class="code" href="structgsd__index__entry.html#acbd3b797c1d179affc5fe279260b40f2">M</a> * <a class="code" href="gsd_8c.html#ab1d1a8a5f73b37df0c706f41df3bdd69">gsd_sizeof_type</a>((<span class="keyword">enum</span> <a class="code" href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118">gsd_type</a>)entry.<a class="code" href="structgsd__index__entry.html#aebddbeda0dacc7125308440c46b9230a">type</a>);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordflow">if</span> ((entry.<a class="code" href="structgsd__index__entry.html#a70e15b9094a3a22954bba035496d83bf">location</a> + size) &gt; (uint64_t)handle-&gt;<a class="code" href="structgsd__handle.html#ac35aad0eef4a5844ecc4141041fa9243">file_size</a>)</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        {</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        }</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160; </div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">// check for valid frame (frame cannot be more than the number of index entries)</span></div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">if</span> (entry.<a class="code" href="structgsd__index__entry.html#a1b6c67d9197aa4588964052c2919092e">frame</a> &gt;= handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a6ad2a01f3c1926eacab74d693ac34bdf">index_allocated_entries</a>)</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        {</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160; </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    <span class="comment">// check for valid id</span></div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="keywordflow">if</span> (entry.<a class="code" href="structgsd__index__entry.html#aa7ed270380c0d8074232aad5bb32bfb4">id</a> &gt;= (handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#aee7f806d610d9c4b8e0f045024d4e1f6">n_names</a> + handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#aee7f806d610d9c4b8e0f045024d4e1f6">n_names</a>))</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        {</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;        }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160; </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    <span class="comment">// check for valid flags</span></div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    <span class="keywordflow">if</span> (entry.<a class="code" href="structgsd__index__entry.html#a0fd668ac1b940ccb0b22793709145091">flags</a> != 0)</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        {</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        }</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160; </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00226">gsd_index_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00290">gsd_handle::file_index</a>, <a class="el" href="gsd_8h_source.html#l00302">gsd_handle::file_names</a>, <a class="el" href="gsd_8h_source.html#l00311">gsd_handle::file_size</a>, <a class="el" href="gsd_8h_source.html#l00187">gsd_index_entry::flags</a>, <a class="el" href="gsd_8h_source.html#l00169">gsd_index_entry::frame</a>, <a class="el" href="gsd_8h_source.html#l00305">gsd_handle::frame_names</a>, <a class="el" href="gsd_8c_source.html#l02177">gsd_sizeof_type()</a>, <a class="el" href="gsd_8h_source.html#l00287">gsd_handle::header</a>, <a class="el" href="gsd_8h_source.html#l00181">gsd_index_entry::id</a>, <a class="el" href="gsd_8h_source.html#l00136">gsd_header::index_allocated_entries</a>, <a class="el" href="gsd_8h_source.html#l00175">gsd_index_entry::location</a>, <a class="el" href="gsd_8h_source.html#l00178">gsd_index_entry::M</a>, <a class="el" href="gsd_8h_source.html#l00172">gsd_index_entry::N</a>, <a class="el" href="gsd_8h_source.html#l00269">gsd_name_buffer::n_names</a>, and <a class="el" href="gsd_8h_source.html#l00184">gsd_index_entry::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l00593">gsd_index_buffer_map()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_ab5d19295bedec41b7919caec2cb22759_cgraph.svg" width="307" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_ab5d19295bedec41b7919caec2cb22759_icgraph.svg" width="944" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aeaf487909ab334303fa478cf4a126d6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeaf487909ab334303fa478cf4a126d6f">&#9670;&nbsp;</a></span>gsd_byte_buffer_allocate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int gsd_byte_buffer_allocate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__byte__buffer.html">gsd_byte_buffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>reserve</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00463">463</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <span class="keywordflow">if</span> (buf == NULL || buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a> || reserve == 0 || buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a> != 0 || buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a3630961b7d45df2885cdd887e4b83b60">size</a> != 0)</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        }</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a> = calloc(reserve, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>));</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="keywordflow">if</span> (buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a> == NULL)</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba927545200d5ae6b308d536988ff37637">GSD_ERROR_MEMORY_ALLOCATION_FAILED</a>;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160; </div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a3630961b7d45df2885cdd887e4b83b60">size</a> = 0;</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a> = reserve;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00249">gsd_byte_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00078">GSD_ERROR_INVALID_ARGUMENT</a>, <a class="el" href="gsd_8h_source.html#l00090">GSD_ERROR_MEMORY_ALLOCATION_FAILED</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, <a class="el" href="gsd_8h_source.html#l00255">gsd_byte_buffer::reserved</a>, and <a class="el" href="gsd_8h_source.html#l00252">gsd_byte_buffer::size</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l01401">gsd_initialize_handle()</a>, and <a class="el" href="gsd_8c_source.html#l02300">gsd_upgrade()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_aeaf487909ab334303fa478cf4a126d6f_icgraph.svg" width="768" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a7a717f9dafe011e68434e181c76253af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a717f9dafe011e68434e181c76253af">&#9670;&nbsp;</a></span>gsd_byte_buffer_append()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int gsd_byte_buffer_append </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__byte__buffer.html">gsd_byte_buffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00491">491</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">if</span> (buf == NULL || buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a> == NULL || size == 0 || buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a> == 0)</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        {</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        }</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160; </div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="keywordflow">if</span> (buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a3630961b7d45df2885cdd887e4b83b60">size</a> + size &gt; buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a>)</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;        {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="comment">// reallocate by doubling</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="keywordtype">size_t</span> new_reserved = buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a> * 2;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        <span class="keywordflow">while</span> (buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a3630961b7d45df2885cdd887e4b83b60">size</a> + size &gt;= new_reserved)</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            new_reserved = new_reserved * 2;</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            }</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="keywordtype">char</span>* old_data = buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a>;</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a> = realloc(buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a>, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * new_reserved);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="keywordflow">if</span> (buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a> == NULL)</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            {</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            <span class="comment">// this free should not be necessary, but clang-tidy disagrees</span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;            free(old_data);</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba927545200d5ae6b308d536988ff37637">GSD_ERROR_MEMORY_ALLOCATION_FAILED</a>;</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160; </div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <span class="comment">// zero the new memory, but only the portion after the end of the new section to be appended</span></div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        <a class="code" href="gsd_8c.html#a9b05d58560daee2512f03bedf7b2926d">gsd_util_zero_memory</a>(buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a> + (buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a3630961b7d45df2885cdd887e4b83b60">size</a> + size),</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                             <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * (new_reserved - (buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a3630961b7d45df2885cdd887e4b83b60">size</a> + size)));</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a> = new_reserved;</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        }</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    memcpy(buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a> + buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a3630961b7d45df2885cdd887e4b83b60">size</a>, data, size);</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a3630961b7d45df2885cdd887e4b83b60">size</a> += size;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00249">gsd_byte_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00078">GSD_ERROR_INVALID_ARGUMENT</a>, <a class="el" href="gsd_8h_source.html#l00090">GSD_ERROR_MEMORY_ALLOCATION_FAILED</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, <a class="el" href="gsd_8c_source.html#l00130">gsd_util_zero_memory()</a>, <a class="el" href="gsd_8h_source.html#l00255">gsd_byte_buffer::reserved</a>, and <a class="el" href="gsd_8h_source.html#l00252">gsd_byte_buffer::size</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l01264">gsd_append_name()</a>, <a class="el" href="gsd_8c_source.html#l01148">gsd_flush_name_buffer()</a>, <a class="el" href="gsd_8c_source.html#l02300">gsd_upgrade()</a>, and <a class="el" href="gsd_8c_source.html#l01916">gsd_write_chunk()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a7a717f9dafe011e68434e181c76253af_cgraph.svg" width="375" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a7a717f9dafe011e68434e181c76253af_icgraph.svg" width="960" height="240"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ae50726c30c5bf629b6af1ef88020302f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae50726c30c5bf629b6af1ef88020302f">&#9670;&nbsp;</a></span>gsd_byte_buffer_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int gsd_byte_buffer_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__byte__buffer.html">gsd_byte_buffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00535">535</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;    {</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;    <span class="keywordflow">if</span> (buf == NULL || buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a> == NULL)</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160; </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    free(buf-&gt;<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a>);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <a class="code" href="gsd_8c.html#a9b05d58560daee2512f03bedf7b2926d">gsd_util_zero_memory</a>(buf, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__byte__buffer.html">gsd_byte_buffer</a>));</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00249">gsd_byte_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00078">GSD_ERROR_INVALID_ARGUMENT</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, and <a class="el" href="gsd_8c_source.html#l00130">gsd_util_zero_memory()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l01763">gsd_close()</a>, <a class="el" href="gsd_8c_source.html#l01677">gsd_truncate()</a>, and <a class="el" href="gsd_8c_source.html#l02300">gsd_upgrade()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_ae50726c30c5bf629b6af1ef88020302f_cgraph.svg" width="355" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_ae50726c30c5bf629b6af1ef88020302f_icgraph.svg" width="527" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ae1948c93f77d642c4e3797fe7e5f2095"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1948c93f77d642c4e3797fe7e5f2095">&#9670;&nbsp;</a></span>gsd_index_buffer_allocate()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int gsd_index_buffer_allocate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__index__buffer.html">gsd_index_buffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>reserve</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00558">558</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    {</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">if</span> (buf == NULL || buf-&gt;<a class="code" href="structgsd__index__buffer.html#aa4cf014343ec2746f964695d5502cc87">mapped_data</a> || buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a> || reserve == 0 || buf-&gt;<a class="code" href="structgsd__index__buffer.html#a51a1e266f6d7d1aafdfd54822fc226b1">reserved</a> != 0</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        || buf-&gt;<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> != 0)</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        }</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a> = calloc(reserve, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__index__entry.html">gsd_index_entry</a>));</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="keywordflow">if</span> (buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a> == NULL)</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;        {</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba927545200d5ae6b308d536988ff37637">GSD_ERROR_MEMORY_ALLOCATION_FAILED</a>;</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;        }</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160; </div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    buf-&gt;<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> = 0;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    buf-&gt;<a class="code" href="structgsd__index__buffer.html#a51a1e266f6d7d1aafdfd54822fc226b1">reserved</a> = reserve;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    buf-&gt;<a class="code" href="structgsd__index__buffer.html#aa4cf014343ec2746f964695d5502cc87">mapped_data</a> = NULL;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    buf-&gt;<a class="code" href="structgsd__index__buffer.html#a3e8c9fe43b2fe61968336cb4a763b980">mapped_len</a> = 0;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00226">gsd_index_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00078">GSD_ERROR_INVALID_ARGUMENT</a>, <a class="el" href="gsd_8h_source.html#l00090">GSD_ERROR_MEMORY_ALLOCATION_FAILED</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, <a class="el" href="gsd_8h_source.html#l00235">gsd_index_buffer::mapped_data</a>, <a class="el" href="gsd_8h_source.html#l00238">gsd_index_buffer::mapped_len</a>, <a class="el" href="gsd_8h_source.html#l00232">gsd_index_buffer::reserved</a>, and <a class="el" href="gsd_8h_source.html#l00229">gsd_index_buffer::size</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l00593">gsd_index_buffer_map()</a>, <a class="el" href="gsd_8c_source.html#l01401">gsd_initialize_handle()</a>, and <a class="el" href="gsd_8c_source.html#l02300">gsd_upgrade()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_ae1948c93f77d642c4e3797fe7e5f2095_icgraph.svg" width="986" height="215"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a6fe75caf6c4df550af2455a0c40bfbdf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fe75caf6c4df550af2455a0c40bfbdf">&#9670;&nbsp;</a></span>gsd_index_buffer_map()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int gsd_index_buffer_map </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__index__buffer.html">gsd_index_buffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *&#160;</td>
          <td class="paramname"><em>handle</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00593">593</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    {</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    <span class="keywordflow">if</span> (buf == NULL || buf-&gt;<a class="code" href="structgsd__index__buffer.html#aa4cf014343ec2746f964695d5502cc87">mapped_data</a> || buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a> || buf-&gt;<a class="code" href="structgsd__index__buffer.html#a51a1e266f6d7d1aafdfd54822fc226b1">reserved</a> != 0 || buf-&gt;<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> != 0)</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160; </div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    <span class="comment">// validate that the index block exists inside the file</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a89d5af9234f456010e16116452064b78">index_location</a></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;            + <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__index__entry.html">gsd_index_entry</a>) * handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a6ad2a01f3c1926eacab74d693ac34bdf">index_allocated_entries</a></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        &gt; (uint64_t)handle-&gt;<a class="code" href="structgsd__handle.html#ac35aad0eef4a5844ecc4141041fa9243">file_size</a>)</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba4236f6900d8a81a3a4ccafa2170ad27c">GSD_ERROR_FILE_CORRUPT</a>;</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        }</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;<span class="preprocessor">#if GSD_USE_MMAP</span></div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="comment">// map the index in read only mode</span></div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordtype">size_t</span> page_size = getpagesize();</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;    <span class="keywordtype">size_t</span> index_size = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structgsd__index__entry.html">gsd_index_entry</a>) * handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a6ad2a01f3c1926eacab74d693ac34bdf">index_allocated_entries</a>;</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordtype">size_t</span> offset = (handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a89d5af9234f456010e16116452064b78">index_location</a> / page_size) * page_size;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    buf-&gt;<a class="code" href="structgsd__index__buffer.html#aa4cf014343ec2746f964695d5502cc87">mapped_data</a> = mmap(NULL,</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                            index_size + (handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a89d5af9234f456010e16116452064b78">index_location</a> - offset),</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                            PROT_READ,</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                            MAP_SHARED,</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                            handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>,</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                            offset);</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160; </div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    <span class="keywordflow">if</span> (buf-&gt;<a class="code" href="structgsd__index__buffer.html#aa4cf014343ec2746f964695d5502cc87">mapped_data</a> == MAP_FAILED)</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160; </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;    buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a> = (<span class="keyword">struct </span><a class="code" href="structgsd__index__entry.html">gsd_index_entry</a>*)(((<span class="keywordtype">char</span>*)buf-&gt;<a class="code" href="structgsd__index__buffer.html#aa4cf014343ec2746f964695d5502cc87">mapped_data</a>)</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                                          + (handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a89d5af9234f456010e16116452064b78">index_location</a> - offset));</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160; </div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    buf-&gt;<a class="code" href="structgsd__index__buffer.html#a3e8c9fe43b2fe61968336cb4a763b980">mapped_len</a> = index_size + (handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a89d5af9234f456010e16116452064b78">index_location</a> - offset);</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    buf-&gt;<a class="code" href="structgsd__index__buffer.html#a51a1e266f6d7d1aafdfd54822fc226b1">reserved</a> = handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a6ad2a01f3c1926eacab74d693ac34bdf">index_allocated_entries</a>;</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;<span class="preprocessor">#else</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="comment">// mmap not supported, read the data from the disk</span></div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    <span class="keywordtype">int</span> retval = <a class="code" href="gsd_8c.html#ae1948c93f77d642c4e3797fe7e5f2095">gsd_index_buffer_allocate</a>(buf, handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a6ad2a01f3c1926eacab74d693ac34bdf">index_allocated_entries</a>);</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        {</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;        <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        }</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160; </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    ssize_t bytes_read = <a class="code" href="gsd_8c.html#ac1f41abbefbfe35337e7053d766c089b">gsd_io_pread_retry</a>(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>,</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                                            buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>,</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                                            <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__index__entry.html">gsd_index_entry</a>)</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                                                * handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a6ad2a01f3c1926eacab74d693ac34bdf">index_allocated_entries</a>,</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                                            handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a89d5af9234f456010e16116452064b78">index_location</a>);</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160; </div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <span class="keywordflow">if</span> (bytes_read == -1</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;        || bytes_read != <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__index__entry.html">gsd_index_entry</a>) * handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a6ad2a01f3c1926eacab74d693ac34bdf">index_allocated_entries</a>)</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;        {</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        }</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="comment">// determine the number of index entries in the list</span></div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="comment">// file is corrupt if first index entry is invalid</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">if</span> (buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>[0].<a class="code" href="structgsd__index__entry.html#a70e15b9094a3a22954bba035496d83bf">location</a> != 0 &amp;&amp; !<a class="code" href="gsd_8c.html#ab5d19295bedec41b7919caec2cb22759">gsd_is_entry_valid</a>(handle, 0))</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        {</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba4236f6900d8a81a3a4ccafa2170ad27c">GSD_ERROR_FILE_CORRUPT</a>;</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;        }</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160; </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    <span class="keywordflow">if</span> (buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>[0].<a class="code" href="structgsd__index__entry.html#a70e15b9094a3a22954bba035496d83bf">location</a> == 0)</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        {</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        buf-&gt;<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> = 0;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        {</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <span class="comment">// determine the number of index entries (marked by location = 0)</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="comment">// binary search for the first index entry with location 0</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="keywordtype">size_t</span> L = 0;</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        <span class="keywordtype">size_t</span> R = buf-&gt;<a class="code" href="structgsd__index__buffer.html#a51a1e266f6d7d1aafdfd54822fc226b1">reserved</a>;</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        <span class="comment">// progressively narrow the search window by halves</span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;        <span class="keywordflow">do</span></div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;            {</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <span class="keywordtype">size_t</span> m = (L + R) / 2;</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160; </div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            <span class="comment">// file is corrupt if any index entry is invalid or frame does not increase</span></div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            <span class="comment">// monotonically</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            <span class="keywordflow">if</span> (buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>[m].<a class="code" href="structgsd__index__entry.html#a70e15b9094a3a22954bba035496d83bf">location</a> != 0</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;                &amp;&amp; (!<a class="code" href="gsd_8c.html#ab5d19295bedec41b7919caec2cb22759">gsd_is_entry_valid</a>(handle, m) || buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>[m].<a class="code" href="structgsd__index__entry.html#a1b6c67d9197aa4588964052c2919092e">frame</a> &lt; buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>[L].<a class="code" href="structgsd__index__entry.html#a1b6c67d9197aa4588964052c2919092e">frame</a>))</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                {</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba4236f6900d8a81a3a4ccafa2170ad27c">GSD_ERROR_FILE_CORRUPT</a>;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                }</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            <span class="keywordflow">if</span> (buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>[m].<a class="code" href="structgsd__index__entry.html#a70e15b9094a3a22954bba035496d83bf">location</a> != 0)</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                {</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                L = m;</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                }</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                {</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                R = m;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                }</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;            } <span class="keywordflow">while</span> ((R - L) &gt; 1);</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160; </div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="comment">// this finds R = the first index entry with location = 0</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        buf-&gt;<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> = R;</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        }</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; </div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00226">gsd_index_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00284">gsd_handle::fd</a>, <a class="el" href="gsd_8h_source.html#l00311">gsd_handle::file_size</a>, <a class="el" href="gsd_8h_source.html#l00169">gsd_index_entry::frame</a>, <a class="el" href="gsd_8h_source.html#l00087">GSD_ERROR_FILE_CORRUPT</a>, <a class="el" href="gsd_8h_source.html#l00078">GSD_ERROR_INVALID_ARGUMENT</a>, <a class="el" href="gsd_8h_source.html#l00075">GSD_ERROR_IO</a>, <a class="el" href="gsd_8c_source.html#l00558">gsd_index_buffer_allocate()</a>, <a class="el" href="gsd_8c_source.html#l00190">gsd_io_pread_retry()</a>, <a class="el" href="gsd_8c_source.html#l00417">gsd_is_entry_valid()</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, <a class="el" href="gsd_8h_source.html#l00287">gsd_handle::header</a>, <a class="el" href="gsd_8h_source.html#l00136">gsd_header::index_allocated_entries</a>, <a class="el" href="gsd_8h_source.html#l00133">gsd_header::index_location</a>, <a class="el" href="gsd_8h_source.html#l00175">gsd_index_entry::location</a>, <a class="el" href="gsd_8h_source.html#l00235">gsd_index_buffer::mapped_data</a>, <a class="el" href="gsd_8h_source.html#l00238">gsd_index_buffer::mapped_len</a>, <a class="el" href="gsd_8h_source.html#l00232">gsd_index_buffer::reserved</a>, and <a class="el" href="gsd_8h_source.html#l00229">gsd_index_buffer::size</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l00933">gsd_expand_file_index()</a>, <a class="el" href="gsd_8c_source.html#l01401">gsd_initialize_handle()</a>, and <a class="el" href="gsd_8c_source.html#l02300">gsd_upgrade()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a6fe75caf6c4df550af2455a0c40bfbdf_cgraph.svg" width="548" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a6fe75caf6c4df550af2455a0c40bfbdf_icgraph.svg" width="766" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a9e12a38df69cf73fa771b005748cb3e5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e12a38df69cf73fa771b005748cb3e5">&#9670;&nbsp;</a></span>gsd_index_buffer_free()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int gsd_index_buffer_free </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__index__buffer.html">gsd_index_buffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00706">706</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    {</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordflow">if</span> (buf == NULL || buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a> == NULL)</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;        {</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        }</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160; </div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="preprocessor">#if GSD_USE_MMAP</span></div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordflow">if</span> (buf-&gt;<a class="code" href="structgsd__index__buffer.html#aa4cf014343ec2746f964695d5502cc87">mapped_data</a>)</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;        {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        <span class="keywordtype">int</span> retval = munmap(buf-&gt;<a class="code" href="structgsd__index__buffer.html#aa4cf014343ec2746f964695d5502cc87">mapped_data</a>, buf-&gt;<a class="code" href="structgsd__index__buffer.html#a3e8c9fe43b2fe61968336cb4a763b980">mapped_len</a>);</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160; </div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        <span class="keywordflow">if</span> (retval != 0)</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;            {</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            }</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        }</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        {</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        free(buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>);</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        }</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160; </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <a class="code" href="gsd_8c.html#a9b05d58560daee2512f03bedf7b2926d">gsd_util_zero_memory</a>(buf, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__index__buffer.html">gsd_index_buffer</a>));</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00226">gsd_index_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00078">GSD_ERROR_INVALID_ARGUMENT</a>, <a class="el" href="gsd_8h_source.html#l00075">GSD_ERROR_IO</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, <a class="el" href="gsd_8c_source.html#l00130">gsd_util_zero_memory()</a>, <a class="el" href="gsd_8h_source.html#l00235">gsd_index_buffer::mapped_data</a>, and <a class="el" href="gsd_8h_source.html#l00238">gsd_index_buffer::mapped_len</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l01763">gsd_close()</a>, <a class="el" href="gsd_8c_source.html#l00933">gsd_expand_file_index()</a>, <a class="el" href="gsd_8c_source.html#l01677">gsd_truncate()</a>, and <a class="el" href="gsd_8c_source.html#l02300">gsd_upgrade()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a9e12a38df69cf73fa771b005748cb3e5_cgraph.svg" width="362" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a9e12a38df69cf73fa771b005748cb3e5_icgraph.svg" width="783" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a258b64725f90f60d969752d65fba9850"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a258b64725f90f60d969752d65fba9850">&#9670;&nbsp;</a></span>gsd_index_buffer_add()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int gsd_index_buffer_add </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__index__buffer.html">gsd_index_buffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgsd__index__entry.html">gsd_index_entry</a> **&#160;</td>
          <td class="paramname"><em>entry</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00744">744</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    {</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    <span class="keywordflow">if</span> (buf == NULL || buf-&gt;<a class="code" href="structgsd__index__buffer.html#aa4cf014343ec2746f964695d5502cc87">mapped_data</a> || entry == NULL || buf-&gt;<a class="code" href="structgsd__index__buffer.html#a51a1e266f6d7d1aafdfd54822fc226b1">reserved</a> == 0)</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;        {</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;        }</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160; </div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <span class="keywordflow">if</span> (buf-&gt;<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> == buf-&gt;<a class="code" href="structgsd__index__buffer.html#a51a1e266f6d7d1aafdfd54822fc226b1">reserved</a>)</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;        {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="comment">// grow the array</span></div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        <span class="keywordtype">size_t</span> new_reserved = buf-&gt;<a class="code" href="structgsd__index__buffer.html#a51a1e266f6d7d1aafdfd54822fc226b1">reserved</a> * 2;</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a> = realloc(buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__index__entry.html">gsd_index_entry</a>) * new_reserved);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;        <span class="keywordflow">if</span> (buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a> == NULL)</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            {</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba927545200d5ae6b308d536988ff37637">GSD_ERROR_MEMORY_ALLOCATION_FAILED</a>;</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160; </div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="comment">// zero the new memory</span></div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        <a class="code" href="gsd_8c.html#a9b05d58560daee2512f03bedf7b2926d">gsd_util_zero_memory</a>(buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a> + buf-&gt;<a class="code" href="structgsd__index__buffer.html#a51a1e266f6d7d1aafdfd54822fc226b1">reserved</a>,</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;                             <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__index__entry.html">gsd_index_entry</a>) * (new_reserved - buf-&gt;<a class="code" href="structgsd__index__buffer.html#a51a1e266f6d7d1aafdfd54822fc226b1">reserved</a>));</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;        buf-&gt;<a class="code" href="structgsd__index__buffer.html#a51a1e266f6d7d1aafdfd54822fc226b1">reserved</a> = new_reserved;</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;        }</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <span class="keywordtype">size_t</span> insert_pos = buf-&gt;<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a>;</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    buf-&gt;<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a>++;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    *entry = buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a> + insert_pos;</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160; </div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00226">gsd_index_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00078">GSD_ERROR_INVALID_ARGUMENT</a>, <a class="el" href="gsd_8h_source.html#l00090">GSD_ERROR_MEMORY_ALLOCATION_FAILED</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, <a class="el" href="gsd_8c_source.html#l00130">gsd_util_zero_memory()</a>, <a class="el" href="gsd_8h_source.html#l00235">gsd_index_buffer::mapped_data</a>, <a class="el" href="gsd_8h_source.html#l00232">gsd_index_buffer::reserved</a>, and <a class="el" href="gsd_8h_source.html#l00229">gsd_index_buffer::size</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l01081">gsd_flush_write_buffer()</a>, and <a class="el" href="gsd_8c_source.html#l01916">gsd_write_chunk()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a258b64725f90f60d969752d65fba9850_cgraph.svg" width="360" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a258b64725f90f60d969752d65fba9850_icgraph.svg" width="942" height="176"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a3ffe758eed9a5bae487f514a0a45e97d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ffe758eed9a5bae487f514a0a45e97d">&#9670;&nbsp;</a></span>gsd_cmp_index_entry()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int gsd_cmp_index_entry </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structgsd__index__entry.html">gsd_index_entry</a> *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structgsd__index__entry.html">gsd_index_entry</a> *&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00774">774</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    {</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="keywordtype">int</span> result = 0;</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structgsd__index__entry.html#a1b6c67d9197aa4588964052c2919092e">frame</a> &lt; b-&gt;<a class="code" href="structgsd__index__entry.html#a1b6c67d9197aa4588964052c2919092e">frame</a>)</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;        {</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;        result = -1;</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;        }</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160; </div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structgsd__index__entry.html#a1b6c67d9197aa4588964052c2919092e">frame</a> &gt; b-&gt;<a class="code" href="structgsd__index__entry.html#a1b6c67d9197aa4588964052c2919092e">frame</a>)</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        result = 1;</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;        }</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160; </div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;    <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structgsd__index__entry.html#a1b6c67d9197aa4588964052c2919092e">frame</a> == b-&gt;<a class="code" href="structgsd__index__entry.html#a1b6c67d9197aa4588964052c2919092e">frame</a>)</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;        {</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;        <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structgsd__index__entry.html#aa7ed270380c0d8074232aad5bb32bfb4">id</a> &lt; b-&gt;<a class="code" href="structgsd__index__entry.html#aa7ed270380c0d8074232aad5bb32bfb4">id</a>)</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            {</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            result = -1;</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            }</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160; </div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;        <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structgsd__index__entry.html#aa7ed270380c0d8074232aad5bb32bfb4">id</a> &gt; b-&gt;<a class="code" href="structgsd__index__entry.html#aa7ed270380c0d8074232aad5bb32bfb4">id</a>)</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;            {</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;            result = 1;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;            }</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160; </div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        <span class="keywordflow">if</span> (a-&gt;<a class="code" href="structgsd__index__entry.html#aa7ed270380c0d8074232aad5bb32bfb4">id</a> == b-&gt;<a class="code" href="structgsd__index__entry.html#aa7ed270380c0d8074232aad5bb32bfb4">id</a>)</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            {</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;            result = 0;</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            }</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        }</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160; </div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    <span class="keywordflow">return</span> result;</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00169">gsd_index_entry::frame</a>, and <a class="el" href="gsd_8h_source.html#l00181">gsd_index_entry::id</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l02039">gsd_find_chunk()</a>, and <a class="el" href="gsd_8c_source.html#l00847">gsd_heap_shift_down()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a3ffe758eed9a5bae487f514a0a45e97d_icgraph.svg" width="1166" height="266"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ab7b8e133941184a32c2d90414dfba6a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7b8e133941184a32c2d90414dfba6a5">&#9670;&nbsp;</a></span>gsd_heap_parent()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t gsd_heap_parent </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00814">814</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordflow">return</span> (i - 1) / 2;</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l00879">gsd_heapify()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_ab7b8e133941184a32c2d90414dfba6a5_icgraph.svg" width="820" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aaec0ae1e441692725a568aee8c8ef627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaec0ae1e441692725a568aee8c8ef627">&#9670;&nbsp;</a></span>gsd_heap_left_child()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static size_t gsd_heap_left_child </td>
          <td>(</td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00823">823</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    {</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">return</span> 2 * i + 1;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l00847">gsd_heap_shift_down()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_aaec0ae1e441692725a568aee8c8ef627_icgraph.svg" width="1032" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a987a1d460f7ca33476fc57bcc1ff8439"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a987a1d460f7ca33476fc57bcc1ff8439">&#9670;&nbsp;</a></span>gsd_heap_swap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void gsd_heap_swap </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__index__buffer.html">gsd_index_buffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>b</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00834">834</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    {</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="keyword">struct </span><a class="code" href="structgsd__index__entry.html">gsd_index_entry</a> tmp = buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>[a];</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>[a] = buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>[b];</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>[b] = tmp;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00226">gsd_index_buffer::data</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l00847">gsd_heap_shift_down()</a>, and <a class="el" href="gsd_8c_source.html#l00899">gsd_index_buffer_sort()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a987a1d460f7ca33476fc57bcc1ff8439_icgraph.svg" width="1011" height="114"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="accc971ec12e75a165ffef6e1ee854681"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accc971ec12e75a165ffef6e1ee854681">&#9670;&nbsp;</a></span>gsd_heap_shift_down()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void gsd_heap_shift_down </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__index__buffer.html">gsd_index_buffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>start</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>end</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00847">847</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    {</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    <span class="keywordtype">size_t</span> root = start;</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160; </div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="gsd_8c.html#aaec0ae1e441692725a568aee8c8ef627">gsd_heap_left_child</a>(root) &lt;= end)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        {</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;        <span class="keywordtype">size_t</span> child = <a class="code" href="gsd_8c.html#aaec0ae1e441692725a568aee8c8ef627">gsd_heap_left_child</a>(root);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        <span class="keywordtype">size_t</span> swap = root;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="gsd_8c.html#a3ffe758eed9a5bae487f514a0a45e97d">gsd_cmp_index_entry</a>(buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a> + swap, buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a> + child) &lt; 0)</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            {</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;            swap = child;</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;            }</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;        <span class="keywordflow">if</span> (child + 1 &lt;= end &amp;&amp; <a class="code" href="gsd_8c.html#a3ffe758eed9a5bae487f514a0a45e97d">gsd_cmp_index_entry</a>(buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a> + swap, buf-&gt;<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a> + child + 1) &lt; 0)</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;            {</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;            swap = child + 1;</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;            }</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160; </div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <span class="keywordflow">if</span> (swap == root)</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;            {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;            <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;            }</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <a class="code" href="gsd_8c.html#a987a1d460f7ca33476fc57bcc1ff8439">gsd_heap_swap</a>(buf, root, swap);</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        root = swap;</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        }</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00226">gsd_index_buffer::data</a>, <a class="el" href="gsd_8c_source.html#l00774">gsd_cmp_index_entry()</a>, <a class="el" href="gsd_8c_source.html#l00823">gsd_heap_left_child()</a>, and <a class="el" href="gsd_8c_source.html#l00834">gsd_heap_swap()</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l00879">gsd_heapify()</a>, and <a class="el" href="gsd_8c_source.html#l00899">gsd_index_buffer_sort()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_accc971ec12e75a165ffef6e1ee854681_cgraph.svg" width="356" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_accc971ec12e75a165ffef6e1ee854681_icgraph.svg" width="847" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a0de3f89cdd57571b57401c91feef2f66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0de3f89cdd57571b57401c91feef2f66">&#9670;&nbsp;</a></span>gsd_heapify()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void gsd_heapify </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__index__buffer.html">gsd_index_buffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00879">879</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;    {</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    ssize_t start = <a class="code" href="gsd_8c.html#ab7b8e133941184a32c2d90414dfba6a5">gsd_heap_parent</a>(buf-&gt;<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> - 1);</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keywordflow">while</span> (start &gt;= 0)</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;        {</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        <a class="code" href="gsd_8c.html#accc971ec12e75a165ffef6e1ee854681">gsd_heap_shift_down</a>(buf, start, buf-&gt;<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> - 1);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        start--;</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;        }</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8c_source.html#l00814">gsd_heap_parent()</a>, <a class="el" href="gsd_8c_source.html#l00847">gsd_heap_shift_down()</a>, and <a class="el" href="gsd_8h_source.html#l00229">gsd_index_buffer::size</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l00899">gsd_index_buffer_sort()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a0de3f89cdd57571b57401c91feef2f66_cgraph.svg" width="496" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a0de3f89cdd57571b57401c91feef2f66_icgraph.svg" width="651" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a6c20ccb47eed1a3ea9995a47a8eebdbd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c20ccb47eed1a3ea9995a47a8eebdbd">&#9670;&nbsp;</a></span>gsd_index_buffer_sort()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int gsd_index_buffer_sort </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__index__buffer.html">gsd_index_buffer</a> *&#160;</td>
          <td class="paramname"><em>buf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00899">899</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    {</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    <span class="keywordflow">if</span> (buf == NULL || buf-&gt;<a class="code" href="structgsd__index__buffer.html#aa4cf014343ec2746f964695d5502cc87">mapped_data</a> || buf-&gt;<a class="code" href="structgsd__index__buffer.html#a51a1e266f6d7d1aafdfd54822fc226b1">reserved</a> == 0)</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        {</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        }</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;    <span class="comment">// arrays of size 0 or 1 are already sorted</span></div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;    <span class="keywordflow">if</span> (buf-&gt;<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> &lt;= 1)</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        {</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        }</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160; </div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    <a class="code" href="gsd_8c.html#a0de3f89cdd57571b57401c91feef2f66">gsd_heapify</a>(buf);</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;    <span class="keywordtype">size_t</span> end = buf-&gt;<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> - 1;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="keywordflow">while</span> (end &gt; 0)</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        {</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <a class="code" href="gsd_8c.html#a987a1d460f7ca33476fc57bcc1ff8439">gsd_heap_swap</a>(buf, end, 0);</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        end = end - 1;</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <a class="code" href="gsd_8c.html#accc971ec12e75a165ffef6e1ee854681">gsd_heap_shift_down</a>(buf, 0, end);</div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;        }</div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00078">GSD_ERROR_INVALID_ARGUMENT</a>, <a class="el" href="gsd_8c_source.html#l00847">gsd_heap_shift_down()</a>, <a class="el" href="gsd_8c_source.html#l00834">gsd_heap_swap()</a>, <a class="el" href="gsd_8c_source.html#l00879">gsd_heapify()</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, <a class="el" href="gsd_8h_source.html#l00235">gsd_index_buffer::mapped_data</a>, <a class="el" href="gsd_8h_source.html#l00232">gsd_index_buffer::reserved</a>, and <a class="el" href="gsd_8h_source.html#l00229">gsd_index_buffer::size</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l01842">gsd_end_frame()</a>, and <a class="el" href="gsd_8c_source.html#l02300">gsd_upgrade()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a6c20ccb47eed1a3ea9995a47a8eebdbd_cgraph.svg" width="694" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a6c20ccb47eed1a3ea9995a47a8eebdbd_icgraph.svg" width="511" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ae6dddb94661e99e54f6c01b1a443e27f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6dddb94661e99e54f6c01b1a443e27f">&#9670;&nbsp;</a></span>gsd_expand_file_index()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int gsd_expand_file_index </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>size_required</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00933">933</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    {</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a37ddf6d53fc8c4f3eff247508fcc814b">open_flags</a> == <a class="code" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a22f5dee98250b8ead7d43cc1a347f205">GSD_OPEN_READONLY</a>)</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        {</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa5cbc2efac6a7d90f89b616e791eac64">GSD_ERROR_FILE_MUST_BE_WRITABLE</a>;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        }</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    <span class="comment">// multiply the index size each time it grows</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;    <span class="comment">// this allows the index to grow rapidly to accommodate new frames</span></div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> multiplication_factor = 2;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160; </div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;    <span class="comment">// save the old size and update the new size</span></div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keywordtype">size_t</span> size_old = handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a6ad2a01f3c1926eacab74d693ac34bdf">index_allocated_entries</a>;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;    <span class="keywordtype">size_t</span> size_new = size_old * multiplication_factor;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160; </div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    <span class="keywordflow">while</span> (size_new &lt;= size_required)</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;        {</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        size_new *= multiplication_factor;</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        }</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160; </div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">// Mac systems deadlock when writing from a mapped region into the tail end of that same region</span></div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="comment">// unmap the index first and copy it over by chunks</span></div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordtype">int</span> retval = <a class="code" href="gsd_8c.html#a9e12a38df69cf73fa771b005748cb3e5">gsd_index_buffer_free</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>);</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="keywordflow">if</span> (retval != 0)</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;        {</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;        <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;        }</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="comment">// allocate the copy buffer</span></div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordtype">char</span>* buf = malloc(<a class="code" href="gsd_8c.html#adc29c2ff13d900c2f185ee95427fb06ca4cede151f20532731cb30ac33609508f">GSD_COPY_BUFFER_SIZE</a>);</div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160; </div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="comment">// write the current index to the end of the file</span></div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    int64_t new_index_location = lseek(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>, 0, SEEK_END);</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    int64_t old_index_location = handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a89d5af9234f456010e16116452064b78">index_location</a>;</div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keywordtype">size_t</span> total_bytes_written = 0;</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <span class="keywordtype">size_t</span> old_index_bytes = size_old * <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structgsd__index__entry.html">gsd_index_entry</a>);</div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;    <span class="keywordflow">while</span> (total_bytes_written &lt; old_index_bytes)</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        {</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <span class="keywordtype">size_t</span> bytes_to_copy = <a class="code" href="gsd_8c.html#adc29c2ff13d900c2f185ee95427fb06ca4cede151f20532731cb30ac33609508f">GSD_COPY_BUFFER_SIZE</a>;</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        <span class="keywordflow">if</span> (old_index_bytes - total_bytes_written &lt; <a class="code" href="gsd_8c.html#adc29c2ff13d900c2f185ee95427fb06ca4cede151f20532731cb30ac33609508f">GSD_COPY_BUFFER_SIZE</a>)</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;            {</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;            bytes_to_copy = old_index_bytes - total_bytes_written;</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;            }</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160; </div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;        ssize_t bytes_read = <a class="code" href="gsd_8c.html#ac1f41abbefbfe35337e7053d766c089b">gsd_io_pread_retry</a>(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>,</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;                                                buf,</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;                                                bytes_to_copy,</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                                                old_index_location + total_bytes_written);</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;        <span class="keywordflow">if</span> (bytes_read == -1 || bytes_read != bytes_to_copy)</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;            {</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;            free(buf);</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;            }</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160; </div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;        ssize_t bytes_written = <a class="code" href="gsd_8c.html#a3fb7746d93a1c856ca7ef64fa3548cbe">gsd_io_pwrite_retry</a>(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>,</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;                                                    buf,</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;                                                    bytes_to_copy,</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;                                                    new_index_location + total_bytes_written);</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;        <span class="keywordflow">if</span> (bytes_written == -1 || bytes_written != bytes_to_copy)</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;            {</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;            free(buf);</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;            }</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160; </div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;        total_bytes_written += bytes_written;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;        }</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160; </div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="comment">// fill the new index space with 0s</span></div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <a class="code" href="gsd_8c.html#a9b05d58560daee2512f03bedf7b2926d">gsd_util_zero_memory</a>(buf, <a class="code" href="gsd_8c.html#adc29c2ff13d900c2f185ee95427fb06ca4cede151f20532731cb30ac33609508f">GSD_COPY_BUFFER_SIZE</a>);</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160; </div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    <span class="keywordtype">size_t</span> new_index_bytes = size_new * <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structgsd__index__entry.html">gsd_index_entry</a>);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;    <span class="keywordflow">while</span> (total_bytes_written &lt; new_index_bytes)</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        {</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        <span class="keywordtype">size_t</span> bytes_to_copy = <a class="code" href="gsd_8c.html#adc29c2ff13d900c2f185ee95427fb06ca4cede151f20532731cb30ac33609508f">GSD_COPY_BUFFER_SIZE</a>;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        <span class="keywordflow">if</span> (new_index_bytes - total_bytes_written &lt; <a class="code" href="gsd_8c.html#adc29c2ff13d900c2f185ee95427fb06ca4cede151f20532731cb30ac33609508f">GSD_COPY_BUFFER_SIZE</a>)</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;            {</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;            bytes_to_copy = new_index_bytes - total_bytes_written;</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;            }</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160; </div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;        ssize_t bytes_written = <a class="code" href="gsd_8c.html#a3fb7746d93a1c856ca7ef64fa3548cbe">gsd_io_pwrite_retry</a>(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>,</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;                                                    buf,</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;                                                    bytes_to_copy,</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                                                    new_index_location + total_bytes_written);</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; </div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;        <span class="keywordflow">if</span> (bytes_written == -1 || bytes_written != bytes_to_copy)</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            {</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            free(buf);</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;            }</div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160; </div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;        total_bytes_written += bytes_written;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;        }</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160; </div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="comment">// sync the expanded index</span></div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;    retval = fsync(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>);</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="keywordflow">if</span> (retval != 0)</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        {</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;        free(buf);</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;        }</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160; </div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="comment">// free the copy buffer</span></div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    free(buf);</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160; </div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    <span class="comment">// update the header</span></div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a89d5af9234f456010e16116452064b78">index_location</a> = new_index_location;</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    handle-&gt;<a class="code" href="structgsd__handle.html#ac35aad0eef4a5844ecc4141041fa9243">file_size</a> = handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a89d5af9234f456010e16116452064b78">index_location</a> + total_bytes_written;</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a6ad2a01f3c1926eacab74d693ac34bdf">index_allocated_entries</a> = size_new;</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160; </div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    <span class="comment">// write the new header out</span></div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;    ssize_t bytes_written</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;        = <a class="code" href="gsd_8c.html#a3fb7746d93a1c856ca7ef64fa3548cbe">gsd_io_pwrite_retry</a>(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>, &amp;(handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>), <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__header.html">gsd_header</a>), 0);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="keywordflow">if</span> (bytes_written != <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__header.html">gsd_header</a>))</div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;        {</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;        }</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160; </div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="comment">// sync the updated header</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    retval = fsync(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="keywordflow">if</span> (retval != 0)</div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;        {</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;        }</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160; </div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;    <span class="comment">// remap the file index</span></div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    retval = <a class="code" href="gsd_8c.html#a6fe75caf6c4df550af2455a0c40bfbdf">gsd_index_buffer_map</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>, handle);</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;    <span class="keywordflow">if</span> (retval != 0)</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;        {</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;        }</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160; </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00284">gsd_handle::fd</a>, <a class="el" href="gsd_8h_source.html#l00290">gsd_handle::file_index</a>, <a class="el" href="gsd_8h_source.html#l00311">gsd_handle::file_size</a>, <a class="el" href="gsd_8c_source.html#l00069">GSD_COPY_BUFFER_SIZE</a>, <a class="el" href="gsd_8h_source.html#l00098">GSD_ERROR_FILE_MUST_BE_WRITABLE</a>, <a class="el" href="gsd_8h_source.html#l00075">GSD_ERROR_IO</a>, <a class="el" href="gsd_8c_source.html#l00706">gsd_index_buffer_free()</a>, <a class="el" href="gsd_8c_source.html#l00593">gsd_index_buffer_map()</a>, <a class="el" href="gsd_8c_source.html#l00190">gsd_io_pread_retry()</a>, <a class="el" href="gsd_8c_source.html#l00148">gsd_io_pwrite_retry()</a>, <a class="el" href="gsd_8h_source.html#l00062">GSD_OPEN_READONLY</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, <a class="el" href="gsd_8c_source.html#l00130">gsd_util_zero_memory()</a>, <a class="el" href="gsd_8h_source.html#l00287">gsd_handle::header</a>, <a class="el" href="gsd_8h_source.html#l00136">gsd_header::index_allocated_entries</a>, <a class="el" href="gsd_8h_source.html#l00133">gsd_header::index_location</a>, and <a class="el" href="gsd_8h_source.html#l00314">gsd_handle::open_flags</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l01842">gsd_end_frame()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_ae6dddb94661e99e54f6c01b1a443e27f_cgraph.svg" width="751" height="240"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_ae6dddb94661e99e54f6c01b1a443e27f_icgraph.svg" width="516" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a61daeaa70162e9bac3d241832b460278"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a61daeaa70162e9bac3d241832b460278">&#9670;&nbsp;</a></span>gsd_flush_write_buffer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int gsd_flush_write_buffer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *&#160;</td>
          <td class="paramname"><em>handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l01081">1081</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;    {</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="keywordflow">if</span> (handle == NULL)</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        {</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;        }</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a7ae49d668bbd61ce9d022acf5e5a9e76">write_buffer</a>.<a class="code" href="structgsd__byte__buffer.html#a3630961b7d45df2885cdd887e4b83b60">size</a> == 0 &amp;&amp; handle-&gt;<a class="code" href="structgsd__handle.html#a501968a30f0b06f4b7cb69c115648627">buffer_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> == 0)</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        {</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        <span class="comment">// nothing to do</span></div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;        }</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160; </div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a7ae49d668bbd61ce9d022acf5e5a9e76">write_buffer</a>.<a class="code" href="structgsd__byte__buffer.html#a3630961b7d45df2885cdd887e4b83b60">size</a> &gt; 0 &amp;&amp; handle-&gt;<a class="code" href="structgsd__handle.html#a501968a30f0b06f4b7cb69c115648627">buffer_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> == 0)</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        {</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;        <span class="comment">// error: bytes in buffer, but no index for them</span></div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;        }</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    <span class="comment">// write the buffer to the end of the file</span></div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    uint64_t offset = handle-&gt;<a class="code" href="structgsd__handle.html#ac35aad0eef4a5844ecc4141041fa9243">file_size</a>;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    ssize_t bytes_written = <a class="code" href="gsd_8c.html#a3fb7746d93a1c856ca7ef64fa3548cbe">gsd_io_pwrite_retry</a>(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>,</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;                                                handle-&gt;<a class="code" href="structgsd__handle.html#a7ae49d668bbd61ce9d022acf5e5a9e76">write_buffer</a>.<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a>,</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;                                                handle-&gt;<a class="code" href="structgsd__handle.html#a7ae49d668bbd61ce9d022acf5e5a9e76">write_buffer</a>.<a class="code" href="structgsd__byte__buffer.html#a3630961b7d45df2885cdd887e4b83b60">size</a>,</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;                                                offset);</div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160; </div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;    <span class="keywordflow">if</span> (bytes_written == -1 || bytes_written != handle-&gt;<a class="code" href="structgsd__handle.html#a7ae49d668bbd61ce9d022acf5e5a9e76">write_buffer</a>.<a class="code" href="structgsd__byte__buffer.html#a3630961b7d45df2885cdd887e4b83b60">size</a>)</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        {</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;        }</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160; </div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;    handle-&gt;<a class="code" href="structgsd__handle.html#ac35aad0eef4a5844ecc4141041fa9243">file_size</a> += handle-&gt;<a class="code" href="structgsd__handle.html#a7ae49d668bbd61ce9d022acf5e5a9e76">write_buffer</a>.<a class="code" href="structgsd__byte__buffer.html#a3630961b7d45df2885cdd887e4b83b60">size</a>;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160; </div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;    <span class="comment">// reset write_buffer for new data</span></div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;    handle-&gt;<a class="code" href="structgsd__handle.html#a7ae49d668bbd61ce9d022acf5e5a9e76">write_buffer</a>.<a class="code" href="structgsd__byte__buffer.html#a3630961b7d45df2885cdd887e4b83b60">size</a> = 0;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160; </div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    <span class="comment">// move buffer_index entries to file_index</span></div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    <span class="keywordtype">size_t</span> i;</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; handle-&gt;<a class="code" href="structgsd__handle.html#a501968a30f0b06f4b7cb69c115648627">buffer_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a>; i++)</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        {</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        <span class="keyword">struct </span><a class="code" href="structgsd__index__entry.html">gsd_index_entry</a>* new_index;</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        <span class="keywordtype">int</span> retval = <a class="code" href="gsd_8c.html#a258b64725f90f60d969752d65fba9850">gsd_index_buffer_add</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a9086141add0c7be99bcfed3bfd6dadac">frame_index</a>, &amp;new_index);</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;            {</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;            }</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160; </div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        *new_index = handle-&gt;<a class="code" href="structgsd__handle.html#a501968a30f0b06f4b7cb69c115648627">buffer_index</a>.<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>[i];</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;        new_index-&gt;<a class="code" href="structgsd__index__entry.html#a70e15b9094a3a22954bba035496d83bf">location</a> += offset;</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        }</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160; </div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <span class="comment">// clear the buffer index for new entries</span></div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    handle-&gt;<a class="code" href="structgsd__handle.html#a501968a30f0b06f4b7cb69c115648627">buffer_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> = 0;</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160; </div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00296">gsd_handle::buffer_index</a>, <a class="el" href="gsd_8h_source.html#l00226">gsd_index_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00249">gsd_byte_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00284">gsd_handle::fd</a>, <a class="el" href="gsd_8h_source.html#l00311">gsd_handle::file_size</a>, <a class="el" href="gsd_8h_source.html#l00293">gsd_handle::frame_index</a>, <a class="el" href="gsd_8h_source.html#l00078">GSD_ERROR_INVALID_ARGUMENT</a>, <a class="el" href="gsd_8h_source.html#l00075">GSD_ERROR_IO</a>, <a class="el" href="gsd_8c_source.html#l00744">gsd_index_buffer_add()</a>, <a class="el" href="gsd_8c_source.html#l00148">gsd_io_pwrite_retry()</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, <a class="el" href="gsd_8h_source.html#l00175">gsd_index_entry::location</a>, <a class="el" href="gsd_8h_source.html#l00229">gsd_index_buffer::size</a>, <a class="el" href="gsd_8h_source.html#l00252">gsd_byte_buffer::size</a>, and <a class="el" href="gsd_8h_source.html#l00299">gsd_handle::write_buffer</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l01842">gsd_end_frame()</a>, and <a class="el" href="gsd_8c_source.html#l01916">gsd_write_chunk()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a61daeaa70162e9bac3d241832b460278_cgraph.svg" width="560" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a61daeaa70162e9bac3d241832b460278_icgraph.svg" width="746" height="176"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ab147cf4d77c10fd8085e5023e9afe55f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab147cf4d77c10fd8085e5023e9afe55f">&#9670;&nbsp;</a></span>gsd_flush_name_buffer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int gsd_flush_name_buffer </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *&#160;</td>
          <td class="paramname"><em>handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l01148">1148</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    {</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;    <span class="keywordflow">if</span> (handle == NULL)</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;        {</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;        }</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160; </div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#aee7f806d610d9c4b8e0f045024d4e1f6">n_names</a> == 0)</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;        {</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        <span class="comment">// nothing to do</span></div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        }</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160; </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a3630961b7d45df2885cdd887e4b83b60">size</a> == 0)</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        {</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        <span class="comment">// error: bytes in buffer, but no names for them</span></div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;        }</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160; </div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    <span class="keywordtype">size_t</span> old_reserved = handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a>;</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="keywordtype">size_t</span> old_size = handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a3630961b7d45df2885cdd887e4b83b60">size</a>;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160; </div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;    <span class="comment">// add the new names to the file name list and zero the frame list</span></div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;    <span class="keywordtype">int</span> retval = <a class="code" href="gsd_8c.html#a7a717f9dafe011e68434e181c76253af">gsd_byte_buffer_append</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>,</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                                        handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a>,</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;                                        handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a3630961b7d45df2885cdd887e4b83b60">size</a>);</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;    <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;        {</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;        }</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160; </div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#aee7f806d610d9c4b8e0f045024d4e1f6">n_names</a> += handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#aee7f806d610d9c4b8e0f045024d4e1f6">n_names</a>;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#aee7f806d610d9c4b8e0f045024d4e1f6">n_names</a> = 0;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;    handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a3630961b7d45df2885cdd887e4b83b60">size</a> = 0;</div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;    <a class="code" href="gsd_8c.html#a9b05d58560daee2512f03bedf7b2926d">gsd_util_zero_memory</a>(handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a>, handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a>);</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160; </div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="comment">// reserved space must be a multiple of the GSD name size</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a> % <a class="code" href="gsd_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2dab1e8211d5344adb743238d82d369331d">GSD_NAME_SIZE</a> != 0)</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;        {</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        }</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160; </div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a> &gt; old_reserved)</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        {</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        <span class="comment">// write the new name list to the end of the file</span></div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        uint64_t offset = handle-&gt;<a class="code" href="structgsd__handle.html#ac35aad0eef4a5844ecc4141041fa9243">file_size</a>;</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;        ssize_t bytes_written = <a class="code" href="gsd_8c.html#a3fb7746d93a1c856ca7ef64fa3548cbe">gsd_io_pwrite_retry</a>(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>,</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;                                                    handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a>,</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;                                                    handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a>,</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                                                    offset);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160; </div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;        <span class="keywordflow">if</span> (bytes_written == -1 || bytes_written != handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a>)</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;            {</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;            }</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160; </div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;        <span class="comment">// sync the updated name list</span></div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;        retval = fsync(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>);</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;        <span class="keywordflow">if</span> (retval != 0)</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;            {</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;            }</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160; </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#ac35aad0eef4a5844ecc4141041fa9243">file_size</a> += handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a>;</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a0d69a5886105e2e4cf210406c77f35f0">namelist_location</a> = offset;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#aabd428d9147218283e07bad362c522da">namelist_allocated_entries</a></div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;            = handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a> / <a class="code" href="gsd_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2dab1e8211d5344adb743238d82d369331d">GSD_NAME_SIZE</a>;</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160; </div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        <span class="comment">// write the new header out</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        bytes_written</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;            = <a class="code" href="gsd_8c.html#a3fb7746d93a1c856ca7ef64fa3548cbe">gsd_io_pwrite_retry</a>(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>, &amp;(handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>), <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__header.html">gsd_header</a>), 0);</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;        <span class="keywordflow">if</span> (bytes_written != <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__header.html">gsd_header</a>))</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;            {</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;            }</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        }</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        {</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        <span class="comment">// write the new name list to the old index location</span></div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        uint64_t offset = handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a0d69a5886105e2e4cf210406c77f35f0">namelist_location</a>;</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;        ssize_t bytes_written = <a class="code" href="gsd_8c.html#a3fb7746d93a1c856ca7ef64fa3548cbe">gsd_io_pwrite_retry</a>(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>,</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;                                                    handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a> + old_size,</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                                                    handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a> - old_size,</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                                                    offset + old_size);</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        <span class="keywordflow">if</span> (bytes_written != (handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a> - old_size))</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;            {</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;            }</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        }</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160; </div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;    <span class="comment">// sync the updated name list or header</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    retval = fsync(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    <span class="keywordflow">if</span> (retval != 0)</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        {</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        }</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160; </div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00249">gsd_byte_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00266">gsd_name_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00284">gsd_handle::fd</a>, <a class="el" href="gsd_8h_source.html#l00302">gsd_handle::file_names</a>, <a class="el" href="gsd_8h_source.html#l00311">gsd_handle::file_size</a>, <a class="el" href="gsd_8h_source.html#l00305">gsd_handle::frame_names</a>, <a class="el" href="gsd_8c_source.html#l00491">gsd_byte_buffer_append()</a>, <a class="el" href="gsd_8h_source.html#l00078">GSD_ERROR_INVALID_ARGUMENT</a>, <a class="el" href="gsd_8h_source.html#l00075">GSD_ERROR_IO</a>, <a class="el" href="gsd_8c_source.html#l00148">gsd_io_pwrite_retry()</a>, <a class="el" href="gsd_8h_source.html#l00111">GSD_NAME_SIZE</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, <a class="el" href="gsd_8c_source.html#l00130">gsd_util_zero_memory()</a>, <a class="el" href="gsd_8h_source.html#l00287">gsd_handle::header</a>, <a class="el" href="gsd_8h_source.html#l00269">gsd_name_buffer::n_names</a>, <a class="el" href="gsd_8h_source.html#l00142">gsd_header::namelist_allocated_entries</a>, <a class="el" href="gsd_8h_source.html#l00139">gsd_header::namelist_location</a>, <a class="el" href="gsd_8h_source.html#l00255">gsd_byte_buffer::reserved</a>, and <a class="el" href="gsd_8h_source.html#l00252">gsd_byte_buffer::size</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l01842">gsd_end_frame()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_ab147cf4d77c10fd8085e5023e9afe55f_cgraph.svg" width="579" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_ab147cf4d77c10fd8085e5023e9afe55f_icgraph.svg" width="518" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aa1a0a7dcf4015edcadbb47a6451b4a4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1a0a7dcf4015edcadbb47a6451b4a4b">&#9670;&nbsp;</a></span>gsd_append_name()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int gsd_append_name </td>
          <td>(</td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l01264">1264</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    {</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a37ddf6d53fc8c4f3eff247508fcc814b">open_flags</a> == <a class="code" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a22f5dee98250b8ead7d43cc1a347f205">GSD_OPEN_READONLY</a>)</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;        {</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa5cbc2efac6a7d90f89b616e791eac64">GSD_ERROR_FILE_MUST_BE_WRITABLE</a>;</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;        }</div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160; </div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#aee7f806d610d9c4b8e0f045024d4e1f6">n_names</a> + handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#aee7f806d610d9c4b8e0f045024d4e1f6">n_names</a> == UINT16_MAX)</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;        {</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;        <span class="comment">// no more names may be added</span></div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba4cca403d94a443c160073da8cf26a88b">GSD_ERROR_NAMELIST_FULL</a>;</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;        }</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160; </div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;    <span class="comment">// Provide the ID of the new name</span></div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    *<span class="keywordtype">id</span> = (uint16_t)(handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#aee7f806d610d9c4b8e0f045024d4e1f6">n_names</a> + handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#aee7f806d610d9c4b8e0f045024d4e1f6">n_names</a>);</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160; </div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a5e2e07be01bcfa15c0834d6859878171">gsd_version</a> &lt; <a class="code" href="gsd_8c.html#a493ef951956c9f98adff89a80ddb3fa6">gsd_make_version</a>(2, 0))</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;        {</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        <span class="comment">// v1 files always allocate GSD_NAME_SIZE bytes for each name and put a NULL terminator</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        <span class="comment">// at address 63</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;        <span class="keywordtype">char</span> name_v1[<a class="code" href="gsd_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2dab1e8211d5344adb743238d82d369331d">GSD_NAME_SIZE</a>];</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        strncpy(name_v1, name, <a class="code" href="gsd_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2dab1e8211d5344adb743238d82d369331d">GSD_NAME_SIZE</a> - 1);</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        name_v1[<a class="code" href="gsd_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2dab1e8211d5344adb743238d82d369331d">GSD_NAME_SIZE</a> - 1] = 0;</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;        <a class="code" href="gsd_8c.html#a7a717f9dafe011e68434e181c76253af">gsd_byte_buffer_append</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>, name_v1, <a class="code" href="gsd_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2dab1e8211d5344adb743238d82d369331d">GSD_NAME_SIZE</a>);</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#aee7f806d610d9c4b8e0f045024d4e1f6">n_names</a>++;</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160; </div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        <span class="comment">// update the name/id mapping with the truncated name</span></div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;        <span class="keywordtype">int</span> retval = <a class="code" href="gsd_8c.html#a6c8c2e5a49ac4eb01a95be2e0df06eb9">gsd_name_id_map_insert</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a17f63ed60cc1f9e456bf2d5ce301ecf8">name_map</a>, name_v1, *<span class="keywordtype">id</span>);</div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;            {</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;            }</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;        }</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        {</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        <a class="code" href="gsd_8c.html#a7a717f9dafe011e68434e181c76253af">gsd_byte_buffer_append</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>, name, strlen(name) + 1);</div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#aee7f806d610d9c4b8e0f045024d4e1f6">n_names</a>++;</div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160; </div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        <span class="comment">// update the name/id mapping</span></div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        <span class="keywordtype">int</span> retval = <a class="code" href="gsd_8c.html#a6c8c2e5a49ac4eb01a95be2e0df06eb9">gsd_name_id_map_insert</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a17f63ed60cc1f9e456bf2d5ce301ecf8">name_map</a>, name, *<span class="keywordtype">id</span>);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;            {</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;            }</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;        }</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160; </div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00266">gsd_name_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00302">gsd_handle::file_names</a>, <a class="el" href="gsd_8h_source.html#l00305">gsd_handle::frame_names</a>, <a class="el" href="gsd_8c_source.html#l00491">gsd_byte_buffer_append()</a>, <a class="el" href="gsd_8h_source.html#l00098">GSD_ERROR_FILE_MUST_BE_WRITABLE</a>, <a class="el" href="gsd_8h_source.html#l00093">GSD_ERROR_NAMELIST_FULL</a>, <a class="el" href="gsd_8c_source.html#l01563">gsd_make_version()</a>, <a class="el" href="gsd_8c_source.html#l00318">gsd_name_id_map_insert()</a>, <a class="el" href="gsd_8h_source.html#l00111">GSD_NAME_SIZE</a>, <a class="el" href="gsd_8h_source.html#l00062">GSD_OPEN_READONLY</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, <a class="el" href="gsd_8h_source.html#l00148">gsd_header::gsd_version</a>, <a class="el" href="gsd_8h_source.html#l00287">gsd_handle::header</a>, <a class="el" href="gsd_8h_source.html#l00269">gsd_name_buffer::n_names</a>, <a class="el" href="gsd_8h_source.html#l00317">gsd_handle::name_map</a>, and <a class="el" href="gsd_8h_source.html#l00314">gsd_handle::open_flags</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l01916">gsd_write_chunk()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_aa1a0a7dcf4015edcadbb47a6451b4a4b_cgraph.svg" width="562" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_aa1a0a7dcf4015edcadbb47a6451b4a4b_icgraph.svg" width="724" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="acb769baf09c31a5ad6cba95bd348c194"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb769baf09c31a5ad6cba95bd348c194">&#9670;&nbsp;</a></span>gsd_initialize_file()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int gsd_initialize_file </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>fd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>application</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>schema</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>schema_version</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l01322">1322</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    {</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="comment">// check if the file was created</span></div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keywordflow">if</span> (fd == -1)</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        {</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;        }</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160; </div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <span class="keywordtype">int</span> retval = ftruncate(fd, 0);</div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <span class="keywordflow">if</span> (retval != 0)</div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        {</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        }</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160; </div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;    <span class="comment">// populate header fields</span></div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    <span class="keyword">struct </span><a class="code" href="structgsd__header.html">gsd_header</a> header;</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;    <a class="code" href="gsd_8c.html#a9b05d58560daee2512f03bedf7b2926d">gsd_util_zero_memory</a>(&amp;header, <span class="keyword">sizeof</span>(header));</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160; </div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    header.magic = <a class="code" href="gsd_8c.html#acf7c38e3e5534e06ba18607f11c1e00e">GSD_MAGIC_ID</a>;</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    header.gsd_version = <a class="code" href="gsd_8c.html#a493ef951956c9f98adff89a80ddb3fa6">gsd_make_version</a>(<a class="code" href="gsd_8c.html#a726ca809ffd3d67ab4b8476646f26635a9e41ab940950d400d353438f87a6f559">GSD_CURRENT_FILE_VERSION</a>, 0);</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    strncpy(header.application, <a class="code" href="structgsd__header.html#ad23681ad38d32167197a22e75a2605b1">application</a>, <span class="keyword">sizeof</span>(header.application) - 1);</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;    header.application[<span class="keyword">sizeof</span>(header.application) - 1] = 0;</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    strncpy(header.schema, <a class="code" href="structgsd__header.html#a31b0992efad0ec0288ce7064f773dbda">schema</a>, <span class="keyword">sizeof</span>(header.schema) - 1);</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    header.schema[<span class="keyword">sizeof</span>(header.schema) - 1] = 0;</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    header.schema_version = <a class="code" href="structgsd__header.html#a1740d644c468c25cbade9ee0ee1c1a63">schema_version</a>;</div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    header.index_location = <span class="keyword">sizeof</span>(header);</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;    header.index_allocated_entries = <a class="code" href="gsd_8c.html#a06fc87d81c62e9abb8790b6e5713c55bab2d4762a429d1bedec72663852e3c4ba">GSD_INITIAL_INDEX_SIZE</a>;</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    header.namelist_location</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        = header.index_location + <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structgsd__index__entry.html">gsd_index_entry</a>) * header.index_allocated_entries;</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;    header.namelist_allocated_entries = <a class="code" href="gsd_8c.html#adf764cbdea00d65edcd07bb9953ad2b7af18592611faceacda42f0c336394bae2">GSD_INITIAL_NAME_BUFFER_SIZE</a> / <a class="code" href="gsd_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2dab1e8211d5344adb743238d82d369331d">GSD_NAME_SIZE</a>;</div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;    <a class="code" href="gsd_8c.html#a9b05d58560daee2512f03bedf7b2926d">gsd_util_zero_memory</a>(header.reserved, <span class="keyword">sizeof</span>(header.reserved));</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160; </div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <span class="comment">// write the header out</span></div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    ssize_t bytes_written = <a class="code" href="gsd_8c.html#a3fb7746d93a1c856ca7ef64fa3548cbe">gsd_io_pwrite_retry</a>(fd, &amp;header, <span class="keyword">sizeof</span>(header), 0);</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;    <span class="keywordflow">if</span> (bytes_written != <span class="keyword">sizeof</span>(header))</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;        {</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;        }</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160; </div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    <span class="comment">// allocate and zero default index memory</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <span class="keyword">struct </span><a class="code" href="structgsd__index__entry.html">gsd_index_entry</a> index[<a class="code" href="gsd_8c.html#a06fc87d81c62e9abb8790b6e5713c55bab2d4762a429d1bedec72663852e3c4ba">GSD_INITIAL_INDEX_SIZE</a>];</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <a class="code" href="gsd_8c.html#a9b05d58560daee2512f03bedf7b2926d">gsd_util_zero_memory</a>(index, <span class="keyword">sizeof</span>(index));</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160; </div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="comment">// write the empty index out</span></div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;    bytes_written = <a class="code" href="gsd_8c.html#a3fb7746d93a1c856ca7ef64fa3548cbe">gsd_io_pwrite_retry</a>(fd, index, <span class="keyword">sizeof</span>(index), <span class="keyword">sizeof</span>(header));</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;    <span class="keywordflow">if</span> (bytes_written != <span class="keyword">sizeof</span>(index))</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;        {</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        }</div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160; </div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <span class="comment">// allocate and zero the namelist memory</span></div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    <span class="keywordtype">char</span> names[<a class="code" href="gsd_8c.html#adf764cbdea00d65edcd07bb9953ad2b7af18592611faceacda42f0c336394bae2">GSD_INITIAL_NAME_BUFFER_SIZE</a>];</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <a class="code" href="gsd_8c.html#a9b05d58560daee2512f03bedf7b2926d">gsd_util_zero_memory</a>(names, <span class="keyword">sizeof</span>(<span class="keywordtype">char</span>) * <a class="code" href="gsd_8c.html#adf764cbdea00d65edcd07bb9953ad2b7af18592611faceacda42f0c336394bae2">GSD_INITIAL_NAME_BUFFER_SIZE</a>);</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160; </div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    <span class="comment">// write the namelist out</span></div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;    bytes_written = <a class="code" href="gsd_8c.html#a3fb7746d93a1c856ca7ef64fa3548cbe">gsd_io_pwrite_retry</a>(fd, names, <span class="keyword">sizeof</span>(names), <span class="keyword">sizeof</span>(header) + <span class="keyword">sizeof</span>(index));</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <span class="keywordflow">if</span> (bytes_written != <span class="keyword">sizeof</span>(names))</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;        {</div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;        }</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160; </div>
<div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;    <span class="comment">// sync file</span></div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;    retval = fsync(fd);</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="keywordflow">if</span> (retval != 0)</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;        {</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;        }</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160; </div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00151">gsd_header::application</a>, <a class="el" href="gsd_8c_source.html#l00081">GSD_CURRENT_FILE_VERSION</a>, <a class="el" href="gsd_8h_source.html#l00075">GSD_ERROR_IO</a>, <a class="el" href="gsd_8c_source.html#l00045">GSD_INITIAL_INDEX_SIZE</a>, <a class="el" href="gsd_8c_source.html#l00051">GSD_INITIAL_NAME_BUFFER_SIZE</a>, <a class="el" href="gsd_8c_source.html#l00148">gsd_io_pwrite_retry()</a>, <a class="el" href="gsd_8c_source.html#l00040">GSD_MAGIC_ID</a>, <a class="el" href="gsd_8c_source.html#l01563">gsd_make_version()</a>, <a class="el" href="gsd_8h_source.html#l00111">GSD_NAME_SIZE</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, <a class="el" href="gsd_8c_source.html#l00130">gsd_util_zero_memory()</a>, <a class="el" href="gsd_8h_source.html#l00148">gsd_header::gsd_version</a>, <a class="el" href="gsd_8h_source.html#l00136">gsd_header::index_allocated_entries</a>, <a class="el" href="gsd_8h_source.html#l00133">gsd_header::index_location</a>, <a class="el" href="gsd_8h_source.html#l00130">gsd_header::magic</a>, <a class="el" href="gsd_8h_source.html#l00142">gsd_header::namelist_allocated_entries</a>, <a class="el" href="gsd_8h_source.html#l00139">gsd_header::namelist_location</a>, <a class="el" href="gsd_8h_source.html#l00157">gsd_header::reserved</a>, <a class="el" href="gsd_8h_source.html#l00154">gsd_header::schema</a>, and <a class="el" href="gsd_8h_source.html#l00145">gsd_header::schema_version</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l01568">gsd_create()</a>, <a class="el" href="gsd_8c_source.html#l01587">gsd_create_and_open()</a>, and <a class="el" href="gsd_8c_source.html#l01677">gsd_truncate()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_acb769baf09c31a5ad6cba95bd348c194_cgraph.svg" width="334" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_acb769baf09c31a5ad6cba95bd348c194_icgraph.svg" width="532" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ac159dfbfd790607f85073ad2d8464a8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac159dfbfd790607f85073ad2d8464a8b">&#9670;&nbsp;</a></span>gsd_initialize_handle()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static int gsd_initialize_handle </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *&#160;</td>
          <td class="paramname"><em>handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l01401">1401</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    {</div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="comment">// check if the file was created</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a> == -1)</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;        {</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;        }</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160; </div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <span class="comment">// read the header</span></div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    ssize_t bytes_read</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;        = <a class="code" href="gsd_8c.html#ac1f41abbefbfe35337e7053d766c089b">gsd_io_pread_retry</a>(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>, &amp;handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__header.html">gsd_header</a>), 0);</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    <span class="keywordflow">if</span> (bytes_read == -1)</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;        {</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;        }</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    <span class="keywordflow">if</span> (bytes_read != <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__header.html">gsd_header</a>))</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;        {</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba84a9d0b912c0f9dd4ef7eda53560253b">GSD_ERROR_NOT_A_GSD_FILE</a>;</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;        }</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160; </div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <span class="comment">// validate the header</span></div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a62903e5e531a982796c3a5133ff18b85">magic</a> != <a class="code" href="gsd_8c.html#acf7c38e3e5534e06ba18607f11c1e00e">GSD_MAGIC_ID</a>)</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;        {</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba84a9d0b912c0f9dd4ef7eda53560253b">GSD_ERROR_NOT_A_GSD_FILE</a>;</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;        }</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160; </div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a5e2e07be01bcfa15c0834d6859878171">gsd_version</a> &lt; <a class="code" href="gsd_8c.html#a493ef951956c9f98adff89a80ddb3fa6">gsd_make_version</a>(1, 0)</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        &amp;&amp; handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a5e2e07be01bcfa15c0834d6859878171">gsd_version</a> != <a class="code" href="gsd_8c.html#a493ef951956c9f98adff89a80ddb3fa6">gsd_make_version</a>(0, 3))</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;        {</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba72c4d63d4cbec5412ab1ab57716afe80">GSD_ERROR_INVALID_GSD_FILE_VERSION</a>;</div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        }</div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160; </div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a5e2e07be01bcfa15c0834d6859878171">gsd_version</a> &gt;= <a class="code" href="gsd_8c.html#a493ef951956c9f98adff89a80ddb3fa6">gsd_make_version</a>(3, 0))</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        {</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba72c4d63d4cbec5412ab1ab57716afe80">GSD_ERROR_INVALID_GSD_FILE_VERSION</a>;</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        }</div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160; </div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="comment">// determine the file size</span></div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;    handle-&gt;<a class="code" href="structgsd__handle.html#ac35aad0eef4a5844ecc4141041fa9243">file_size</a> = lseek(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>, 0, SEEK_END);</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160; </div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;    <span class="comment">// validate that the namelist block exists inside the file</span></div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a0d69a5886105e2e4cf210406c77f35f0">namelist_location</a></div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;            + (<a class="code" href="gsd_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2dab1e8211d5344adb743238d82d369331d">GSD_NAME_SIZE</a> * handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#aabd428d9147218283e07bad362c522da">namelist_allocated_entries</a>)</div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        &gt; (uint64_t)handle-&gt;<a class="code" href="structgsd__handle.html#ac35aad0eef4a5844ecc4141041fa9243">file_size</a>)</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;        {</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba4236f6900d8a81a3a4ccafa2170ad27c">GSD_ERROR_FILE_CORRUPT</a>;</div>
<div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;        }</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160; </div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;    <span class="comment">// allocate the hash map</span></div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;    <span class="keywordtype">int</span> retval = <a class="code" href="gsd_8c.html#aebfeb70fcbc089409a7179af7d814554">gsd_name_id_map_allocate</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a17f63ed60cc1f9e456bf2d5ce301ecf8">name_map</a>, <a class="code" href="gsd_8c.html#a61dadd085c1777f559549e05962b2c9ea09f6f8b0215767f2ed4321a8e26cc287">GSD_NAME_MAP_SIZE</a>);</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;    <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160;        {</div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;        <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;        }</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160; </div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <span class="comment">// read the namelist block</span></div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;    <span class="keywordtype">size_t</span> namelist_n_bytes = <a class="code" href="gsd_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2dab1e8211d5344adb743238d82d369331d">GSD_NAME_SIZE</a> * handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#aabd428d9147218283e07bad362c522da">namelist_allocated_entries</a>;</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    retval = <a class="code" href="gsd_8c.html#aeaf487909ab334303fa478cf4a126d6f">gsd_byte_buffer_allocate</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>, namelist_n_bytes);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;        {</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;        <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;        }</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;    bytes_read = <a class="code" href="gsd_8c.html#ac1f41abbefbfe35337e7053d766c089b">gsd_io_pread_retry</a>(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>,</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;                                    handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a>,</div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;                                    namelist_n_bytes,</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;                                    handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a0d69a5886105e2e4cf210406c77f35f0">namelist_location</a>);</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160; </div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;    <span class="keywordflow">if</span> (bytes_read == -1 || bytes_read != namelist_n_bytes)</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;        {</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;        }</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160; </div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    <span class="comment">// The name buffer must end in a NULL terminator or else the file is corrupt</span></div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a>[handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a> - 1] != 0)</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;        {</div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba4236f6900d8a81a3a4ccafa2170ad27c">GSD_ERROR_FILE_CORRUPT</a>;</div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;        }</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160; </div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    <span class="comment">// Add the names to the hash map. Also determine the number of used bytes in the namelist.</span></div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <span class="keywordtype">size_t</span> name_start = 0;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#aee7f806d610d9c4b8e0f045024d4e1f6">n_names</a> = 0;</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    <span class="keywordflow">while</span> (name_start &lt; handle-&gt;file_names.data.reserved)</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;        {</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;        <span class="keywordtype">char</span>* name = handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a> + name_start;</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160; </div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;        <span class="comment">// an empty name notes the end of the list</span></div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;        <span class="keywordflow">if</span> (name[0] == 0)</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;            {</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;            }</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160; </div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;        retval</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;            = <a class="code" href="gsd_8c.html#a6c8c2e5a49ac4eb01a95be2e0df06eb9">gsd_name_id_map_insert</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a17f63ed60cc1f9e456bf2d5ce301ecf8">name_map</a>, name, (uint16_t)handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#aee7f806d610d9c4b8e0f045024d4e1f6">n_names</a>);</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;        <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;            {</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;            }</div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#aee7f806d610d9c4b8e0f045024d4e1f6">n_names</a>++;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160; </div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;        <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a5e2e07be01bcfa15c0834d6859878171">gsd_version</a> &lt; <a class="code" href="gsd_8c.html#a493ef951956c9f98adff89a80ddb3fa6">gsd_make_version</a>(2, 0))</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;            {</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;            <span class="comment">// gsd v1 stores names in fixed 64 byte segments</span></div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;            name_start += <a class="code" href="gsd_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2dab1e8211d5344adb743238d82d369331d">GSD_NAME_SIZE</a>;</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;            }</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;            {</div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;            <span class="keywordtype">size_t</span> len = strnlen(name, handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a> - name_start);</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;            name_start += len + 1;</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;            }</div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;        }</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160; </div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a3630961b7d45df2885cdd887e4b83b60">size</a> = name_start;</div>
<div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160; </div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    <span class="comment">// read in the file index</span></div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    retval = <a class="code" href="gsd_8c.html#a6fe75caf6c4df550af2455a0c40bfbdf">gsd_index_buffer_map</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>, handle);</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;        {</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;        <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;        }</div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160; </div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <span class="comment">// determine the current frame counter</span></div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> == 0)</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;        {</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#a144dc0976a1fe2f895423495689daea5">cur_frame</a> = 0;</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;        }</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;        {</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#a144dc0976a1fe2f895423495689daea5">cur_frame</a> = handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>[handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> - 1].<a class="code" href="structgsd__index__entry.html#a1b6c67d9197aa4588964052c2919092e">frame</a> + 1;</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;        }</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160; </div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    <span class="comment">// if this is a write mode, allocate the initial frame index and the name buffer</span></div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a37ddf6d53fc8c4f3eff247508fcc814b">open_flags</a> != <a class="code" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a22f5dee98250b8ead7d43cc1a347f205">GSD_OPEN_READONLY</a>)</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;        {</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;        retval = <a class="code" href="gsd_8c.html#ae1948c93f77d642c4e3797fe7e5f2095">gsd_index_buffer_allocate</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a9086141add0c7be99bcfed3bfd6dadac">frame_index</a>, <a class="code" href="gsd_8c.html#a99fb83031ce9923c84392b4e92f956b5abe3e9ee339884a28a33d20ea27d0c8a7">GSD_INITIAL_FRAME_INDEX_SIZE</a>);</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;        <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;            {</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;            }</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160; </div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;        retval = <a class="code" href="gsd_8c.html#ae1948c93f77d642c4e3797fe7e5f2095">gsd_index_buffer_allocate</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a501968a30f0b06f4b7cb69c115648627">buffer_index</a>, <a class="code" href="gsd_8c.html#a99fb83031ce9923c84392b4e92f956b5abe3e9ee339884a28a33d20ea27d0c8a7">GSD_INITIAL_FRAME_INDEX_SIZE</a>);</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;        <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;            {</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;            }</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160; </div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;        retval = <a class="code" href="gsd_8c.html#aeaf487909ab334303fa478cf4a126d6f">gsd_byte_buffer_allocate</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a7ae49d668bbd61ce9d022acf5e5a9e76">write_buffer</a>, <a class="code" href="gsd_8c.html#abc6126af1d45847bc59afa0aa3216b04add62126eb596d9d505d4f4c33062528e">GSD_WRITE_BUFFER_SIZE</a>);</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;        <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;            {</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;            }</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160; </div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#aee7f806d610d9c4b8e0f045024d4e1f6">n_names</a> = 0;</div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;        retval = <a class="code" href="gsd_8c.html#aeaf487909ab334303fa478cf4a126d6f">gsd_byte_buffer_allocate</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>, <a class="code" href="gsd_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2dab1e8211d5344adb743238d82d369331d">GSD_NAME_SIZE</a>);</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;        <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;            {</div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;            }</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;        }</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160; </div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00296">gsd_handle::buffer_index</a>, <a class="el" href="gsd_8h_source.html#l00308">gsd_handle::cur_frame</a>, <a class="el" href="gsd_8h_source.html#l00226">gsd_index_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00249">gsd_byte_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00266">gsd_name_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00284">gsd_handle::fd</a>, <a class="el" href="gsd_8h_source.html#l00290">gsd_handle::file_index</a>, <a class="el" href="gsd_8h_source.html#l00302">gsd_handle::file_names</a>, <a class="el" href="gsd_8h_source.html#l00311">gsd_handle::file_size</a>, <a class="el" href="gsd_8h_source.html#l00169">gsd_index_entry::frame</a>, <a class="el" href="gsd_8h_source.html#l00293">gsd_handle::frame_index</a>, <a class="el" href="gsd_8h_source.html#l00305">gsd_handle::frame_names</a>, <a class="el" href="gsd_8c_source.html#l00463">gsd_byte_buffer_allocate()</a>, <a class="el" href="gsd_8h_source.html#l00087">GSD_ERROR_FILE_CORRUPT</a>, <a class="el" href="gsd_8h_source.html#l00084">GSD_ERROR_INVALID_GSD_FILE_VERSION</a>, <a class="el" href="gsd_8h_source.html#l00075">GSD_ERROR_IO</a>, <a class="el" href="gsd_8h_source.html#l00081">GSD_ERROR_NOT_A_GSD_FILE</a>, <a class="el" href="gsd_8c_source.html#l00558">gsd_index_buffer_allocate()</a>, <a class="el" href="gsd_8c_source.html#l00593">gsd_index_buffer_map()</a>, <a class="el" href="gsd_8c_source.html#l00057">GSD_INITIAL_FRAME_INDEX_SIZE</a>, <a class="el" href="gsd_8c_source.html#l00190">gsd_io_pread_retry()</a>, <a class="el" href="gsd_8c_source.html#l00040">GSD_MAGIC_ID</a>, <a class="el" href="gsd_8c_source.html#l01563">gsd_make_version()</a>, <a class="el" href="gsd_8c_source.html#l00232">gsd_name_id_map_allocate()</a>, <a class="el" href="gsd_8c_source.html#l00318">gsd_name_id_map_insert()</a>, <a class="el" href="gsd_8c_source.html#l00075">GSD_NAME_MAP_SIZE</a>, <a class="el" href="gsd_8h_source.html#l00111">GSD_NAME_SIZE</a>, <a class="el" href="gsd_8h_source.html#l00062">GSD_OPEN_READONLY</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, <a class="el" href="gsd_8h_source.html#l00148">gsd_header::gsd_version</a>, <a class="el" href="gsd_8c_source.html#l00063">GSD_WRITE_BUFFER_SIZE</a>, <a class="el" href="gsd_8h_source.html#l00287">gsd_handle::header</a>, <a class="el" href="gsd_8h_source.html#l00130">gsd_header::magic</a>, <a class="el" href="gsd_8h_source.html#l00269">gsd_name_buffer::n_names</a>, <a class="el" href="gsd_8h_source.html#l00317">gsd_handle::name_map</a>, <a class="el" href="gsd_8h_source.html#l00142">gsd_header::namelist_allocated_entries</a>, <a class="el" href="gsd_8h_source.html#l00139">gsd_header::namelist_location</a>, <a class="el" href="gsd_8h_source.html#l00314">gsd_handle::open_flags</a>, <a class="el" href="gsd_8h_source.html#l00255">gsd_byte_buffer::reserved</a>, <a class="el" href="gsd_8h_source.html#l00229">gsd_index_buffer::size</a>, <a class="el" href="gsd_8h_source.html#l00252">gsd_byte_buffer::size</a>, and <a class="el" href="gsd_8h_source.html#l00299">gsd_handle::write_buffer</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l01587">gsd_create_and_open()</a>, <a class="el" href="gsd_8c_source.html#l01642">gsd_open()</a>, and <a class="el" href="gsd_8c_source.html#l01677">gsd_truncate()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_ac159dfbfd790607f85073ad2d8464a8b_cgraph.svg" width="770" height="342"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_ac159dfbfd790607f85073ad2d8464a8b_icgraph.svg" width="554" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a493ef951956c9f98adff89a80ddb3fa6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a493ef951956c9f98adff89a80ddb3fa6">&#9670;&nbsp;</a></span>gsd_make_version()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t gsd_make_version </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>major</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>minor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Specify a version</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">major</td><td>major version </td></tr>
    <tr><td class="paramname">minor</td><td>minor version</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>a packed version number aaaa.bbbb suitable for storing in a gsd file version entry. </dd></dl>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l01563">1563</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    {</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="keywordflow">return</span> major &lt;&lt; (<span class="keyword">sizeof</span>(uint32_t) * 4) | minor;</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l01264">gsd_append_name()</a>, <a class="el" href="gsd_8c_source.html#l02039">gsd_find_chunk()</a>, <a class="el" href="gsd_8c_source.html#l02228">gsd_find_matching_chunk_name()</a>, <a class="el" href="gsd_8c_source.html#l01322">gsd_initialize_file()</a>, <a class="el" href="gsd_8c_source.html#l01401">gsd_initialize_handle()</a>, and <a class="el" href="gsd_8c_source.html#l02300">gsd_upgrade()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a493ef951956c9f98adff89a80ddb3fa6_icgraph.svg" width="1042" height="595"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a58654880dd98b2bc32e429810b7d2623"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58654880dd98b2bc32e429810b7d2623">&#9670;&nbsp;</a></span>gsd_create()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gsd_create </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>application</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>schema</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>schema_version</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create a GSD file</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fname</td><td>File name. </td></tr>
    <tr><td class="paramname">application</td><td>Generating application name (truncated to 63 chars). </td></tr>
    <tr><td class="paramname">schema</td><td>Schema name for data to be written in this GSD file (truncated to 63 chars). </td></tr>
    <tr><td class="paramname">schema_version</td><td>Version of the scheme data to be written (make with <a class="el" href="gsd_8h.html#a493ef951956c9f98adff89a80ddb3fa6">gsd_make_version()</a>).</td></tr>
  </table>
  </dd>
</dl>
<dl class="section post"><dt>Postcondition</dt><dd>Create an empty gsd file in a file of the given name. Overwrite any existing file at that location.</dd></dl>
<p>The generated gsd file is not opened. Call <a class="el" href="gsd_8h.html#ae0add799755285c1108a7b97b2ed7e00">gsd_open()</a> to open it for writing.</p>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>GSD_SUCCESS (0) on success. Negative value on failure:</li>
<li>GSD_ERROR_IO: IO error (check errno). </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l01568">1568</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;    {</div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;    <span class="keywordtype">int</span> extra_flags = 0;</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    extra_flags = _O_BINARY;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160; </div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    <span class="comment">// create the file</span></div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;    <span class="keywordtype">int</span> fd = open(fname,</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;                  O_RDWR | O_CREAT | O_TRUNC | extra_flags,</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;                  S_IRUSR | S_IWUSR | S_IRGRP | S_IWGRP);</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <span class="keywordtype">int</span> retval = <a class="code" href="gsd_8c.html#acb769baf09c31a5ad6cba95bd348c194">gsd_initialize_file</a>(fd, application, schema, schema_version);</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    close(fd);</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8c_source.html#l01322">gsd_initialize_file()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a58654880dd98b2bc32e429810b7d2623_cgraph.svg" width="468" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aa0b0b7fb6b385707ffc83989d54bc81b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0b0b7fb6b385707ffc83989d54bc81b">&#9670;&nbsp;</a></span>gsd_create_and_open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gsd_create_and_open </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>application</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>schema</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>schema_version</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98">gsd_open_flag</a>&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>exclusive_create</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Create and open a GSD file</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>Handle to open. </td></tr>
    <tr><td class="paramname">fname</td><td>File name. </td></tr>
    <tr><td class="paramname">application</td><td>Generating application name (truncated to 63 chars). </td></tr>
    <tr><td class="paramname">schema</td><td>Schema name for data to be written in this GSD file (truncated to 63 chars). </td></tr>
    <tr><td class="paramname">schema_version</td><td>Version of the scheme data to be written (make with <a class="el" href="gsd_8h.html#a493ef951956c9f98adff89a80ddb3fa6">gsd_make_version()</a>). </td></tr>
    <tr><td class="paramname">flags</td><td>Either GSD_OPEN_READWRITE, or GSD_OPEN_APPEND. </td></tr>
    <tr><td class="paramname">exclusive_create</td><td>Set to non-zero to force exclusive creation of the file.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section post"><dt>Postcondition</dt><dd>Create an empty gsd file with the given name. Overwrite any existing file at that location.</dd></dl>
<p>Open the generated gsd file in <em>handle</em>.</p>
<p>The file descriptor is closed if there when an error opening the file.</p>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>GSD_SUCCESS (0) on success. Negative value on failure:</li>
<li>GSD_ERROR_IO: IO error (check errno).</li>
<li>GSD_ERROR_NOT_A_GSD_FILE: Not a GSD file.</li>
<li>GSD_ERROR_INVALID_GSD_FILE_VERSION: Invalid GSD file version.</li>
<li>GSD_ERROR_FILE_CORRUPT: Corrupt file.</li>
<li>GSD_ERROR_MEMORY_ALLOCATION_FAILED: Unable to allocate memory. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l01587">1587</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    {</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    <span class="comment">// zero the handle</span></div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;    <a class="code" href="gsd_8c.html#a9b05d58560daee2512f03bedf7b2926d">gsd_util_zero_memory</a>(handle, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__handle.html">gsd_handle</a>));</div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160; </div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <span class="keywordtype">int</span> extra_flags = 0;</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    extra_flags = _O_BINARY;</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160; </div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    <span class="comment">// set the open flags in the handle</span></div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structgsd__index__entry.html#a0fd668ac1b940ccb0b22793709145091">flags</a> == <a class="code" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a0f98b5182423243f10f362ddfb6d7d61">GSD_OPEN_READWRITE</a>)</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;        {</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#a37ddf6d53fc8c4f3eff247508fcc814b">open_flags</a> = <a class="code" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a0f98b5182423243f10f362ddfb6d7d61">GSD_OPEN_READWRITE</a>;</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;        }</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structgsd__index__entry.html#a0fd668ac1b940ccb0b22793709145091">flags</a> == <a class="code" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a22f5dee98250b8ead7d43cc1a347f205">GSD_OPEN_READONLY</a>)</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;        {</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa5cbc2efac6a7d90f89b616e791eac64">GSD_ERROR_FILE_MUST_BE_WRITABLE</a>;</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;        }</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structgsd__index__entry.html#a0fd668ac1b940ccb0b22793709145091">flags</a> == <a class="code" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a987636cdb7cdac06ae7173d291abec40">GSD_OPEN_APPEND</a>)</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;        {</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#a37ddf6d53fc8c4f3eff247508fcc814b">open_flags</a> = <a class="code" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a987636cdb7cdac06ae7173d291abec40">GSD_OPEN_APPEND</a>;</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;        }</div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160; </div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    <span class="comment">// set the exclusive create bit</span></div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <span class="keywordflow">if</span> (exclusive_create)</div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;        {</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;        extra_flags |= O_EXCL;</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;        }</div>
<div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160; </div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <span class="comment">// create the file</span></div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a> = open(fname,</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;                      O_RDWR | O_CREAT | O_TRUNC | extra_flags,</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;                      S_IRUSR | S_IWUSR | S_IRGRP | S_IWGRP);</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;    <span class="keywordtype">int</span> retval = <a class="code" href="gsd_8c.html#acb769baf09c31a5ad6cba95bd348c194">gsd_initialize_file</a>(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>, application, schema, schema_version);</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    <span class="keywordflow">if</span> (retval != 0)</div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;        {</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;        close(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>);</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;        <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;        }</div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160; </div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    retval = <a class="code" href="gsd_8c.html#ac159dfbfd790607f85073ad2d8464a8b">gsd_initialize_handle</a>(handle);</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <span class="keywordflow">if</span> (retval != 0)</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        {</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;        close(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>);</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        }</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00284">gsd_handle::fd</a>, <a class="el" href="gsd_8h_source.html#l00187">gsd_index_entry::flags</a>, <a class="el" href="gsd_8h_source.html#l00098">GSD_ERROR_FILE_MUST_BE_WRITABLE</a>, <a class="el" href="gsd_8c_source.html#l01322">gsd_initialize_file()</a>, <a class="el" href="gsd_8c_source.html#l01401">gsd_initialize_handle()</a>, <a class="el" href="gsd_8h_source.html#l00065">GSD_OPEN_APPEND</a>, <a class="el" href="gsd_8h_source.html#l00062">GSD_OPEN_READONLY</a>, <a class="el" href="gsd_8h_source.html#l00059">GSD_OPEN_READWRITE</a>, <a class="el" href="gsd_8c_source.html#l00130">gsd_util_zero_memory()</a>, and <a class="el" href="gsd_8h_source.html#l00314">gsd_handle::open_flags</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_aa0b0b7fb6b385707ffc83989d54bc81b_cgraph.svg" width="967" height="443"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ad8933dcce55fd8101b5688f382c10a8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8933dcce55fd8101b5688f382c10a8e">&#9670;&nbsp;</a></span>gsd_open()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gsd_open </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98">gsd_open_flag</a>&#160;</td>
          <td class="paramname"><em>flags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Open a GSD file</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>Handle to open. </td></tr>
    <tr><td class="paramname">fname</td><td>File name to open. </td></tr>
    <tr><td class="paramname">flags</td><td>Either GSD_OPEN_READWRITE, GSD_OPEN_READONLY, or GSD_OPEN_APPEND.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd>The file name <em>fname</em> is a GSD file.</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>Open a GSD file and populates the handle for use by API calls.</dd></dl>
<p>The file descriptor is closed if there is an error opening the file.</p>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>GSD_SUCCESS (0) on success. Negative value on failure:</li>
<li>GSD_ERROR_IO: IO error (check errno).</li>
<li>GSD_ERROR_NOT_A_GSD_FILE: Not a GSD file.</li>
<li>GSD_ERROR_INVALID_GSD_FILE_VERSION: Invalid GSD file version.</li>
<li>GSD_ERROR_FILE_CORRUPT: Corrupt file.</li>
<li>GSD_ERROR_MEMORY_ALLOCATION_FAILED: Unable to allocate memory. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l01642">1642</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    {</div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="comment">// zero the handle</span></div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    <a class="code" href="gsd_8c.html#a9b05d58560daee2512f03bedf7b2926d">gsd_util_zero_memory</a>(handle, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__handle.html">gsd_handle</a>));</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160; </div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    <span class="keywordtype">int</span> extra_flags = 0;</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;<span class="preprocessor">#ifdef _WIN32</span></div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    extra_flags = _O_BINARY;</div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160; </div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <span class="comment">// open the file</span></div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structgsd__index__entry.html#a0fd668ac1b940ccb0b22793709145091">flags</a> == <a class="code" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a0f98b5182423243f10f362ddfb6d7d61">GSD_OPEN_READWRITE</a>)</div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;        {</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a> = open(fname, O_RDWR | extra_flags);</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#a37ddf6d53fc8c4f3eff247508fcc814b">open_flags</a> = <a class="code" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a0f98b5182423243f10f362ddfb6d7d61">GSD_OPEN_READWRITE</a>;</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;        }</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structgsd__index__entry.html#a0fd668ac1b940ccb0b22793709145091">flags</a> == <a class="code" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a22f5dee98250b8ead7d43cc1a347f205">GSD_OPEN_READONLY</a>)</div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;        {</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a> = open(fname, O_RDONLY | extra_flags);</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#a37ddf6d53fc8c4f3eff247508fcc814b">open_flags</a> = <a class="code" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a22f5dee98250b8ead7d43cc1a347f205">GSD_OPEN_READONLY</a>;</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        }</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structgsd__index__entry.html#a0fd668ac1b940ccb0b22793709145091">flags</a> == <a class="code" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a987636cdb7cdac06ae7173d291abec40">GSD_OPEN_APPEND</a>)</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;        {</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a> = open(fname, O_RDWR | extra_flags);</div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#a37ddf6d53fc8c4f3eff247508fcc814b">open_flags</a> = <a class="code" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a987636cdb7cdac06ae7173d291abec40">GSD_OPEN_APPEND</a>;</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;        }</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160; </div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    <span class="keywordtype">int</span> retval = <a class="code" href="gsd_8c.html#ac159dfbfd790607f85073ad2d8464a8b">gsd_initialize_handle</a>(handle);</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <span class="keywordflow">if</span> (retval != 0)</div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;        {</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;        close(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>);</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;        }</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00284">gsd_handle::fd</a>, <a class="el" href="gsd_8h_source.html#l00187">gsd_index_entry::flags</a>, <a class="el" href="gsd_8c_source.html#l01401">gsd_initialize_handle()</a>, <a class="el" href="gsd_8h_source.html#l00065">GSD_OPEN_APPEND</a>, <a class="el" href="gsd_8h_source.html#l00062">GSD_OPEN_READONLY</a>, <a class="el" href="gsd_8h_source.html#l00059">GSD_OPEN_READWRITE</a>, <a class="el" href="gsd_8c_source.html#l00130">gsd_util_zero_memory()</a>, and <a class="el" href="gsd_8h_source.html#l00314">gsd_handle::open_flags</a>.</p>

<p class="reference">Referenced by <a class="el" href="GSDUtil_8cpp_source.html#l00008">GSDUtil::GSDUtil()</a>, and <a class="el" href="testsSimulationBuild_8cpp_source.html#l00018">TEST_CASE()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_ad8933dcce55fd8101b5688f382c10a8e_cgraph.svg" width="907" height="342"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_ad8933dcce55fd8101b5688f382c10a8e_icgraph.svg" width="266" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a02ac7984034069d508b1c7ccbe702bac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a02ac7984034069d508b1c7ccbe702bac">&#9670;&nbsp;</a></span>gsd_truncate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gsd_truncate </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *&#160;</td>
          <td class="paramname"><em>handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Truncate a GSD file</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>Open GSD file to truncate.</td></tr>
  </table>
  </dd>
</dl>
<p>After truncating, a file will have no frames and no data chunks. The file size will be that of a newly created gsd file. The application, schema, and schema version metadata will be kept. Truncate does not close and reopen the file, so it is suitable for writing restart files on Lustre file systems without any metadata access.</p>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>GSD_SUCCESS (0) on success. Negative value on failure:</li>
<li>GSD_ERROR_IO: IO error (check errno).</li>
<li>GSD_ERROR_NOT_A_GSD_FILE: Not a GSD file.</li>
<li>GSD_ERROR_INVALID_GSD_FILE_VERSION: Invalid GSD file version.</li>
<li>GSD_ERROR_FILE_CORRUPT: Corrupt file.</li>
<li>GSD_ERROR_MEMORY_ALLOCATION_FAILED: Unable to allocate memory. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l01677">1677</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    {</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    <span class="keywordflow">if</span> (handle == NULL)</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;        {</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;        }</div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a37ddf6d53fc8c4f3eff247508fcc814b">open_flags</a> == <a class="code" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a22f5dee98250b8ead7d43cc1a347f205">GSD_OPEN_READONLY</a>)</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;        {</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa5cbc2efac6a7d90f89b616e791eac64">GSD_ERROR_FILE_MUST_BE_WRITABLE</a>;</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;        }</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160; </div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    <span class="keywordtype">int</span> retval = 0;</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160; </div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    <span class="comment">// deallocate indices</span></div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a> &gt; 0)</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        {</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        retval = <a class="code" href="gsd_8c.html#ae50726c30c5bf629b6af1ef88020302f">gsd_byte_buffer_free</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>);</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;        <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;            {</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;            }</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        }</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160; </div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a> &gt; 0)</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;        {</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        retval = <a class="code" href="gsd_8c.html#ae50726c30c5bf629b6af1ef88020302f">gsd_byte_buffer_free</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>);</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;        <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;            {</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;            }</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;        }</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160; </div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;    retval = <a class="code" href="gsd_8c.html#a8249dc854c432e55e8ee07a8d3e8546c">gsd_name_id_map_free</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a17f63ed60cc1f9e456bf2d5ce301ecf8">name_map</a>);</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;        {</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;        <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;        }</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160; </div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    retval = <a class="code" href="gsd_8c.html#a9e12a38df69cf73fa771b005748cb3e5">gsd_index_buffer_free</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>);</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;    <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;        {</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;        <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;        }</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160; </div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a9086141add0c7be99bcfed3bfd6dadac">frame_index</a>.<a class="code" href="structgsd__index__buffer.html#a51a1e266f6d7d1aafdfd54822fc226b1">reserved</a> &gt; 0)</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;        {</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;        retval = <a class="code" href="gsd_8c.html#a9e12a38df69cf73fa771b005748cb3e5">gsd_index_buffer_free</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a9086141add0c7be99bcfed3bfd6dadac">frame_index</a>);</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;        <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;            {</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;            }</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;        }</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160; </div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a501968a30f0b06f4b7cb69c115648627">buffer_index</a>.<a class="code" href="structgsd__index__buffer.html#a51a1e266f6d7d1aafdfd54822fc226b1">reserved</a> &gt; 0)</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;        {</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;        retval = <a class="code" href="gsd_8c.html#a9e12a38df69cf73fa771b005748cb3e5">gsd_index_buffer_free</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a501968a30f0b06f4b7cb69c115648627">buffer_index</a>);</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;        <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;            {</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;            }</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;        }</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160; </div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a7ae49d668bbd61ce9d022acf5e5a9e76">write_buffer</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a> &gt; 0)</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;        {</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;        retval = <a class="code" href="gsd_8c.html#ae50726c30c5bf629b6af1ef88020302f">gsd_byte_buffer_free</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a7ae49d668bbd61ce9d022acf5e5a9e76">write_buffer</a>);</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;            {</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;            }</div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;        }</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160; </div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    <span class="comment">// keep a copy of the old header</span></div>
<div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    <span class="keyword">struct </span><a class="code" href="structgsd__header.html">gsd_header</a> old_header = handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>;</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    retval = <a class="code" href="gsd_8c.html#acb769baf09c31a5ad6cba95bd348c194">gsd_initialize_file</a>(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>,</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;                                 old_header.<a class="code" href="structgsd__header.html#ad23681ad38d32167197a22e75a2605b1">application</a>,</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;                                 old_header.<a class="code" href="structgsd__header.html#a31b0992efad0ec0288ce7064f773dbda">schema</a>,</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;                                 old_header.<a class="code" href="structgsd__header.html#a1740d644c468c25cbade9ee0ee1c1a63">schema_version</a>);</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160; </div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        {</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;        }</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160; </div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8c.html#ac159dfbfd790607f85073ad2d8464a8b">gsd_initialize_handle</a>(handle);</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00151">gsd_header::application</a>, <a class="el" href="gsd_8h_source.html#l00296">gsd_handle::buffer_index</a>, <a class="el" href="gsd_8h_source.html#l00266">gsd_name_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00284">gsd_handle::fd</a>, <a class="el" href="gsd_8h_source.html#l00290">gsd_handle::file_index</a>, <a class="el" href="gsd_8h_source.html#l00302">gsd_handle::file_names</a>, <a class="el" href="gsd_8h_source.html#l00293">gsd_handle::frame_index</a>, <a class="el" href="gsd_8h_source.html#l00305">gsd_handle::frame_names</a>, <a class="el" href="gsd_8c_source.html#l00535">gsd_byte_buffer_free()</a>, <a class="el" href="gsd_8h_source.html#l00098">GSD_ERROR_FILE_MUST_BE_WRITABLE</a>, <a class="el" href="gsd_8h_source.html#l00078">GSD_ERROR_INVALID_ARGUMENT</a>, <a class="el" href="gsd_8c_source.html#l00706">gsd_index_buffer_free()</a>, <a class="el" href="gsd_8c_source.html#l01322">gsd_initialize_file()</a>, <a class="el" href="gsd_8c_source.html#l01401">gsd_initialize_handle()</a>, <a class="el" href="gsd_8c_source.html#l00257">gsd_name_id_map_free()</a>, <a class="el" href="gsd_8h_source.html#l00062">GSD_OPEN_READONLY</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, <a class="el" href="gsd_8h_source.html#l00287">gsd_handle::header</a>, <a class="el" href="gsd_8h_source.html#l00317">gsd_handle::name_map</a>, <a class="el" href="gsd_8h_source.html#l00314">gsd_handle::open_flags</a>, <a class="el" href="gsd_8h_source.html#l00232">gsd_index_buffer::reserved</a>, <a class="el" href="gsd_8h_source.html#l00255">gsd_byte_buffer::reserved</a>, <a class="el" href="gsd_8h_source.html#l00154">gsd_header::schema</a>, <a class="el" href="gsd_8h_source.html#l00145">gsd_header::schema_version</a>, and <a class="el" href="gsd_8h_source.html#l00299">gsd_handle::write_buffer</a>.</p>

<p class="reference">Referenced by <a class="el" href="GSDUtil_8cpp_source.html#l00075">GSDUtil::truncateGSD()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a02ac7984034069d508b1c7ccbe702bac_cgraph.svg" width="932" height="443"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a02ac7984034069d508b1c7ccbe702bac_icgraph.svg" width="311" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a08b4f76e3e19eda194def8c0c4b2b7a3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08b4f76e3e19eda194def8c0c4b2b7a3">&#9670;&nbsp;</a></span>gsd_close()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gsd_close </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *&#160;</td>
          <td class="paramname"><em>handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Close a GSD file</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>GSD file to close.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><em>handle</em> was opened by <a class="el" href="gsd_8h.html#ae0add799755285c1108a7b97b2ed7e00">gsd_open()</a>. </dd>
<dd>
<a class="el" href="gsd_8h.html#aa03810337c5eebcbe716d8633eaefc5e">gsd_end_frame()</a> has been called since the last call to <a class="el" href="gsd_8h.html#ae22447904b925f284bf987fae448488a">gsd_write_chunk()</a>.</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>The file is closed. </dd>
<dd>
<em>handle</em> is freed and can no longer be used.</dd></dl>
<dl class="section warning"><dt>Warning</dt><dd>Ensure that all <a class="el" href="gsd_8h.html#ae22447904b925f284bf987fae448488a">gsd_write_chunk()</a> calls are committed with <a class="el" href="gsd_8h.html#aa03810337c5eebcbe716d8633eaefc5e">gsd_end_frame()</a> before closing the file.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>GSD_SUCCESS (0) on success. Negative value on failure:</li>
<li>GSD_ERROR_IO: IO error (check errno).</li>
<li>GSD_ERROR_INVALID_ARGUMENT: <em>handle</em> is NULL. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l01763">1763</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    {</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    <span class="keywordflow">if</span> (handle == NULL)</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;        {</div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;        }</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160; </div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <span class="comment">// save the fd so we can use it after freeing the handle</span></div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    <span class="keywordtype">int</span> fd = handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>;</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160; </div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <span class="keywordtype">int</span> retval = <a class="code" href="gsd_8c.html#a9e12a38df69cf73fa771b005748cb3e5">gsd_index_buffer_free</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>);</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;        {</div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;        <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;        }</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160; </div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a9086141add0c7be99bcfed3bfd6dadac">frame_index</a>.<a class="code" href="structgsd__index__buffer.html#a51a1e266f6d7d1aafdfd54822fc226b1">reserved</a> &gt; 0)</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;        {</div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;        retval = <a class="code" href="gsd_8c.html#a9e12a38df69cf73fa771b005748cb3e5">gsd_index_buffer_free</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a9086141add0c7be99bcfed3bfd6dadac">frame_index</a>);</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;        <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;            {</div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;            }</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;        }</div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160; </div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a501968a30f0b06f4b7cb69c115648627">buffer_index</a>.<a class="code" href="structgsd__index__buffer.html#a51a1e266f6d7d1aafdfd54822fc226b1">reserved</a> &gt; 0)</div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;        {</div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;        retval = <a class="code" href="gsd_8c.html#a9e12a38df69cf73fa771b005748cb3e5">gsd_index_buffer_free</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a501968a30f0b06f4b7cb69c115648627">buffer_index</a>);</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;        <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;            {</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;            }</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;        }</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160; </div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a7ae49d668bbd61ce9d022acf5e5a9e76">write_buffer</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a> &gt; 0)</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;        {</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;        retval = <a class="code" href="gsd_8c.html#ae50726c30c5bf629b6af1ef88020302f">gsd_byte_buffer_free</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a7ae49d668bbd61ce9d022acf5e5a9e76">write_buffer</a>);</div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;        <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;            {</div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;            }</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;        }</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160; </div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    retval = <a class="code" href="gsd_8c.html#a8249dc854c432e55e8ee07a8d3e8546c">gsd_name_id_map_free</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a17f63ed60cc1f9e456bf2d5ce301ecf8">name_map</a>);</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;        {</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;        <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;        }</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160; </div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a> &gt; 0)</div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;        {</div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#aee7f806d610d9c4b8e0f045024d4e1f6">n_names</a> = 0;</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;        retval = <a class="code" href="gsd_8c.html#ae50726c30c5bf629b6af1ef88020302f">gsd_byte_buffer_free</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>);</div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;        <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;            {</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;            }</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;        }</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160; </div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a> &gt; 0)</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;        {</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#aee7f806d610d9c4b8e0f045024d4e1f6">n_names</a> = 0;</div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;        retval = <a class="code" href="gsd_8c.html#ae50726c30c5bf629b6af1ef88020302f">gsd_byte_buffer_free</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>);</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;            {</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;            }</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;        }</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160; </div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    <span class="comment">// close the file</span></div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;    retval = close(fd);</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;    <span class="keywordflow">if</span> (retval != 0)</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;        {</div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        }</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160; </div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00296">gsd_handle::buffer_index</a>, <a class="el" href="gsd_8h_source.html#l00266">gsd_name_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00284">gsd_handle::fd</a>, <a class="el" href="gsd_8h_source.html#l00290">gsd_handle::file_index</a>, <a class="el" href="gsd_8h_source.html#l00302">gsd_handle::file_names</a>, <a class="el" href="gsd_8h_source.html#l00293">gsd_handle::frame_index</a>, <a class="el" href="gsd_8h_source.html#l00305">gsd_handle::frame_names</a>, <a class="el" href="gsd_8c_source.html#l00535">gsd_byte_buffer_free()</a>, <a class="el" href="gsd_8h_source.html#l00078">GSD_ERROR_INVALID_ARGUMENT</a>, <a class="el" href="gsd_8h_source.html#l00075">GSD_ERROR_IO</a>, <a class="el" href="gsd_8c_source.html#l00706">gsd_index_buffer_free()</a>, <a class="el" href="gsd_8c_source.html#l00257">gsd_name_id_map_free()</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, <a class="el" href="gsd_8h_source.html#l00269">gsd_name_buffer::n_names</a>, <a class="el" href="gsd_8h_source.html#l00317">gsd_handle::name_map</a>, <a class="el" href="gsd_8h_source.html#l00232">gsd_index_buffer::reserved</a>, <a class="el" href="gsd_8h_source.html#l00255">gsd_byte_buffer::reserved</a>, and <a class="el" href="gsd_8h_source.html#l00299">gsd_handle::write_buffer</a>.</p>

<p class="reference">Referenced by <a class="el" href="systemData_8cpp_source.html#l00026">systemData::~systemData()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a08b4f76e3e19eda194def8c0c4b2b7a3_cgraph.svg" width="502" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a08b4f76e3e19eda194def8c0c4b2b7a3_icgraph.svg" width="320" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="aa03810337c5eebcbe716d8633eaefc5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa03810337c5eebcbe716d8633eaefc5e">&#9670;&nbsp;</a></span>gsd_end_frame()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gsd_end_frame </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *&#160;</td>
          <td class="paramname"><em>handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Commit the current frame and increment the frame counter.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>Handle to an open GSD file</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><em>handle</em> was opened by <a class="el" href="gsd_8h.html#ae0add799755285c1108a7b97b2ed7e00">gsd_open()</a>. </dd>
<dd>
<a class="el" href="gsd_8h.html#ae22447904b925f284bf987fae448488a">gsd_write_chunk()</a> has been called at least once since the last call to <a class="el" href="gsd_8h.html#aa03810337c5eebcbe716d8633eaefc5e">gsd_end_frame()</a>.</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>The current frame counter is increased by 1 and cached indexes are written to disk.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>GSD_SUCCESS (0) on success. Negative value on failure:</li>
<li>GSD_ERROR_IO: IO error (check errno).</li>
<li>GSD_ERROR_INVALID_ARGUMENT: <em>handle</em> is NULL.</li>
<li>GSD_ERROR_FILE_MUST_BE_WRITABLE: The file was opened read-only.</li>
<li>GSD_ERROR_MEMORY_ALLOCATION_FAILED: Unable to allocate memory. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l01842">1842</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    {</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <span class="keywordflow">if</span> (handle == NULL)</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;        {</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;        }</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a37ddf6d53fc8c4f3eff247508fcc814b">open_flags</a> == <a class="code" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a22f5dee98250b8ead7d43cc1a347f205">GSD_OPEN_READONLY</a>)</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;        {</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa5cbc2efac6a7d90f89b616e791eac64">GSD_ERROR_FILE_MUST_BE_WRITABLE</a>;</div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;        }</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160; </div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;    <span class="comment">// increment the frame counter</span></div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;    handle-&gt;<a class="code" href="structgsd__handle.html#a144dc0976a1fe2f895423495689daea5">cur_frame</a>++;</div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160; </div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    <span class="comment">// flush the namelist buffer</span></div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;    <span class="keywordtype">int</span> retval = <a class="code" href="gsd_8c.html#ab147cf4d77c10fd8085e5023e9afe55f">gsd_flush_name_buffer</a>(handle);</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;    <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;        {</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;        <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;        }</div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160; </div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    <span class="comment">// flush the write buffer</span></div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;    retval = <a class="code" href="gsd_8c.html#a61daeaa70162e9bac3d241832b460278">gsd_flush_write_buffer</a>(handle);</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;        {</div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;        <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;        }</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160; </div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;    <span class="comment">// write the frame index to the file</span></div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a9086141add0c7be99bcfed3bfd6dadac">frame_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> &gt; 0)</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;        {</div>
<div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;        <span class="comment">// ensure there is enough space in the index</span></div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;        <span class="keywordflow">if</span> ((handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> + handle-&gt;<a class="code" href="structgsd__handle.html#a9086141add0c7be99bcfed3bfd6dadac">frame_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a>) &gt; handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a51a1e266f6d7d1aafdfd54822fc226b1">reserved</a>)</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;            {</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;            <a class="code" href="gsd_8c.html#ae6dddb94661e99e54f6c01b1a443e27f">gsd_expand_file_index</a>(handle, handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> + handle-&gt;<a class="code" href="structgsd__handle.html#a9086141add0c7be99bcfed3bfd6dadac">frame_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a>);</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;            }</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160; </div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;        <span class="comment">// sort the index before writing</span></div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;        retval = <a class="code" href="gsd_8c.html#a6c20ccb47eed1a3ea9995a47a8eebdbd">gsd_index_buffer_sort</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a9086141add0c7be99bcfed3bfd6dadac">frame_index</a>);</div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;        <span class="keywordflow">if</span> (retval != 0)</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;            {</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;            }</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160; </div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;        <span class="comment">// write the frame index entries to the file</span></div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;        int64_t write_pos = handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a89d5af9234f456010e16116452064b78">index_location</a></div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;                            + <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structgsd__index__entry.html">gsd_index_entry</a>) * handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a>;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160; </div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        <span class="keywordtype">size_t</span> bytes_to_write = <span class="keyword">sizeof</span>(<span class="keyword">struct </span><a class="code" href="structgsd__index__entry.html">gsd_index_entry</a>) * handle-&gt;<a class="code" href="structgsd__handle.html#a9086141add0c7be99bcfed3bfd6dadac">frame_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a>;</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;        ssize_t bytes_written</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;            = <a class="code" href="gsd_8c.html#a3fb7746d93a1c856ca7ef64fa3548cbe">gsd_io_pwrite_retry</a>(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>, handle-&gt;<a class="code" href="structgsd__handle.html#a9086141add0c7be99bcfed3bfd6dadac">frame_index</a>.<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>, bytes_to_write, write_pos);</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160; </div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;        <span class="keywordflow">if</span> (bytes_written == -1 || bytes_written != bytes_to_write)</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;            {</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;            }</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160; </div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;<span class="preprocessor">#if !GSD_USE_MMAP</span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;        <span class="comment">// add the entries to the file index</span></div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;        memcpy(handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a> + handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a>,</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;               handle-&gt;<a class="code" href="structgsd__handle.html#a9086141add0c7be99bcfed3bfd6dadac">frame_index</a>.<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>,</div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;               <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__index__entry.html">gsd_index_entry</a>) * handle-&gt;<a class="code" href="structgsd__handle.html#a9086141add0c7be99bcfed3bfd6dadac">frame_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a>);</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160; </div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;        <span class="comment">// update size of file index</span></div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> += handle-&gt;<a class="code" href="structgsd__handle.html#a9086141add0c7be99bcfed3bfd6dadac">frame_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a>;</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160; </div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;        <span class="comment">// clear the frame index</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#a9086141add0c7be99bcfed3bfd6dadac">frame_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> = 0;</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;        }</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160; </div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00308">gsd_handle::cur_frame</a>, <a class="el" href="gsd_8h_source.html#l00226">gsd_index_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00284">gsd_handle::fd</a>, <a class="el" href="gsd_8h_source.html#l00290">gsd_handle::file_index</a>, <a class="el" href="gsd_8h_source.html#l00293">gsd_handle::frame_index</a>, <a class="el" href="gsd_8h_source.html#l00098">GSD_ERROR_FILE_MUST_BE_WRITABLE</a>, <a class="el" href="gsd_8h_source.html#l00078">GSD_ERROR_INVALID_ARGUMENT</a>, <a class="el" href="gsd_8h_source.html#l00075">GSD_ERROR_IO</a>, <a class="el" href="gsd_8c_source.html#l00933">gsd_expand_file_index()</a>, <a class="el" href="gsd_8c_source.html#l01148">gsd_flush_name_buffer()</a>, <a class="el" href="gsd_8c_source.html#l01081">gsd_flush_write_buffer()</a>, <a class="el" href="gsd_8c_source.html#l00899">gsd_index_buffer_sort()</a>, <a class="el" href="gsd_8c_source.html#l00148">gsd_io_pwrite_retry()</a>, <a class="el" href="gsd_8h_source.html#l00062">GSD_OPEN_READONLY</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, <a class="el" href="gsd_8h_source.html#l00287">gsd_handle::header</a>, <a class="el" href="gsd_8h_source.html#l00133">gsd_header::index_location</a>, <a class="el" href="gsd_8h_source.html#l00314">gsd_handle::open_flags</a>, <a class="el" href="gsd_8h_source.html#l00232">gsd_index_buffer::reserved</a>, and <a class="el" href="gsd_8h_source.html#l00229">gsd_index_buffer::size</a>.</p>

<p class="reference">Referenced by <a class="el" href="GSDUtil_8cpp_source.html#l00456">GSDUtil::writeFrame()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_aa03810337c5eebcbe716d8633eaefc5e_cgraph.svg" width="954" height="544"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_aa03810337c5eebcbe716d8633eaefc5e_icgraph.svg" width="314" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ae22447904b925f284bf987fae448488a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae22447904b925f284bf987fae448488a">&#9670;&nbsp;</a></span>gsd_write_chunk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gsd_write_chunk </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">enum <a class="el" href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118">gsd_type</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>flags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&#160;</td>
          <td class="paramname"><em>data</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Write a data chunk to the current frame</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>Handle to an open GSD file. </td></tr>
    <tr><td class="paramname">name</td><td>Name of the data chunk. </td></tr>
    <tr><td class="paramname">type</td><td>type ID that identifies the type of data in <em>data</em>. </td></tr>
    <tr><td class="paramname">N</td><td>Number of rows in the data. </td></tr>
    <tr><td class="paramname">M</td><td>Number of columns in the data. </td></tr>
    <tr><td class="paramname">flags</td><td>set to 0, non-zero values reserved for future use. </td></tr>
    <tr><td class="paramname">data</td><td>Data buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><em>handle</em> was opened by <a class="el" href="gsd_8h.html#ae0add799755285c1108a7b97b2ed7e00">gsd_open()</a>. </dd>
<dd>
<em>name</em> is a unique name for data chunks in the given frame. </dd>
<dd>
data is allocated and contains at least <code>N * M * gsd_sizeof_type(type)</code> bytes.</dd></dl>
<dl class="section post"><dt>Postcondition</dt><dd>The given data chunk is written to the end of the file and its location is updated in the in-memory index.</dd></dl>
<dl class="section note"><dt>Note</dt><dd>If the GSD file is version 1.0, the chunk name is truncated to 63 bytes. GSD version 2.0 files support arbitrarily long names.</dd>
<dd>
<em>N</em> == 0 is allowed. When <em>N</em> is 0, <em>data</em> may be NULL.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>GSD_SUCCESS (0) on success. Negative value on failure:</li>
<li>GSD_ERROR_IO: IO error (check errno).</li>
<li>GSD_ERROR_INVALID_ARGUMENT: <em>handle</em> is NULL, <em>N</em> == 0, <em>M</em> == 0, <em>type</em> is invalid, or flags* != 0.</li>
<li>GSD_ERROR_FILE_MUST_BE_WRITABLE: The file was opened read-only.</li>
<li>GSD_ERROR_NAMELIST_FULL: The file cannot store any additional unique chunk names.</li>
<li>GSD_ERROR_MEMORY_ALLOCATION_FAILED: failed to allocate memory. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l01916">1916</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    {</div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    <span class="comment">// validate input</span></div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structgsd__index__entry.html#ae913d46842b10fe8b5b74da3a7075726">N</a> &gt; 0 &amp;&amp; data == NULL)</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        {</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;        }</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structgsd__index__entry.html#acbd3b797c1d179affc5fe279260b40f2">M</a> == 0)</div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;        {</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        }</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a37ddf6d53fc8c4f3eff247508fcc814b">open_flags</a> == <a class="code" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a22f5dee98250b8ead7d43cc1a347f205">GSD_OPEN_READONLY</a>)</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;        {</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa5cbc2efac6a7d90f89b616e791eac64">GSD_ERROR_FILE_MUST_BE_WRITABLE</a>;</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;        }</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structgsd__index__entry.html#a0fd668ac1b940ccb0b22793709145091">flags</a> != 0)</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        {</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;        }</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160; </div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;    uint16_t <span class="keywordtype">id</span> = <a class="code" href="gsd_8c.html#a31b9400272036b121040e9fc0a9e626b">gsd_name_id_map_find</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a17f63ed60cc1f9e456bf2d5ce301ecf8">name_map</a>, name);</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == UINT16_MAX)</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        {</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;        <span class="comment">// not found, append to the index</span></div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        <span class="keywordtype">int</span> retval = <a class="code" href="gsd_8c.html#aa1a0a7dcf4015edcadbb47a6451b4a4b">gsd_append_name</a>(&amp;<span class="keywordtype">id</span>, handle, name);</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;            {</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;            }</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160; </div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == UINT16_MAX)</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;            {</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;            <span class="comment">// this should never happen</span></div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba4cca403d94a443c160073da8cf26a88b">GSD_ERROR_NAMELIST_FULL</a>;</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;            }</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;        }</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160; </div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <span class="keyword">struct </span><a class="code" href="structgsd__index__entry.html">gsd_index_entry</a> entry;</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <span class="comment">// populate fields in the entry&#39;s data</span></div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    <a class="code" href="gsd_8c.html#a9b05d58560daee2512f03bedf7b2926d">gsd_util_zero_memory</a>(&amp;entry, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__index__entry.html">gsd_index_entry</a>));</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    entry.frame = handle-&gt;<a class="code" href="structgsd__handle.html#a144dc0976a1fe2f895423495689daea5">cur_frame</a>;</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    entry.id = <a class="code" href="structgsd__index__entry.html#aa7ed270380c0d8074232aad5bb32bfb4">id</a>;</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    entry.type = (uint8_t)<a class="code" href="structgsd__index__entry.html#aebddbeda0dacc7125308440c46b9230a">type</a>;</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;    entry.N = <a class="code" href="structgsd__index__entry.html#ae913d46842b10fe8b5b74da3a7075726">N</a>;</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;    entry.M = <a class="code" href="structgsd__index__entry.html#acbd3b797c1d179affc5fe279260b40f2">M</a>;</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;    <span class="keywordtype">size_t</span> size = <a class="code" href="structgsd__index__entry.html#ae913d46842b10fe8b5b74da3a7075726">N</a> * <a class="code" href="structgsd__index__entry.html#acbd3b797c1d179affc5fe279260b40f2">M</a> * <a class="code" href="gsd_8c.html#ab1d1a8a5f73b37df0c706f41df3bdd69">gsd_sizeof_type</a>(<a class="code" href="structgsd__index__entry.html#aebddbeda0dacc7125308440c46b9230a">type</a>);</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160; </div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;    <span class="comment">// decide whether to write this chunk to the buffer or straight to disk</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    <span class="keywordflow">if</span> (size &lt; handle-&gt;write_buffer.reserved / 2)</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;        {</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        <span class="comment">// flush the buffer if this entry won&#39;t fit</span></div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;        <span class="keywordflow">if</span> (size &gt; (handle-&gt;<a class="code" href="structgsd__handle.html#a7ae49d668bbd61ce9d022acf5e5a9e76">write_buffer</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a> - handle-&gt;<a class="code" href="structgsd__handle.html#a7ae49d668bbd61ce9d022acf5e5a9e76">write_buffer</a>.<a class="code" href="structgsd__byte__buffer.html#a3630961b7d45df2885cdd887e4b83b60">size</a>))</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;            {</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;            <a class="code" href="gsd_8c.html#a61daeaa70162e9bac3d241832b460278">gsd_flush_write_buffer</a>(handle);</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;            }</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160; </div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;        entry.location = handle-&gt;<a class="code" href="structgsd__handle.html#a7ae49d668bbd61ce9d022acf5e5a9e76">write_buffer</a>.<a class="code" href="structgsd__byte__buffer.html#a3630961b7d45df2885cdd887e4b83b60">size</a>;</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160; </div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;        <span class="comment">// add an entry to the buffer index</span></div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;        <span class="keyword">struct </span><a class="code" href="structgsd__index__entry.html">gsd_index_entry</a>* index_entry;</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160; </div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;        <span class="keywordtype">int</span> retval = <a class="code" href="gsd_8c.html#a258b64725f90f60d969752d65fba9850">gsd_index_buffer_add</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a501968a30f0b06f4b7cb69c115648627">buffer_index</a>, &amp;index_entry);</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;        <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;            {</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;            }</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;        *index_entry = entry;</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160; </div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;        <span class="comment">// add the data to the write buffer</span></div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;        <span class="keywordflow">if</span> (size &gt; 0)</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;            {</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;            retval = <a class="code" href="gsd_8c.html#a7a717f9dafe011e68434e181c76253af">gsd_byte_buffer_append</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a7ae49d668bbd61ce9d022acf5e5a9e76">write_buffer</a>, data, size);</div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;            <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;                {</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;                <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;                }</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;            }</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;        }</div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;        {</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;        <span class="comment">// add an entry to the frame index</span></div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;        <span class="keyword">struct </span><a class="code" href="structgsd__index__entry.html">gsd_index_entry</a>* index_entry;</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160; </div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;        <span class="keywordtype">int</span> retval = <a class="code" href="gsd_8c.html#a258b64725f90f60d969752d65fba9850">gsd_index_buffer_add</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a9086141add0c7be99bcfed3bfd6dadac">frame_index</a>, &amp;index_entry);</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;        <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;            {</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;            }</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;        *index_entry = entry;</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160; </div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;        <span class="comment">// find the location at the end of the file for the chunk</span></div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;        index_entry-&gt;<a class="code" href="structgsd__index__entry.html#a70e15b9094a3a22954bba035496d83bf">location</a> = handle-&gt;<a class="code" href="structgsd__handle.html#ac35aad0eef4a5844ecc4141041fa9243">file_size</a>;</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160; </div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;        <span class="comment">// write the data</span></div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;        ssize_t bytes_written = <a class="code" href="gsd_8c.html#a3fb7746d93a1c856ca7ef64fa3548cbe">gsd_io_pwrite_retry</a>(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>, data, size, index_entry-&gt;<a class="code" href="structgsd__index__entry.html#a70e15b9094a3a22954bba035496d83bf">location</a>);</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;        <span class="keywordflow">if</span> (bytes_written == -1 || bytes_written != size)</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;            {</div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;            }</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160; </div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;        <span class="comment">// update the file_size in the handle</span></div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#ac35aad0eef4a5844ecc4141041fa9243">file_size</a> += bytes_written;</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;        }</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160; </div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00296">gsd_handle::buffer_index</a>, <a class="el" href="gsd_8h_source.html#l00308">gsd_handle::cur_frame</a>, <a class="el" href="gsd_8h_source.html#l00284">gsd_handle::fd</a>, <a class="el" href="gsd_8h_source.html#l00311">gsd_handle::file_size</a>, <a class="el" href="gsd_8h_source.html#l00187">gsd_index_entry::flags</a>, <a class="el" href="gsd_8h_source.html#l00169">gsd_index_entry::frame</a>, <a class="el" href="gsd_8h_source.html#l00293">gsd_handle::frame_index</a>, <a class="el" href="gsd_8c_source.html#l01264">gsd_append_name()</a>, <a class="el" href="gsd_8c_source.html#l00491">gsd_byte_buffer_append()</a>, <a class="el" href="gsd_8h_source.html#l00098">GSD_ERROR_FILE_MUST_BE_WRITABLE</a>, <a class="el" href="gsd_8h_source.html#l00078">GSD_ERROR_INVALID_ARGUMENT</a>, <a class="el" href="gsd_8h_source.html#l00075">GSD_ERROR_IO</a>, <a class="el" href="gsd_8h_source.html#l00093">GSD_ERROR_NAMELIST_FULL</a>, <a class="el" href="gsd_8c_source.html#l01081">gsd_flush_write_buffer()</a>, <a class="el" href="gsd_8c_source.html#l00744">gsd_index_buffer_add()</a>, <a class="el" href="gsd_8c_source.html#l00148">gsd_io_pwrite_retry()</a>, <a class="el" href="gsd_8c_source.html#l00377">gsd_name_id_map_find()</a>, <a class="el" href="gsd_8h_source.html#l00062">GSD_OPEN_READONLY</a>, <a class="el" href="gsd_8c_source.html#l02177">gsd_sizeof_type()</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, <a class="el" href="gsd_8c_source.html#l00130">gsd_util_zero_memory()</a>, <a class="el" href="gsd_8h_source.html#l00181">gsd_index_entry::id</a>, <a class="el" href="gsd_8h_source.html#l00175">gsd_index_entry::location</a>, <a class="el" href="gsd_8h_source.html#l00178">gsd_index_entry::M</a>, <a class="el" href="gsd_8h_source.html#l00172">gsd_index_entry::N</a>, <a class="el" href="gsd_8h_source.html#l00317">gsd_handle::name_map</a>, <a class="el" href="gsd_8h_source.html#l00314">gsd_handle::open_flags</a>, <a class="el" href="gsd_8h_source.html#l00255">gsd_byte_buffer::reserved</a>, <a class="el" href="gsd_8h_source.html#l00252">gsd_byte_buffer::size</a>, <a class="el" href="gsd_8h_source.html#l00184">gsd_index_entry::type</a>, and <a class="el" href="gsd_8h_source.html#l00299">gsd_handle::write_buffer</a>.</p>

<p class="reference">Referenced by <a class="el" href="GSDUtil_8cpp_source.html#l00473">GSDUtil::writeHeader()</a>, <a class="el" href="GSDUtil_8cpp_source.html#l00500">GSDUtil::writeParameters()</a>, and <a class="el" href="GSDUtil_8cpp_source.html#l00517">GSDUtil::writeParticles()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_ae22447904b925f284bf987fae448488a_cgraph.svg" width="758" height="382"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_ae22447904b925f284bf987fae448488a_icgraph.svg" width="546" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a7479046d4d6e15c33cb24034ddd87562"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7479046d4d6e15c33cb24034ddd87562">&#9670;&nbsp;</a></span>gsd_get_nframes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint64_t gsd_get_nframes </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *&#160;</td>
          <td class="paramname"><em>handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Get the number of frames in the GSD file</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>Handle to an open GSD file</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><em>handle</em> was opened by <a class="el" href="gsd_8h.html#ae0add799755285c1108a7b97b2ed7e00">gsd_open()</a>.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd>The number of frames in the file, or 0 on error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l02029">2029</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    {</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    <span class="keywordflow">if</span> (handle == NULL)</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;        {</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;        }</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    <span class="keywordflow">return</span> handle-&gt;<a class="code" href="structgsd__handle.html#a144dc0976a1fe2f895423495689daea5">cur_frame</a>;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00308">gsd_handle::cur_frame</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l02039">gsd_find_chunk()</a>, <a class="el" href="GSDUtil_8cpp_source.html#l00008">GSDUtil::GSDUtil()</a>, <a class="el" href="GSDUtil_8cpp_source.html#l00473">GSDUtil::writeHeader()</a>, and <a class="el" href="GSDUtil_8cpp_source.html#l00517">GSDUtil::writeParticles()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a7479046d4d6e15c33cb24034ddd87562_icgraph.svg" width="959" height="342"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a3c76bbf6c28b953cff198a44852c732f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c76bbf6c28b953cff198a44852c732f">&#9670;&nbsp;</a></span>gsd_find_chunk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const struct <a class="el" href="structgsd__index__entry.html">gsd_index_entry</a>* gsd_find_chunk </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint64_t&#160;</td>
          <td class="paramname"><em>frame</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>name</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Find a chunk in the GSD file</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>Handle to an open GSD file </td></tr>
    <tr><td class="paramname">frame</td><td>Frame to look for chunk </td></tr>
    <tr><td class="paramname">name</td><td>Name of the chunk to find</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><em>handle</em> was opened by <a class="el" href="gsd_8h.html#ae0add799755285c1108a7b97b2ed7e00">gsd_open()</a> in read or readwrite mode.</dd></dl>
<p>The found entry contains size and type metadata and can be passed to <a class="el" href="gsd_8h.html#a2db2e3e8a72948bf413e7f09469ec8a6">gsd_read_chunk()</a> to read the data.</p>
<dl class="section return"><dt>Returns</dt><dd>A pointer to the found chunk, or NULL if not found. </dd></dl>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l02039">2039</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;    {</div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    <span class="keywordflow">if</span> (handle == NULL)</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;        {</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160;        }</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    <span class="keywordflow">if</span> (name == NULL)</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;        {</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;        }</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structgsd__index__entry.html#a1b6c67d9197aa4588964052c2919092e">frame</a> &gt;= <a class="code" href="gsd_8c.html#a7479046d4d6e15c33cb24034ddd87562">gsd_get_nframes</a>(handle))</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;        {</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;        }</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a37ddf6d53fc8c4f3eff247508fcc814b">open_flags</a> == <a class="code" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a987636cdb7cdac06ae7173d291abec40">GSD_OPEN_APPEND</a>)</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;        {</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;        }</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160; </div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    <span class="comment">// find the id for the given name</span></div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    uint16_t match_id = <a class="code" href="gsd_8c.html#a31b9400272036b121040e9fc0a9e626b">gsd_name_id_map_find</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a17f63ed60cc1f9e456bf2d5ce301ecf8">name_map</a>, name);</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    <span class="keywordflow">if</span> (match_id == UINT16_MAX)</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;        {</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;        }</div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160; </div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a5e2e07be01bcfa15c0834d6859878171">gsd_version</a> &gt;= <a class="code" href="gsd_8c.html#a493ef951956c9f98adff89a80ddb3fa6">gsd_make_version</a>(2, 0))</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;        {</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;        <span class="comment">// gsd 2.0 files sort the entire index</span></div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;        <span class="comment">// binary search for the index entry</span></div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;        ssize_t L = 0;</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;        ssize_t R = handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> - 1;</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;        <span class="keyword">struct </span><a class="code" href="structgsd__index__entry.html">gsd_index_entry</a> T;</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;        T.<a class="code" href="structgsd__index__entry.html#a1b6c67d9197aa4588964052c2919092e">frame</a> = <a class="code" href="structgsd__index__entry.html#a1b6c67d9197aa4588964052c2919092e">frame</a>;</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;        T.id = match_id;</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160; </div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;        <span class="keywordflow">while</span> (L &lt;= R)</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;            {</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;            <span class="keywordtype">size_t</span> m = (L + R) / 2;</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;            <span class="keywordtype">int</span> cmp = <a class="code" href="gsd_8c.html#a3ffe758eed9a5bae487f514a0a45e97d">gsd_cmp_index_entry</a>(handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a> + m, &amp;T);</div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;            <span class="keywordflow">if</span> (cmp == -1)</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;                {</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;                L = m + 1;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;                }</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (cmp == 1)</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;                {</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;                R = m - 1;</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;                }</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;                {</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;                <span class="keywordflow">return</span> &amp;(handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>[m]);</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;                }</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;            }</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;        }</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;        {</div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;        <span class="comment">// gsd 1.0 file: use binary search to find the frame and linear search to find the entry</span></div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;        <span class="keywordtype">size_t</span> L = 0;</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;        <span class="keywordtype">size_t</span> R = handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a>;</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160; </div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;        <span class="comment">// progressively narrow the search window by halves</span></div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;        <span class="keywordflow">do</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;            {</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;            <span class="keywordtype">size_t</span> m = (L + R) / 2;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160; </div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;            <span class="keywordflow">if</span> (frame &lt; handle-&gt;file_index.data[m].frame)</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;                {</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;                R = m;</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;                }</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;            <span class="keywordflow">else</span></div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;                {</div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                L = m;</div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;                }</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;            } <span class="keywordflow">while</span> ((R - L) &gt; 1);</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160; </div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;        <span class="comment">// this finds L = the rightmost index with the desired frame</span></div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;        int64_t cur_index;</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160; </div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;        <span class="comment">// search all index entries with the matching frame</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;        <span class="keywordflow">for</span> (cur_index = L; (cur_index &gt;= 0) &amp;&amp; (handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>[cur_index].<a class="code" href="structgsd__index__entry.html#a1b6c67d9197aa4588964052c2919092e">frame</a> == <a class="code" href="structgsd__index__entry.html#a1b6c67d9197aa4588964052c2919092e">frame</a>);</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;             cur_index--)</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;            {</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;            <span class="comment">// if the frame matches, check the id</span></div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;            <span class="keywordflow">if</span> (match_id == handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>[cur_index].<a class="code" href="structgsd__index__entry.html#aa7ed270380c0d8074232aad5bb32bfb4">id</a>)</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;                {</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;                <span class="keywordflow">return</span> &amp;(handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>[cur_index]);</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;                }</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;            }</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;        }</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160; </div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    <span class="comment">// if we got here, we didn&#39;t find the specified chunk</span></div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00226">gsd_index_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00290">gsd_handle::file_index</a>, <a class="el" href="gsd_8h_source.html#l00169">gsd_index_entry::frame</a>, <a class="el" href="gsd_8c_source.html#l00774">gsd_cmp_index_entry()</a>, <a class="el" href="gsd_8c_source.html#l02029">gsd_get_nframes()</a>, <a class="el" href="gsd_8c_source.html#l01563">gsd_make_version()</a>, <a class="el" href="gsd_8c_source.html#l00377">gsd_name_id_map_find()</a>, <a class="el" href="gsd_8h_source.html#l00065">GSD_OPEN_APPEND</a>, <a class="el" href="gsd_8h_source.html#l00148">gsd_header::gsd_version</a>, <a class="el" href="gsd_8h_source.html#l00287">gsd_handle::header</a>, <a class="el" href="gsd_8h_source.html#l00181">gsd_index_entry::id</a>, <a class="el" href="gsd_8h_source.html#l00317">gsd_handle::name_map</a>, <a class="el" href="gsd_8h_source.html#l00314">gsd_handle::open_flags</a>, and <a class="el" href="gsd_8h_source.html#l00229">gsd_index_buffer::size</a>.</p>

<p class="reference">Referenced by <a class="el" href="GSDUtil_8cpp_source.html#l00107">GSDUtil::readChunk()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a3c76bbf6c28b953cff198a44852c732f_cgraph.svg" width="479" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a3c76bbf6c28b953cff198a44852c732f_icgraph.svg" width="742" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a2db2e3e8a72948bf413e7f09469ec8a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2db2e3e8a72948bf413e7f09469ec8a6">&#9670;&nbsp;</a></span>gsd_read_chunk()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gsd_read_chunk </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structgsd__index__entry.html">gsd_index_entry</a> *&#160;</td>
          <td class="paramname"><em>chunk</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Read a chunk from the GSD file</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>Handle to an open GSD file. </td></tr>
    <tr><td class="paramname">data</td><td>Data buffer to read into. </td></tr>
    <tr><td class="paramname">chunk</td><td>Chunk to read.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><em>handle</em> was opened in read or readwrite mode. </dd>
<dd>
<em>chunk</em> was found by <a class="el" href="gsd_8h.html#a3c76bbf6c28b953cff198a44852c732f">gsd_find_chunk()</a>. </dd>
<dd>
<em>data</em> points to an allocated buffer with at least <code>N * M * gsd_sizeof_type(type)</code> bytes.</dd></dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>GSD_SUCCESS (0) on success. Negative value on failure:</li>
<li>GSD_ERROR_IO: IO error (check errno).</li>
<li>GSD_ERROR_INVALID_ARGUMENT: <em>handle</em> is NULL, <em>data</em> is NULL, or <em>chunk</em> is NULL.</li>
<li>GSD_ERROR_FILE_MUST_BE_READABLE: The file was opened in append mode.</li>
<li>GSD_ERROR_FILE_CORRUPT: The GSD file is corrupt. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l02133">2133</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;    {</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;    <span class="keywordflow">if</span> (handle == NULL)</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;        {</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;        }</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    <span class="keywordflow">if</span> (data == NULL)</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;        {</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;        }</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    <span class="keywordflow">if</span> (chunk == NULL)</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;        {</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;        }</div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a37ddf6d53fc8c4f3eff247508fcc814b">open_flags</a> == <a class="code" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a987636cdb7cdac06ae7173d291abec40">GSD_OPEN_APPEND</a>)</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;        {</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07bac5de89b0da97d4df5b52f18ee0977b7c">GSD_ERROR_FILE_MUST_BE_READABLE</a>;</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;        }</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160; </div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    <span class="keywordtype">size_t</span> size = chunk-&gt;<a class="code" href="structgsd__index__entry.html#ae913d46842b10fe8b5b74da3a7075726">N</a> * chunk-&gt;<a class="code" href="structgsd__index__entry.html#acbd3b797c1d179affc5fe279260b40f2">M</a> * <a class="code" href="gsd_8c.html#ab1d1a8a5f73b37df0c706f41df3bdd69">gsd_sizeof_type</a>((<span class="keyword">enum</span> <a class="code" href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118">gsd_type</a>)chunk-&gt;<a class="code" href="structgsd__index__entry.html#aebddbeda0dacc7125308440c46b9230a">type</a>);</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;    <span class="keywordflow">if</span> (size == 0)</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;        {</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba4236f6900d8a81a3a4ccafa2170ad27c">GSD_ERROR_FILE_CORRUPT</a>;</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;        }</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    <span class="keywordflow">if</span> (chunk-&gt;<a class="code" href="structgsd__index__entry.html#a70e15b9094a3a22954bba035496d83bf">location</a> == 0)</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;        {</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba4236f6900d8a81a3a4ccafa2170ad27c">GSD_ERROR_FILE_CORRUPT</a>;</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;        }</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160; </div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    <span class="comment">// validate that we don&#39;t read past the end of the file</span></div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    <span class="keywordflow">if</span> ((chunk-&gt;<a class="code" href="structgsd__index__entry.html#a70e15b9094a3a22954bba035496d83bf">location</a> + size) &gt; (uint64_t)handle-&gt;<a class="code" href="structgsd__handle.html#ac35aad0eef4a5844ecc4141041fa9243">file_size</a>)</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;        {</div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba4236f6900d8a81a3a4ccafa2170ad27c">GSD_ERROR_FILE_CORRUPT</a>;</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;        }</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160; </div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    ssize_t bytes_read = <a class="code" href="gsd_8c.html#ac1f41abbefbfe35337e7053d766c089b">gsd_io_pread_retry</a>(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>, data, size, chunk-&gt;<a class="code" href="structgsd__index__entry.html#a70e15b9094a3a22954bba035496d83bf">location</a>);</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    <span class="keywordflow">if</span> (bytes_read == -1 || bytes_read != size)</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;        {</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;        }</div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160; </div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00284">gsd_handle::fd</a>, <a class="el" href="gsd_8h_source.html#l00311">gsd_handle::file_size</a>, <a class="el" href="gsd_8h_source.html#l00087">GSD_ERROR_FILE_CORRUPT</a>, <a class="el" href="gsd_8h_source.html#l00103">GSD_ERROR_FILE_MUST_BE_READABLE</a>, <a class="el" href="gsd_8h_source.html#l00078">GSD_ERROR_INVALID_ARGUMENT</a>, <a class="el" href="gsd_8h_source.html#l00075">GSD_ERROR_IO</a>, <a class="el" href="gsd_8c_source.html#l00190">gsd_io_pread_retry()</a>, <a class="el" href="gsd_8h_source.html#l00065">GSD_OPEN_APPEND</a>, <a class="el" href="gsd_8c_source.html#l02177">gsd_sizeof_type()</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, <a class="el" href="gsd_8h_source.html#l00175">gsd_index_entry::location</a>, <a class="el" href="gsd_8h_source.html#l00178">gsd_index_entry::M</a>, <a class="el" href="gsd_8h_source.html#l00172">gsd_index_entry::N</a>, <a class="el" href="gsd_8h_source.html#l00314">gsd_handle::open_flags</a>, and <a class="el" href="gsd_8h_source.html#l00184">gsd_index_entry::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="GSDUtil_8cpp_source.html#l00107">GSDUtil::readChunk()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a2db2e3e8a72948bf413e7f09469ec8a6_cgraph.svg" width="308" height="88"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a2db2e3e8a72948bf413e7f09469ec8a6_icgraph.svg" width="746" height="190"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="ab1d1a8a5f73b37df0c706f41df3bdd69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab1d1a8a5f73b37df0c706f41df3bdd69">&#9670;&nbsp;</a></span>gsd_sizeof_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">size_t gsd_sizeof_type </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118">gsd_type</a>&#160;</td>
          <td class="paramname"><em>type</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Query size of a GSD type ID.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">type</td><td>Type ID to query.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Size of the given type in bytes, or 0 for an unknown type ID. </dd></dl>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l02177">2177</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    {</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    <span class="keywordtype">size_t</span> val = 0;</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structgsd__index__entry.html#aebddbeda0dacc7125308440c46b9230a">type</a> == <a class="code" href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118addc1aa49964e9df18eca95586854564e">GSD_TYPE_UINT8</a>)</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;        {</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;        val = <span class="keyword">sizeof</span>(uint8_t);</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;        }</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structgsd__index__entry.html#aebddbeda0dacc7125308440c46b9230a">type</a> == <a class="code" href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118a154cf53ac1f09d58516ee90c5e50ee9b">GSD_TYPE_UINT16</a>)</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;        {</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;        val = <span class="keyword">sizeof</span>(uint16_t);</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;        }</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structgsd__index__entry.html#aebddbeda0dacc7125308440c46b9230a">type</a> == <a class="code" href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118a49225daa33e0c1f26dda21d22a6ffb10">GSD_TYPE_UINT32</a>)</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        {</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;        val = <span class="keyword">sizeof</span>(uint32_t);</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;        }</div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structgsd__index__entry.html#aebddbeda0dacc7125308440c46b9230a">type</a> == <a class="code" href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118a43c1b41755ac12b8611b8478eab5f377">GSD_TYPE_UINT64</a>)</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;        {</div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;        val = <span class="keyword">sizeof</span>(uint64_t);</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;        }</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structgsd__index__entry.html#aebddbeda0dacc7125308440c46b9230a">type</a> == <a class="code" href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118a5d13ce82d25b294b7300ea013396fb45">GSD_TYPE_INT8</a>)</div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;        {</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;        val = <span class="keyword">sizeof</span>(int8_t);</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;        }</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structgsd__index__entry.html#aebddbeda0dacc7125308440c46b9230a">type</a> == <a class="code" href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118a6e5c1ccf3040cebc0dbcf562fd4291cb">GSD_TYPE_INT16</a>)</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;        {</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;        val = <span class="keyword">sizeof</span>(int16_t);</div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;        }</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structgsd__index__entry.html#aebddbeda0dacc7125308440c46b9230a">type</a> == <a class="code" href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118a58aacbcfef4ae23382d8b857cfba815a">GSD_TYPE_INT32</a>)</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;        {</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;        val = <span class="keyword">sizeof</span>(int32_t);</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;        }</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structgsd__index__entry.html#aebddbeda0dacc7125308440c46b9230a">type</a> == <a class="code" href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118a25b4572782ed785491f8b5b666692212">GSD_TYPE_INT64</a>)</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;        {</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;        val = <span class="keyword">sizeof</span>(int64_t);</div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;        }</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structgsd__index__entry.html#aebddbeda0dacc7125308440c46b9230a">type</a> == <a class="code" href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118a8f2fc103d16a251246a102c5477fc0be">GSD_TYPE_FLOAT</a>)</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;        {</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;        val = <span class="keyword">sizeof</span>(float);</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;        }</div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="structgsd__index__entry.html#aebddbeda0dacc7125308440c46b9230a">type</a> == <a class="code" href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118a2bf7336e70f8d15921952b6ec177d238">GSD_TYPE_DOUBLE</a>)</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;        {</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;        val = <span class="keyword">sizeof</span>(double);</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;        }</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;        {</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;        }</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    <span class="keywordflow">return</span> val;</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00052">GSD_TYPE_DOUBLE</a>, <a class="el" href="gsd_8h_source.html#l00049">GSD_TYPE_FLOAT</a>, <a class="el" href="gsd_8h_source.html#l00040">GSD_TYPE_INT16</a>, <a class="el" href="gsd_8h_source.html#l00043">GSD_TYPE_INT32</a>, <a class="el" href="gsd_8h_source.html#l00046">GSD_TYPE_INT64</a>, <a class="el" href="gsd_8h_source.html#l00037">GSD_TYPE_INT8</a>, <a class="el" href="gsd_8h_source.html#l00028">GSD_TYPE_UINT16</a>, <a class="el" href="gsd_8h_source.html#l00031">GSD_TYPE_UINT32</a>, <a class="el" href="gsd_8h_source.html#l00034">GSD_TYPE_UINT64</a>, <a class="el" href="gsd_8h_source.html#l00025">GSD_TYPE_UINT8</a>, and <a class="el" href="gsd_8h_source.html#l00184">gsd_index_entry::type</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l00417">gsd_is_entry_valid()</a>, <a class="el" href="gsd_8c_source.html#l02133">gsd_read_chunk()</a>, <a class="el" href="gsd_8c_source.html#l01916">gsd_write_chunk()</a>, and <a class="el" href="GSDUtil_8cpp_source.html#l00107">GSDUtil::readChunk()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_ab1d1a8a5f73b37df0c706f41df3bdd69_icgraph.svg" width="1163" height="544"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="a081b6fad5e27f4f8cfabd0030af7ebf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a081b6fad5e27f4f8cfabd0030af7ebf5">&#9670;&nbsp;</a></span>gsd_find_matching_chunk_name()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* gsd_find_matching_chunk_name </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *&#160;</td>
          <td class="paramname"><em>handle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>match</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>prev</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Search for chunk names in a gsd file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>Handle to an open GSD file. </td></tr>
    <tr><td class="paramname">match</td><td>String to match. </td></tr>
    <tr><td class="paramname">prev</td><td>Search starting point.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><em>handle</em> was opened by <a class="el" href="gsd_8h.html#ae0add799755285c1108a7b97b2ed7e00">gsd_open()</a> </dd>
<dd>
<em>prev</em> was returned by a previous call to <a class="el" href="gsd_8h.html#a081b6fad5e27f4f8cfabd0030af7ebf5">gsd_find_matching_chunk_name()</a></dd></dl>
<p>To find the first matching chunk name, pass NULL for prev. Pass in the previous found string to find the next after that, and so on. Chunk names match if they begin with the string in match*. Chunk names returned by this function may be present in at least one frame.</p>
<dl class="section return"><dt>Returns</dt><dd>Pointer to a string, NULL if no more matching chunks are found found, or NULL if prev* is invalid </dd></dl>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l02228">2228</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    {</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;    <span class="keywordflow">if</span> (handle == NULL)</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;        {</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;        }</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    <span class="keywordflow">if</span> (match == NULL)</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;        {</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;        }</div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#aee7f806d610d9c4b8e0f045024d4e1f6">n_names</a> == 0)</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;        {</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;        }</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160; </div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;    <span class="comment">// return nothing found if the name buffer is corrupt</span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a>[handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a> - 1] != 0)</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;        {</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;        }</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160; </div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;    <span class="comment">// determine search start index</span></div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* search_str;</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    <span class="keywordflow">if</span> (prev == NULL)</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;        {</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;        search_str = handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a>;</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;        }</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;        {</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;        <span class="comment">// return not found if prev is not in range</span></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;        <span class="keywordflow">if</span> (prev &lt; handle-&gt;file_names.data.data)</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;            {</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;            }</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;        <span class="keywordflow">if</span> (prev &gt;= (handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a> + handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a>))</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;            {</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;            }</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160; </div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;        <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a5e2e07be01bcfa15c0834d6859878171">gsd_version</a> &lt; <a class="code" href="gsd_8c.html#a493ef951956c9f98adff89a80ddb3fa6">gsd_make_version</a>(2, 0))</div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;            {</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;            search_str = prev + <a class="code" href="gsd_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2dab1e8211d5344adb743238d82d369331d">GSD_NAME_SIZE</a>;</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;            }</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;            {</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;            search_str = prev + strlen(prev) + 1;</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;            }</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;        }</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160; </div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;    <span class="keywordtype">size_t</span> match_len = strlen(match);</div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160; </div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;    <span class="keywordflow">while</span> (search_str &lt; (handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">data</a> + handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a>))</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;        {</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;        <span class="keywordflow">if</span> (search_str[0] != 0 &amp;&amp; 0 == strncmp(match, search_str, match_len))</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;            {</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;            <span class="keywordflow">return</span> search_str;</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;            }</div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160; </div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;        <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a5e2e07be01bcfa15c0834d6859878171">gsd_version</a> &lt; <a class="code" href="gsd_8c.html#a493ef951956c9f98adff89a80ddb3fa6">gsd_make_version</a>(2, 0))</div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;            {</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;            search_str += <a class="code" href="gsd_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2dab1e8211d5344adb743238d82d369331d">GSD_NAME_SIZE</a>;</div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;            }</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;            {</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;            search_str += strlen(search_str) + 1;</div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;            }</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;        }</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160; </div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;    <span class="comment">// searched past the end of the list, return NULL</span></div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00249">gsd_byte_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00266">gsd_name_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00302">gsd_handle::file_names</a>, <a class="el" href="gsd_8c_source.html#l01563">gsd_make_version()</a>, <a class="el" href="gsd_8h_source.html#l00111">GSD_NAME_SIZE</a>, <a class="el" href="gsd_8h_source.html#l00148">gsd_header::gsd_version</a>, <a class="el" href="gsd_8h_source.html#l00287">gsd_handle::header</a>, <a class="el" href="gsd_8h_source.html#l00269">gsd_name_buffer::n_names</a>, and <a class="el" href="gsd_8h_source.html#l00255">gsd_byte_buffer::reserved</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l02300">gsd_upgrade()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a081b6fad5e27f4f8cfabd0030af7ebf5_cgraph.svg" width="402" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_a081b6fad5e27f4f8cfabd0030af7ebf5_icgraph.svg" width="367" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<a id="adb92d5142812c19bf4ee33cbde439131"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb92d5142812c19bf4ee33cbde439131">&#9670;&nbsp;</a></span>gsd_upgrade()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int gsd_upgrade </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structgsd__handle.html">gsd_handle</a> *&#160;</td>
          <td class="paramname"><em>handle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Upgrade a GSD file to the latest specification.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">handle</td><td>Handle to an open GSD file</td></tr>
  </table>
  </dd>
</dl>
<dl class="section pre"><dt>Precondition</dt><dd><em>handle</em> was opened by <a class="el" href="gsd_8h.html#ae0add799755285c1108a7b97b2ed7e00">gsd_open()</a> with a writable mode. </dd>
<dd>
There are no pending data to write to the file in <a class="el" href="gsd_8h.html#aa03810337c5eebcbe716d8633eaefc5e">gsd_end_frame()</a></dd></dl>
<dl class="section return"><dt>Returns</dt><dd><ul>
<li>GSD_SUCCESS (0) on success. Negative value on failure:</li>
<li>GSD_ERROR_IO: IO error (check errno).</li>
<li>GSD_ERROR_INVALID_ARGUMENT: <em>handle</em> is NULL</li>
<li>GSD_ERROR_FILE_MUST_BE_WRITABLE: The file was opened in read-only mode. </li>
</ul>
</dd></dl>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l02300">2300</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>
<div class="fragment"><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;    {</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;    <span class="keywordflow">if</span> (handle == NULL)</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;        {</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;        }</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a37ddf6d53fc8c4f3eff247508fcc814b">open_flags</a> == <a class="code" href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a22f5dee98250b8ead7d43cc1a347f205">GSD_OPEN_READONLY</a>)</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;        {</div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;        }</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a9086141add0c7be99bcfed3bfd6dadac">frame_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> &gt; 0 || handle-&gt;<a class="code" href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">frame_names</a>.<a class="code" href="structgsd__name__buffer.html#aee7f806d610d9c4b8e0f045024d4e1f6">n_names</a> &gt; 0)</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;        {</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a>;</div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;        }</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160; </div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;    <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a5e2e07be01bcfa15c0834d6859878171">gsd_version</a> &lt; <a class="code" href="gsd_8c.html#a493ef951956c9f98adff89a80ddb3fa6">gsd_make_version</a>(2, 0))</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;        {</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;        <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a> &gt; 0)</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;            {</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;            <span class="comment">// make a copy of the file index</span></div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;            <span class="keyword">struct </span><a class="code" href="structgsd__index__buffer.html">gsd_index_buffer</a> buf;</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;            <a class="code" href="gsd_8c.html#a9b05d58560daee2512f03bedf7b2926d">gsd_util_zero_memory</a>(&amp;buf, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__index__buffer.html">gsd_index_buffer</a>));</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;            <span class="keywordtype">int</span> retval = <a class="code" href="gsd_8c.html#ae1948c93f77d642c4e3797fe7e5f2095">gsd_index_buffer_allocate</a>(&amp;buf, handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a>);</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;            <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;                {</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;                <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;                }</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;            memcpy(buf.data,</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;                   handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">data</a>,</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;                   <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__index__entry.html">gsd_index_entry</a>) * handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a>);</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;            buf.size = handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>.<a class="code" href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">size</a>;</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160; </div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;            <span class="comment">// sort the copy and write it back out to the file</span></div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;            retval = <a class="code" href="gsd_8c.html#a6c20ccb47eed1a3ea9995a47a8eebdbd">gsd_index_buffer_sort</a>(&amp;buf);</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;            <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;                {</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;                <a class="code" href="gsd_8c.html#a9e12a38df69cf73fa771b005748cb3e5">gsd_index_buffer_free</a>(&amp;buf);</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;                <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;                }</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160; </div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;            ssize_t bytes_written = <a class="code" href="gsd_8c.html#a3fb7746d93a1c856ca7ef64fa3548cbe">gsd_io_pwrite_retry</a>(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>,</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;                                                        buf.data,</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;                                                        <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__index__entry.html">gsd_index_entry</a>) * buf.size,</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;                                                        handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a89d5af9234f456010e16116452064b78">index_location</a>);</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160; </div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;            <span class="keywordflow">if</span> (bytes_written == -1 || bytes_written != <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__index__entry.html">gsd_index_entry</a>) * buf.size)</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;                {</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;                <a class="code" href="gsd_8c.html#a9e12a38df69cf73fa771b005748cb3e5">gsd_index_buffer_free</a>(&amp;buf);</div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;                }</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160; </div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;            retval = <a class="code" href="gsd_8c.html#a9e12a38df69cf73fa771b005748cb3e5">gsd_index_buffer_free</a>(&amp;buf);</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;            <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;                {</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;                <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;                }</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160; </div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;            <span class="comment">// sync the updated index</span></div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;            retval = fsync(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>);</div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;            <span class="keywordflow">if</span> (retval != 0)</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;                {</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;                }</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;            }</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160; </div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;        <span class="keywordflow">if</span> (handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#aee7f806d610d9c4b8e0f045024d4e1f6">n_names</a> &gt; 0)</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;            {</div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;            <span class="comment">// compact the name list without changing its size or position on the disk</span></div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;            <span class="keyword">struct </span><a class="code" href="structgsd__byte__buffer.html">gsd_byte_buffer</a> new_name_buf;</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;            <a class="code" href="gsd_8c.html#a9b05d58560daee2512f03bedf7b2926d">gsd_util_zero_memory</a>(&amp;new_name_buf, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__byte__buffer.html">gsd_byte_buffer</a>));</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;            <span class="keywordtype">int</span> retval = <a class="code" href="gsd_8c.html#aeaf487909ab334303fa478cf4a126d6f">gsd_byte_buffer_allocate</a>(&amp;new_name_buf, handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a>);</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;            <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;                {</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;                <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;                }</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160; </div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">char</span>* name = <a class="code" href="gsd_8c.html#a081b6fad5e27f4f8cfabd0030af7ebf5">gsd_find_matching_chunk_name</a>(handle, <span class="stringliteral">&quot;&quot;</span>, NULL);</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;            <span class="keywordflow">while</span> (name != NULL)</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;                {</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;                retval = <a class="code" href="gsd_8c.html#a7a717f9dafe011e68434e181c76253af">gsd_byte_buffer_append</a>(&amp;new_name_buf, name, strlen(name) + 1);</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;                <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;                    {</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;                    <a class="code" href="gsd_8c.html#ae50726c30c5bf629b6af1ef88020302f">gsd_byte_buffer_free</a>(&amp;new_name_buf);</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;                    <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;                    }</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;                name = <a class="code" href="gsd_8c.html#a081b6fad5e27f4f8cfabd0030af7ebf5">gsd_find_matching_chunk_name</a>(handle, <span class="stringliteral">&quot;&quot;</span>, name);</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;                }</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160; </div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;            <span class="keywordflow">if</span> (new_name_buf.reserved != handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>.<a class="code" href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">reserved</a>)</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;                {</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;                <a class="code" href="gsd_8c.html#ae50726c30c5bf629b6af1ef88020302f">gsd_byte_buffer_free</a>(&amp;new_name_buf);</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba4236f6900d8a81a3a4ccafa2170ad27c">GSD_ERROR_FILE_CORRUPT</a>;</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;                }</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160; </div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;            <span class="comment">// write the new names out to disk</span></div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;            ssize_t bytes_written = <a class="code" href="gsd_8c.html#a3fb7746d93a1c856ca7ef64fa3548cbe">gsd_io_pwrite_retry</a>(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>,</div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;                                                        new_name_buf.data,</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;                                                        new_name_buf.reserved,</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;                                                        handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a0d69a5886105e2e4cf210406c77f35f0">namelist_location</a>);</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160; </div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;            <span class="keywordflow">if</span> (bytes_written == -1 || bytes_written != new_name_buf.reserved)</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;                {</div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;                <a class="code" href="gsd_8c.html#ae50726c30c5bf629b6af1ef88020302f">gsd_byte_buffer_free</a>(&amp;new_name_buf);</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;                }</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160; </div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;            <span class="comment">// swap in the re-organized name buffer</span></div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;            retval = <a class="code" href="gsd_8c.html#ae50726c30c5bf629b6af1ef88020302f">gsd_byte_buffer_free</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a>);</div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;            <span class="keywordflow">if</span> (retval != <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>)</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;                {</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;                <a class="code" href="gsd_8c.html#ae50726c30c5bf629b6af1ef88020302f">gsd_byte_buffer_free</a>(&amp;new_name_buf);</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;                <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;                }</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;            handle-&gt;<a class="code" href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">file_names</a>.<a class="code" href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">data</a> = new_name_buf;</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160; </div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;            <span class="comment">// sync the updated name list</span></div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;            retval = fsync(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>);</div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;            <span class="keywordflow">if</span> (retval != 0)</div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;                {</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;                <a class="code" href="gsd_8c.html#ae50726c30c5bf629b6af1ef88020302f">gsd_byte_buffer_free</a>(&amp;new_name_buf);</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;                }</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;            }</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160; </div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;        <span class="comment">// label the file as a v2.0 file</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;        handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>.<a class="code" href="structgsd__header.html#a5e2e07be01bcfa15c0834d6859878171">gsd_version</a> = <a class="code" href="gsd_8c.html#a493ef951956c9f98adff89a80ddb3fa6">gsd_make_version</a>(<a class="code" href="gsd_8c.html#a726ca809ffd3d67ab4b8476646f26635a9e41ab940950d400d353438f87a6f559">GSD_CURRENT_FILE_VERSION</a>, 0);</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160; </div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;        <span class="comment">// write the new header out</span></div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;        ssize_t bytes_written</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;            = <a class="code" href="gsd_8c.html#a3fb7746d93a1c856ca7ef64fa3548cbe">gsd_io_pwrite_retry</a>(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>, &amp;(handle-&gt;<a class="code" href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">header</a>), <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__header.html">gsd_header</a>), 0);</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;        <span class="keywordflow">if</span> (bytes_written != <span class="keyword">sizeof</span>(<span class="keyword">struct</span> <a class="code" href="structgsd__header.html">gsd_header</a>))</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;            {</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;            }</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160; </div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;        <span class="comment">// sync the updated header</span></div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;        <span class="keywordtype">int</span> retval = fsync(handle-&gt;<a class="code" href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">fd</a>);</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;        <span class="keywordflow">if</span> (retval != 0)</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;            {</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a>;</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;            }</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160; </div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;        <span class="comment">// remap the file index</span></div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;        retval = <a class="code" href="gsd_8c.html#a9e12a38df69cf73fa771b005748cb3e5">gsd_index_buffer_free</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>);</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;        <span class="keywordflow">if</span> (retval != 0)</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;            {</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;            }</div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160; </div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;        retval = <a class="code" href="gsd_8c.html#a6fe75caf6c4df550af2455a0c40bfbdf">gsd_index_buffer_map</a>(&amp;handle-&gt;<a class="code" href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">file_index</a>, handle);</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;        <span class="keywordflow">if</span> (retval != 0)</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;            {</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;            <span class="keywordflow">return</span> retval;</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;            }</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;        }</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160; </div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a>;</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="gsd_8h_source.html#l00226">gsd_index_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00249">gsd_byte_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00266">gsd_name_buffer::data</a>, <a class="el" href="gsd_8h_source.html#l00284">gsd_handle::fd</a>, <a class="el" href="gsd_8h_source.html#l00290">gsd_handle::file_index</a>, <a class="el" href="gsd_8h_source.html#l00302">gsd_handle::file_names</a>, <a class="el" href="gsd_8h_source.html#l00293">gsd_handle::frame_index</a>, <a class="el" href="gsd_8h_source.html#l00305">gsd_handle::frame_names</a>, <a class="el" href="gsd_8c_source.html#l00463">gsd_byte_buffer_allocate()</a>, <a class="el" href="gsd_8c_source.html#l00491">gsd_byte_buffer_append()</a>, <a class="el" href="gsd_8c_source.html#l00535">gsd_byte_buffer_free()</a>, <a class="el" href="gsd_8c_source.html#l00081">GSD_CURRENT_FILE_VERSION</a>, <a class="el" href="gsd_8h_source.html#l00087">GSD_ERROR_FILE_CORRUPT</a>, <a class="el" href="gsd_8h_source.html#l00078">GSD_ERROR_INVALID_ARGUMENT</a>, <a class="el" href="gsd_8h_source.html#l00075">GSD_ERROR_IO</a>, <a class="el" href="gsd_8c_source.html#l02228">gsd_find_matching_chunk_name()</a>, <a class="el" href="gsd_8c_source.html#l00558">gsd_index_buffer_allocate()</a>, <a class="el" href="gsd_8c_source.html#l00706">gsd_index_buffer_free()</a>, <a class="el" href="gsd_8c_source.html#l00593">gsd_index_buffer_map()</a>, <a class="el" href="gsd_8c_source.html#l00899">gsd_index_buffer_sort()</a>, <a class="el" href="gsd_8c_source.html#l00148">gsd_io_pwrite_retry()</a>, <a class="el" href="gsd_8c_source.html#l01563">gsd_make_version()</a>, <a class="el" href="gsd_8h_source.html#l00062">GSD_OPEN_READONLY</a>, <a class="el" href="gsd_8h_source.html#l00072">GSD_SUCCESS</a>, <a class="el" href="gsd_8c_source.html#l00130">gsd_util_zero_memory()</a>, <a class="el" href="gsd_8h_source.html#l00148">gsd_header::gsd_version</a>, <a class="el" href="gsd_8h_source.html#l00287">gsd_handle::header</a>, <a class="el" href="gsd_8h_source.html#l00133">gsd_header::index_location</a>, <a class="el" href="gsd_8h_source.html#l00269">gsd_name_buffer::n_names</a>, <a class="el" href="gsd_8h_source.html#l00139">gsd_header::namelist_location</a>, <a class="el" href="gsd_8h_source.html#l00314">gsd_handle::open_flags</a>, <a class="el" href="gsd_8h_source.html#l00255">gsd_byte_buffer::reserved</a>, and <a class="el" href="gsd_8h_source.html#l00229">gsd_index_buffer::size</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="gsd_8c_adb92d5142812c19bf4ee33cbde439131_cgraph.svg" width="980" height="658"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="acf7c38e3e5534e06ba18607f11c1e00e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf7c38e3e5534e06ba18607f11c1e00e">&#9670;&nbsp;</a></span>GSD_MAGIC_ID</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const uint64_t GSD_MAGIC_ID = 0x65DF65DF65DF65DF</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Magic value identifying a GSD file. </p>

<p class="definition">Definition at line <a class="el" href="gsd_8c_source.html#l00040">40</a> of file <a class="el" href="gsd_8c_source.html">gsd.c</a>.</p>

<p class="reference">Referenced by <a class="el" href="gsd_8c_source.html#l01322">gsd_initialize_file()</a>, and <a class="el" href="gsd_8c_source.html#l01401">gsd_initialize_handle()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="astructgsd__index__buffer_html_a51a1e266f6d7d1aafdfd54822fc226b1"><div class="ttname"><a href="structgsd__index__buffer.html#a51a1e266f6d7d1aafdfd54822fc226b1">gsd_index_buffer::reserved</a></div><div class="ttdeci">size_t reserved</div><div class="ttdoc">Number of entries available in the buffer.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00232">gsd.h:232</a></div></div>
<div class="ttc" id="astructgsd__handle_html_ac35aad0eef4a5844ecc4141041fa9243"><div class="ttname"><a href="structgsd__handle.html#ac35aad0eef4a5844ecc4141041fa9243">gsd_handle::file_size</a></div><div class="ttdeci">int64_t file_size</div><div class="ttdoc">Size of the file (in bytes)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00311">gsd.h:311</a></div></div>
<div class="ttc" id="agsd_8c_html_a9e12a38df69cf73fa771b005748cb3e5"><div class="ttname"><a href="gsd_8c.html#a9e12a38df69cf73fa771b005748cb3e5">gsd_index_buffer_free</a></div><div class="ttdeci">static int gsd_index_buffer_free(struct gsd_index_buffer *buf)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00706">gsd.c:706</a></div></div>
<div class="ttc" id="agsd_8h_html_a03a578779769ed7e288df22c6a75f07ba84a9d0b912c0f9dd4ef7eda53560253b"><div class="ttname"><a href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba84a9d0b912c0f9dd4ef7eda53560253b">GSD_ERROR_NOT_A_GSD_FILE</a></div><div class="ttdeci">@ GSD_ERROR_NOT_A_GSD_FILE</div><div class="ttdoc">The file is not a GSD file.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00081">gsd.h:81</a></div></div>
<div class="ttc" id="astructgsd__index__buffer_html"><div class="ttname"><a href="structgsd__index__buffer.html">gsd_index_buffer</a></div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00223">gsd.h:223</a></div></div>
<div class="ttc" id="astructgsd__handle_html"><div class="ttname"><a href="structgsd__handle.html">gsd_handle</a></div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00281">gsd.h:281</a></div></div>
<div class="ttc" id="astructgsd__byte__buffer_html_a3630961b7d45df2885cdd887e4b83b60"><div class="ttname"><a href="structgsd__byte__buffer.html#a3630961b7d45df2885cdd887e4b83b60">gsd_byte_buffer::size</a></div><div class="ttdeci">size_t size</div><div class="ttdoc">Number of bytes in the buffer.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00252">gsd.h:252</a></div></div>
<div class="ttc" id="agsd_8h_html_a5813a2a637516567a2b42dc745ec1118a58aacbcfef4ae23382d8b857cfba815a"><div class="ttname"><a href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118a58aacbcfef4ae23382d8b857cfba815a">GSD_TYPE_INT32</a></div><div class="ttdeci">@ GSD_TYPE_INT32</div><div class="ttdoc">Signed 32-bit integer.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00043">gsd.h:43</a></div></div>
<div class="ttc" id="astructgsd__index__buffer_html_a42b83ab7239cc24da11719b8d0354e37"><div class="ttname"><a href="structgsd__index__buffer.html#a42b83ab7239cc24da11719b8d0354e37">gsd_index_buffer::size</a></div><div class="ttdeci">size_t size</div><div class="ttdoc">Number of entries in the buffer.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00229">gsd.h:229</a></div></div>
<div class="ttc" id="astructgsd__header_html_ad23681ad38d32167197a22e75a2605b1"><div class="ttname"><a href="structgsd__header.html#ad23681ad38d32167197a22e75a2605b1">gsd_header::application</a></div><div class="ttdeci">char application[GSD_NAME_SIZE]</div><div class="ttdoc">Name of the application that generated this file.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00151">gsd.h:151</a></div></div>
<div class="ttc" id="agsd_8c_html_aebfeb70fcbc089409a7179af7d814554"><div class="ttname"><a href="gsd_8c.html#aebfeb70fcbc089409a7179af7d814554">gsd_name_id_map_allocate</a></div><div class="ttdeci">static int gsd_name_id_map_allocate(struct gsd_name_id_map *map, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00232">gsd.c:232</a></div></div>
<div class="ttc" id="astructgsd__name__id__map_html_a3019ca67584d12f957fcf694c3ea6ca0"><div class="ttname"><a href="structgsd__name__id__map.html#a3019ca67584d12f957fcf694c3ea6ca0">gsd_name_id_map::size</a></div><div class="ttdeci">size_t size</div><div class="ttdoc">Number of entries in the mapping.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00216">gsd.h:216</a></div></div>
<div class="ttc" id="agsd_8h_html_a5813a2a637516567a2b42dc745ec1118a49225daa33e0c1f26dda21d22a6ffb10"><div class="ttname"><a href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118a49225daa33e0c1f26dda21d22a6ffb10">GSD_TYPE_UINT32</a></div><div class="ttdeci">@ GSD_TYPE_UINT32</div><div class="ttdoc">Unsigned 32-bit integer.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00031">gsd.h:31</a></div></div>
<div class="ttc" id="astructgsd__handle_html_a38e4bf4d587e525904d615ce49352592"><div class="ttname"><a href="structgsd__handle.html#a38e4bf4d587e525904d615ce49352592">gsd_handle::fd</a></div><div class="ttdeci">int fd</div><div class="ttdoc">File descriptor.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00284">gsd.h:284</a></div></div>
<div class="ttc" id="agsd_8c_html_a258b64725f90f60d969752d65fba9850"><div class="ttname"><a href="gsd_8c.html#a258b64725f90f60d969752d65fba9850">gsd_index_buffer_add</a></div><div class="ttdeci">static int gsd_index_buffer_add(struct gsd_index_buffer *buf, struct gsd_index_entry **entry)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00744">gsd.c:744</a></div></div>
<div class="ttc" id="astructgsd__index__entry_html_ae913d46842b10fe8b5b74da3a7075726"><div class="ttname"><a href="structgsd__index__entry.html#ae913d46842b10fe8b5b74da3a7075726">gsd_index_entry::N</a></div><div class="ttdeci">uint64_t N</div><div class="ttdoc">Number of rows in the chunk.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00172">gsd.h:172</a></div></div>
<div class="ttc" id="astructgsd__name__buffer_html_aee7f806d610d9c4b8e0f045024d4e1f6"><div class="ttname"><a href="structgsd__name__buffer.html#aee7f806d610d9c4b8e0f045024d4e1f6">gsd_name_buffer::n_names</a></div><div class="ttdeci">size_t n_names</div><div class="ttdoc">Number of names in the list.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00269">gsd.h:269</a></div></div>
<div class="ttc" id="astructgsd__handle_html_a144dc0976a1fe2f895423495689daea5"><div class="ttname"><a href="structgsd__handle.html#a144dc0976a1fe2f895423495689daea5">gsd_handle::cur_frame</a></div><div class="ttdeci">uint64_t cur_frame</div><div class="ttdoc">The index of the last frame in the file.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00308">gsd.h:308</a></div></div>
<div class="ttc" id="astructgsd__index__entry_html_a70e15b9094a3a22954bba035496d83bf"><div class="ttname"><a href="structgsd__index__entry.html#a70e15b9094a3a22954bba035496d83bf">gsd_index_entry::location</a></div><div class="ttdeci">int64_t location</div><div class="ttdoc">Location of the chunk in the file.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00175">gsd.h:175</a></div></div>
<div class="ttc" id="astructgsd__handle_html_a6b5215cbf0bdf8172f66166ef4fda7a8"><div class="ttname"><a href="structgsd__handle.html#a6b5215cbf0bdf8172f66166ef4fda7a8">gsd_handle::file_index</a></div><div class="ttdeci">struct gsd_index_buffer file_index</div><div class="ttdoc">Mapped data chunk index.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00290">gsd.h:290</a></div></div>
<div class="ttc" id="agsd_8c_html_ab5d19295bedec41b7919caec2cb22759"><div class="ttname"><a href="gsd_8c.html#ab5d19295bedec41b7919caec2cb22759">gsd_is_entry_valid</a></div><div class="ttdeci">static int gsd_is_entry_valid(struct gsd_handle *handle, size_t idx)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00417">gsd.c:417</a></div></div>
<div class="ttc" id="astructgsd__handle_html_a37ddf6d53fc8c4f3eff247508fcc814b"><div class="ttname"><a href="structgsd__handle.html#a37ddf6d53fc8c4f3eff247508fcc814b">gsd_handle::open_flags</a></div><div class="ttdeci">enum gsd_open_flag open_flags</div><div class="ttdoc">Flags passed to gsd_open() when opening this handle.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00314">gsd.h:314</a></div></div>
<div class="ttc" id="agsd_8h_html_a23a9970f53fda4e8902697670300ec98a22f5dee98250b8ead7d43cc1a347f205"><div class="ttname"><a href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a22f5dee98250b8ead7d43cc1a347f205">GSD_OPEN_READONLY</a></div><div class="ttdeci">@ GSD_OPEN_READONLY</div><div class="ttdoc">Open only for reading.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00062">gsd.h:62</a></div></div>
<div class="ttc" id="agsd_8c_html_a987a1d460f7ca33476fc57bcc1ff8439"><div class="ttname"><a href="gsd_8c.html#a987a1d460f7ca33476fc57bcc1ff8439">gsd_heap_swap</a></div><div class="ttdeci">static void gsd_heap_swap(struct gsd_index_buffer *buf, size_t a, size_t b)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00834">gsd.c:834</a></div></div>
<div class="ttc" id="agsd_8h_html_a0411cd49bb5b71852cecd93bcbf0ca2dab1e8211d5344adb743238d82d369331d"><div class="ttname"><a href="gsd_8h.html#a0411cd49bb5b71852cecd93bcbf0ca2dab1e8211d5344adb743238d82d369331d">GSD_NAME_SIZE</a></div><div class="ttdeci">@ GSD_NAME_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00111">gsd.h:111</a></div></div>
<div class="ttc" id="agsd_8c_html_acb769baf09c31a5ad6cba95bd348c194"><div class="ttname"><a href="gsd_8c.html#acb769baf09c31a5ad6cba95bd348c194">gsd_initialize_file</a></div><div class="ttdeci">static int gsd_initialize_file(int fd, const char *application, const char *schema, uint32_t schema_version)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l01322">gsd.c:1322</a></div></div>
<div class="ttc" id="astructgsd__handle_html_a501968a30f0b06f4b7cb69c115648627"><div class="ttname"><a href="structgsd__handle.html#a501968a30f0b06f4b7cb69c115648627">gsd_handle::buffer_index</a></div><div class="ttdeci">struct gsd_index_buffer buffer_index</div><div class="ttdoc">Buffered index entries to append to the current frame.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00296">gsd.h:296</a></div></div>
<div class="ttc" id="astructgsd__name__id__map_html_a204ade834899e92a218b23e211ce3ba9"><div class="ttname"><a href="structgsd__name__id__map.html#a204ade834899e92a218b23e211ce3ba9">gsd_name_id_map::v</a></div><div class="ttdeci">struct gsd_name_id_pair * v</div><div class="ttdoc">Name/id mappings.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00213">gsd.h:213</a></div></div>
<div class="ttc" id="astructgsd__header_html_a89d5af9234f456010e16116452064b78"><div class="ttname"><a href="structgsd__header.html#a89d5af9234f456010e16116452064b78">gsd_header::index_location</a></div><div class="ttdeci">uint64_t index_location</div><div class="ttdoc">Location of the chunk index in the file.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00133">gsd.h:133</a></div></div>
<div class="ttc" id="agsd_8h_html_a5813a2a637516567a2b42dc745ec1118a6e5c1ccf3040cebc0dbcf562fd4291cb"><div class="ttname"><a href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118a6e5c1ccf3040cebc0dbcf562fd4291cb">GSD_TYPE_INT16</a></div><div class="ttdeci">@ GSD_TYPE_INT16</div><div class="ttdoc">Signed 16-bit integer.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00040">gsd.h:40</a></div></div>
<div class="ttc" id="agsd_8c_html_a6d8087323ec29c58d907b9462b4a31da"><div class="ttname"><a href="gsd_8c.html#a6d8087323ec29c58d907b9462b4a31da">gsd_hash_str</a></div><div class="ttdeci">static unsigned long gsd_hash_str(const unsigned char *str)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00296">gsd.c:296</a></div></div>
<div class="ttc" id="astructgsd__header_html_a5e2e07be01bcfa15c0834d6859878171"><div class="ttname"><a href="structgsd__header.html#a5e2e07be01bcfa15c0834d6859878171">gsd_header::gsd_version</a></div><div class="ttdeci">uint32_t gsd_version</div><div class="ttdoc">GSD file format version from gsd_make_version().</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00148">gsd.h:148</a></div></div>
<div class="ttc" id="agsd_8c_html_a081b6fad5e27f4f8cfabd0030af7ebf5"><div class="ttname"><a href="gsd_8c.html#a081b6fad5e27f4f8cfabd0030af7ebf5">gsd_find_matching_chunk_name</a></div><div class="ttdeci">const char * gsd_find_matching_chunk_name(struct gsd_handle *handle, const char *match, const char *prev)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l02228">gsd.c:2228</a></div></div>
<div class="ttc" id="agsd_8c_html_ac159dfbfd790607f85073ad2d8464a8b"><div class="ttname"><a href="gsd_8c.html#ac159dfbfd790607f85073ad2d8464a8b">gsd_initialize_handle</a></div><div class="ttdeci">static int gsd_initialize_handle(struct gsd_handle *handle)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l01401">gsd.c:1401</a></div></div>
<div class="ttc" id="astructgsd__index__buffer_html_a8731f4ca2105be1c3efc1d0b5d6e8908"><div class="ttname"><a href="structgsd__index__buffer.html#a8731f4ca2105be1c3efc1d0b5d6e8908">gsd_index_buffer::data</a></div><div class="ttdeci">struct gsd_index_entry * data</div><div class="ttdoc">Indices in the buffer.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00226">gsd.h:226</a></div></div>
<div class="ttc" id="agsd_8h_html_a23a9970f53fda4e8902697670300ec98a0f98b5182423243f10f362ddfb6d7d61"><div class="ttname"><a href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a0f98b5182423243f10f362ddfb6d7d61">GSD_OPEN_READWRITE</a></div><div class="ttdeci">@ GSD_OPEN_READWRITE</div><div class="ttdoc">Open for both reading and writing.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00059">gsd.h:59</a></div></div>
<div class="ttc" id="agsd_8c_html_a0de3f89cdd57571b57401c91feef2f66"><div class="ttname"><a href="gsd_8c.html#a0de3f89cdd57571b57401c91feef2f66">gsd_heapify</a></div><div class="ttdeci">static void gsd_heapify(struct gsd_index_buffer *buf)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00879">gsd.c:879</a></div></div>
<div class="ttc" id="astructgsd__header_html_a0d69a5886105e2e4cf210406c77f35f0"><div class="ttname"><a href="structgsd__header.html#a0d69a5886105e2e4cf210406c77f35f0">gsd_header::namelist_location</a></div><div class="ttdeci">uint64_t namelist_location</div><div class="ttdoc">Location of the name list in the file.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00139">gsd.h:139</a></div></div>
<div class="ttc" id="agsd_8h_html_a5813a2a637516567a2b42dc745ec1118a43c1b41755ac12b8611b8478eab5f377"><div class="ttname"><a href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118a43c1b41755ac12b8611b8478eab5f377">GSD_TYPE_UINT64</a></div><div class="ttdeci">@ GSD_TYPE_UINT64</div><div class="ttdoc">Unsigned 53-bit integer.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00034">gsd.h:34</a></div></div>
<div class="ttc" id="agsd_8c_html_acf7c38e3e5534e06ba18607f11c1e00e"><div class="ttname"><a href="gsd_8c.html#acf7c38e3e5534e06ba18607f11c1e00e">GSD_MAGIC_ID</a></div><div class="ttdeci">const uint64_t GSD_MAGIC_ID</div><div class="ttdoc">Magic value identifying a GSD file.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00040">gsd.c:40</a></div></div>
<div class="ttc" id="agsd_8c_html_aaec0ae1e441692725a568aee8c8ef627"><div class="ttname"><a href="gsd_8c.html#aaec0ae1e441692725a568aee8c8ef627">gsd_heap_left_child</a></div><div class="ttdeci">static size_t gsd_heap_left_child(size_t i)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00823">gsd.c:823</a></div></div>
<div class="ttc" id="agsd_8c_html_a3fb7746d93a1c856ca7ef64fa3548cbe"><div class="ttname"><a href="gsd_8c.html#a3fb7746d93a1c856ca7ef64fa3548cbe">gsd_io_pwrite_retry</a></div><div class="ttdeci">static ssize_t gsd_io_pwrite_retry(int fd, const void *buf, size_t count, int64_t offset)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00148">gsd.c:148</a></div></div>
<div class="ttc" id="agsd_8c_html_aa1a0a7dcf4015edcadbb47a6451b4a4b"><div class="ttname"><a href="gsd_8c.html#aa1a0a7dcf4015edcadbb47a6451b4a4b">gsd_append_name</a></div><div class="ttdeci">static int gsd_append_name(uint16_t *id, struct gsd_handle *handle, const char *name)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l01264">gsd.c:1264</a></div></div>
<div class="ttc" id="astructgsd__index__entry_html_a1b6c67d9197aa4588964052c2919092e"><div class="ttname"><a href="structgsd__index__entry.html#a1b6c67d9197aa4588964052c2919092e">gsd_index_entry::frame</a></div><div class="ttdeci">uint64_t frame</div><div class="ttdoc">Frame index of the chunk.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00169">gsd.h:169</a></div></div>
<div class="ttc" id="agsd_8c_html_a6fe75caf6c4df550af2455a0c40bfbdf"><div class="ttname"><a href="gsd_8c.html#a6fe75caf6c4df550af2455a0c40bfbdf">gsd_index_buffer_map</a></div><div class="ttdeci">static int gsd_index_buffer_map(struct gsd_index_buffer *buf, struct gsd_handle *handle)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00593">gsd.c:593</a></div></div>
<div class="ttc" id="agsd_8h_html_a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2"><div class="ttname"><a href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa3938911ea417ad6dfa297f203ededc2">GSD_ERROR_INVALID_ARGUMENT</a></div><div class="ttdeci">@ GSD_ERROR_INVALID_ARGUMENT</div><div class="ttdoc">Invalid argument passed to function.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00078">gsd.h:78</a></div></div>
<div class="ttc" id="astructgsd__handle_html_a80988eb386cc7af15aa4c6329e9f6217"><div class="ttname"><a href="structgsd__handle.html#a80988eb386cc7af15aa4c6329e9f6217">gsd_handle::file_names</a></div><div class="ttdeci">struct gsd_name_buffer file_names</div><div class="ttdoc">List of names stored in the file.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00302">gsd.h:302</a></div></div>
<div class="ttc" id="agsd_8c_html_ae6dddb94661e99e54f6c01b1a443e27f"><div class="ttname"><a href="gsd_8c.html#ae6dddb94661e99e54f6c01b1a443e27f">gsd_expand_file_index</a></div><div class="ttdeci">static int gsd_expand_file_index(struct gsd_handle *handle, size_t size_required)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00933">gsd.c:933</a></div></div>
<div class="ttc" id="astructgsd__header_html_a1740d644c468c25cbade9ee0ee1c1a63"><div class="ttname"><a href="structgsd__header.html#a1740d644c468c25cbade9ee0ee1c1a63">gsd_header::schema_version</a></div><div class="ttdeci">uint32_t schema_version</div><div class="ttdoc">Schema version: from gsd_make_version().</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00145">gsd.h:145</a></div></div>
<div class="ttc" id="agsd_8c_html_ae50726c30c5bf629b6af1ef88020302f"><div class="ttname"><a href="gsd_8c.html#ae50726c30c5bf629b6af1ef88020302f">gsd_byte_buffer_free</a></div><div class="ttdeci">static int gsd_byte_buffer_free(struct gsd_byte_buffer *buf)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00535">gsd.c:535</a></div></div>
<div class="ttc" id="agsd_8h_html_a03a578779769ed7e288df22c6a75f07baa5cbc2efac6a7d90f89b616e791eac64"><div class="ttname"><a href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07baa5cbc2efac6a7d90f89b616e791eac64">GSD_ERROR_FILE_MUST_BE_WRITABLE</a></div><div class="ttdeci">@ GSD_ERROR_FILE_MUST_BE_WRITABLE</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00098">gsd.h:98</a></div></div>
<div class="ttc" id="astructgsd__index__entry_html_aebddbeda0dacc7125308440c46b9230a"><div class="ttname"><a href="structgsd__index__entry.html#aebddbeda0dacc7125308440c46b9230a">gsd_index_entry::type</a></div><div class="ttdeci">uint8_t type</div><div class="ttdoc">Data type of the chunk: one of gsd_type.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00184">gsd.h:184</a></div></div>
<div class="ttc" id="astructgsd__index__buffer_html_a3e8c9fe43b2fe61968336cb4a763b980"><div class="ttname"><a href="structgsd__index__buffer.html#a3e8c9fe43b2fe61968336cb4a763b980">gsd_index_buffer::mapped_len</a></div><div class="ttdeci">size_t mapped_len</div><div class="ttdoc">Number of bytes mapped.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00238">gsd.h:238</a></div></div>
<div class="ttc" id="agsd_8c_html_a8249dc854c432e55e8ee07a8d3e8546c"><div class="ttname"><a href="gsd_8c.html#a8249dc854c432e55e8ee07a8d3e8546c">gsd_name_id_map_free</a></div><div class="ttdeci">static int gsd_name_id_map_free(struct gsd_name_id_map *map)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00257">gsd.c:257</a></div></div>
<div class="ttc" id="agsd_8c_html_aeaf487909ab334303fa478cf4a126d6f"><div class="ttname"><a href="gsd_8c.html#aeaf487909ab334303fa478cf4a126d6f">gsd_byte_buffer_allocate</a></div><div class="ttdeci">static int gsd_byte_buffer_allocate(struct gsd_byte_buffer *buf, size_t reserve)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00463">gsd.c:463</a></div></div>
<div class="ttc" id="astructgsd__handle_html_a9086141add0c7be99bcfed3bfd6dadac"><div class="ttname"><a href="structgsd__handle.html#a9086141add0c7be99bcfed3bfd6dadac">gsd_handle::frame_index</a></div><div class="ttdeci">struct gsd_index_buffer frame_index</div><div class="ttdoc">Index entries to append to the current frame.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00293">gsd.h:293</a></div></div>
<div class="ttc" id="agsd_8c_html_a3ffe758eed9a5bae487f514a0a45e97d"><div class="ttname"><a href="gsd_8c.html#a3ffe758eed9a5bae487f514a0a45e97d">gsd_cmp_index_entry</a></div><div class="ttdeci">static int gsd_cmp_index_entry(const struct gsd_index_entry *a, const struct gsd_index_entry *b)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00774">gsd.c:774</a></div></div>
<div class="ttc" id="astructgsd__header_html_a6ad2a01f3c1926eacab74d693ac34bdf"><div class="ttname"><a href="structgsd__header.html#a6ad2a01f3c1926eacab74d693ac34bdf">gsd_header::index_allocated_entries</a></div><div class="ttdeci">uint64_t index_allocated_entries</div><div class="ttdoc">Number of index entries that will fit in the space allocated.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00136">gsd.h:136</a></div></div>
<div class="ttc" id="agsd_8c_html_a493ef951956c9f98adff89a80ddb3fa6"><div class="ttname"><a href="gsd_8c.html#a493ef951956c9f98adff89a80ddb3fa6">gsd_make_version</a></div><div class="ttdeci">uint32_t gsd_make_version(unsigned int major, unsigned int minor)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l01563">gsd.c:1563</a></div></div>
<div class="ttc" id="agsd_8c_html_ab147cf4d77c10fd8085e5023e9afe55f"><div class="ttname"><a href="gsd_8c.html#ab147cf4d77c10fd8085e5023e9afe55f">gsd_flush_name_buffer</a></div><div class="ttdeci">static int gsd_flush_name_buffer(struct gsd_handle *handle)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l01148">gsd.c:1148</a></div></div>
<div class="ttc" id="astructgsd__handle_html_acb6f5e1288792803b529b8549e6dc1ce"><div class="ttname"><a href="structgsd__handle.html#acb6f5e1288792803b529b8549e6dc1ce">gsd_handle::frame_names</a></div><div class="ttdeci">struct gsd_name_buffer frame_names</div><div class="ttdoc">List of names added in the current frame.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00305">gsd.h:305</a></div></div>
<div class="ttc" id="agsd_8h_html_a03a578779769ed7e288df22c6a75f07ba927545200d5ae6b308d536988ff37637"><div class="ttname"><a href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba927545200d5ae6b308d536988ff37637">GSD_ERROR_MEMORY_ALLOCATION_FAILED</a></div><div class="ttdeci">@ GSD_ERROR_MEMORY_ALLOCATION_FAILED</div><div class="ttdoc">GSD failed to allocated memory.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00090">gsd.h:90</a></div></div>
<div class="ttc" id="agsd_8c_html_a9b05d58560daee2512f03bedf7b2926d"><div class="ttname"><a href="gsd_8c.html#a9b05d58560daee2512f03bedf7b2926d">gsd_util_zero_memory</a></div><div class="ttdeci">static void gsd_util_zero_memory(void *d, size_t size_to_zero)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00130">gsd.c:130</a></div></div>
<div class="ttc" id="astructgsd__index__entry_html_acbd3b797c1d179affc5fe279260b40f2"><div class="ttname"><a href="structgsd__index__entry.html#acbd3b797c1d179affc5fe279260b40f2">gsd_index_entry::M</a></div><div class="ttdeci">uint32_t M</div><div class="ttdoc">Number of columns in the chunk.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00178">gsd.h:178</a></div></div>
<div class="ttc" id="agsd_8h_html_a5813a2a637516567a2b42dc745ec1118a5d13ce82d25b294b7300ea013396fb45"><div class="ttname"><a href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118a5d13ce82d25b294b7300ea013396fb45">GSD_TYPE_INT8</a></div><div class="ttdeci">@ GSD_TYPE_INT8</div><div class="ttdoc">Signed 8-bit integer.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00037">gsd.h:37</a></div></div>
<div class="ttc" id="agsd_8c_html_a31b9400272036b121040e9fc0a9e626b"><div class="ttname"><a href="gsd_8c.html#a31b9400272036b121040e9fc0a9e626b">gsd_name_id_map_find</a></div><div class="ttdeci">static uint16_t gsd_name_id_map_find(struct gsd_name_id_map *map, const char *str)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00377">gsd.c:377</a></div></div>
<div class="ttc" id="agsd_8c_html_adf764cbdea00d65edcd07bb9953ad2b7af18592611faceacda42f0c336394bae2"><div class="ttname"><a href="gsd_8c.html#adf764cbdea00d65edcd07bb9953ad2b7af18592611faceacda42f0c336394bae2">GSD_INITIAL_NAME_BUFFER_SIZE</a></div><div class="ttdeci">@ GSD_INITIAL_NAME_BUFFER_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00051">gsd.c:51</a></div></div>
<div class="ttc" id="astructgsd__name__buffer_html_a78255aa2f730ed427a11debe378087c8"><div class="ttname"><a href="structgsd__name__buffer.html#a78255aa2f730ed427a11debe378087c8">gsd_name_buffer::data</a></div><div class="ttdeci">struct gsd_byte_buffer data</div><div class="ttdoc">Data.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00266">gsd.h:266</a></div></div>
<div class="ttc" id="agsd_8h_html_a03a578779769ed7e288df22c6a75f07ba4236f6900d8a81a3a4ccafa2170ad27c"><div class="ttname"><a href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba4236f6900d8a81a3a4ccafa2170ad27c">GSD_ERROR_FILE_CORRUPT</a></div><div class="ttdeci">@ GSD_ERROR_FILE_CORRUPT</div><div class="ttdoc">The GSD file is corrupt.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00087">gsd.h:87</a></div></div>
<div class="ttc" id="agsd_8h_html_a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96"><div class="ttname"><a href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba8400aca2d73ab6a20336bfdc2aa60b96">GSD_ERROR_IO</a></div><div class="ttdeci">@ GSD_ERROR_IO</div><div class="ttdoc">IO error. Check errno for details.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00075">gsd.h:75</a></div></div>
<div class="ttc" id="astructgsd__name__id__pair_html_a7ad4d0f48666c48af52cf76d54fffa71"><div class="ttname"><a href="structgsd__name__id__pair.html#a7ad4d0f48666c48af52cf76d54fffa71">gsd_name_id_pair::name</a></div><div class="ttdeci">char * name</div><div class="ttdoc">Pointer to name (actual name storage is allocated in gsd_handle)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00197">gsd.h:197</a></div></div>
<div class="ttc" id="agsd_8h_html_a03a578779769ed7e288df22c6a75f07ba4cca403d94a443c160073da8cf26a88b"><div class="ttname"><a href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba4cca403d94a443c160073da8cf26a88b">GSD_ERROR_NAMELIST_FULL</a></div><div class="ttdeci">@ GSD_ERROR_NAMELIST_FULL</div><div class="ttdoc">The GSD file cannot store any additional unique data chunk names.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00093">gsd.h:93</a></div></div>
<div class="ttc" id="astructgsd__name__id__pair_html_aa6fe10f8f10da3cf607289e051724fd0"><div class="ttname"><a href="structgsd__name__id__pair.html#aa6fe10f8f10da3cf607289e051724fd0">gsd_name_id_pair::id</a></div><div class="ttdeci">uint16_t id</div><div class="ttdoc">Entry id.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00203">gsd.h:203</a></div></div>
<div class="ttc" id="agsd_8c_html_a99fb83031ce9923c84392b4e92f956b5abe3e9ee339884a28a33d20ea27d0c8a7"><div class="ttname"><a href="gsd_8c.html#a99fb83031ce9923c84392b4e92f956b5abe3e9ee339884a28a33d20ea27d0c8a7">GSD_INITIAL_FRAME_INDEX_SIZE</a></div><div class="ttdeci">@ GSD_INITIAL_FRAME_INDEX_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00057">gsd.c:57</a></div></div>
<div class="ttc" id="agsd_8c_html_a7a717f9dafe011e68434e181c76253af"><div class="ttname"><a href="gsd_8c.html#a7a717f9dafe011e68434e181c76253af">gsd_byte_buffer_append</a></div><div class="ttdeci">static int gsd_byte_buffer_append(struct gsd_byte_buffer *buf, const char *data, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00491">gsd.c:491</a></div></div>
<div class="ttc" id="agsd_8c_html_ac1f41abbefbfe35337e7053d766c089b"><div class="ttname"><a href="gsd_8c.html#ac1f41abbefbfe35337e7053d766c089b">gsd_io_pread_retry</a></div><div class="ttdeci">static ssize_t gsd_io_pread_retry(int fd, void *buf, size_t count, int64_t offset)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00190">gsd.c:190</a></div></div>
<div class="ttc" id="astructgsd__index__entry_html_aa7ed270380c0d8074232aad5bb32bfb4"><div class="ttname"><a href="structgsd__index__entry.html#aa7ed270380c0d8074232aad5bb32bfb4">gsd_index_entry::id</a></div><div class="ttdeci">uint16_t id</div><div class="ttdoc">Index of the chunk name in the name list.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00181">gsd.h:181</a></div></div>
<div class="ttc" id="astructgsd__byte__buffer_html_a1be9afcc4aead755f0c37f93088fab1c"><div class="ttname"><a href="structgsd__byte__buffer.html#a1be9afcc4aead755f0c37f93088fab1c">gsd_byte_buffer::reserved</a></div><div class="ttdeci">size_t reserved</div><div class="ttdoc">Number of bytes available in the buffer.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00255">gsd.h:255</a></div></div>
<div class="ttc" id="agsd_8h_html_a5813a2a637516567a2b42dc745ec1118a8f2fc103d16a251246a102c5477fc0be"><div class="ttname"><a href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118a8f2fc103d16a251246a102c5477fc0be">GSD_TYPE_FLOAT</a></div><div class="ttdeci">@ GSD_TYPE_FLOAT</div><div class="ttdoc">32-bit floating point number.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00049">gsd.h:49</a></div></div>
<div class="ttc" id="agsd_8c_html_ab1d1a8a5f73b37df0c706f41df3bdd69"><div class="ttname"><a href="gsd_8c.html#ab1d1a8a5f73b37df0c706f41df3bdd69">gsd_sizeof_type</a></div><div class="ttdeci">size_t gsd_sizeof_type(enum gsd_type type)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l02177">gsd.c:2177</a></div></div>
<div class="ttc" id="agsd_8h_html_a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3"><div class="ttname"><a href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba2320e5bf0746477ebd58b6e261eebde3">GSD_SUCCESS</a></div><div class="ttdeci">@ GSD_SUCCESS</div><div class="ttdoc">Success.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00072">gsd.h:72</a></div></div>
<div class="ttc" id="astructgsd__name__id__pair_html"><div class="ttname"><a href="structgsd__name__id__pair.html">gsd_name_id_pair</a></div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00194">gsd.h:194</a></div></div>
<div class="ttc" id="agsd_8h_html_a5813a2a637516567a2b42dc745ec1118addc1aa49964e9df18eca95586854564e"><div class="ttname"><a href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118addc1aa49964e9df18eca95586854564e">GSD_TYPE_UINT8</a></div><div class="ttdeci">@ GSD_TYPE_UINT8</div><div class="ttdoc">Unsigned 8-bit integer.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00025">gsd.h:25</a></div></div>
<div class="ttc" id="astructgsd__header_html"><div class="ttname"><a href="structgsd__header.html">gsd_header</a></div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00127">gsd.h:127</a></div></div>
<div class="ttc" id="agsd_8h_html_a5813a2a637516567a2b42dc745ec1118a2bf7336e70f8d15921952b6ec177d238"><div class="ttname"><a href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118a2bf7336e70f8d15921952b6ec177d238">GSD_TYPE_DOUBLE</a></div><div class="ttdeci">@ GSD_TYPE_DOUBLE</div><div class="ttdoc">64-bit floating point number.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00052">gsd.h:52</a></div></div>
<div class="ttc" id="astructgsd__byte__buffer_html"><div class="ttname"><a href="structgsd__byte__buffer.html">gsd_byte_buffer</a></div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00246">gsd.h:246</a></div></div>
<div class="ttc" id="astructgsd__name__id__pair_html_ab2cafab77fcdd289751cacec8ec77d0f"><div class="ttname"><a href="structgsd__name__id__pair.html#ab2cafab77fcdd289751cacec8ec77d0f">gsd_name_id_pair::next</a></div><div class="ttdeci">struct gsd_name_id_pair * next</div><div class="ttdoc">Next name/id pair with the same hash.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00200">gsd.h:200</a></div></div>
<div class="ttc" id="astructgsd__index__entry_html"><div class="ttname"><a href="structgsd__index__entry.html">gsd_index_entry</a></div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00166">gsd.h:166</a></div></div>
<div class="ttc" id="agsd_8h_html_a03a578779769ed7e288df22c6a75f07bac5de89b0da97d4df5b52f18ee0977b7c"><div class="ttname"><a href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07bac5de89b0da97d4df5b52f18ee0977b7c">GSD_ERROR_FILE_MUST_BE_READABLE</a></div><div class="ttdeci">@ GSD_ERROR_FILE_MUST_BE_READABLE</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00103">gsd.h:103</a></div></div>
<div class="ttc" id="agsd_8h_html_a5813a2a637516567a2b42dc745ec1118a154cf53ac1f09d58516ee90c5e50ee9b"><div class="ttname"><a href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118a154cf53ac1f09d58516ee90c5e50ee9b">GSD_TYPE_UINT16</a></div><div class="ttdeci">@ GSD_TYPE_UINT16</div><div class="ttdoc">Unsigned 16-bit integer.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00028">gsd.h:28</a></div></div>
<div class="ttc" id="astructgsd__byte__buffer_html_a8ee2fd3c02e78149fe1b0ee269ce3965"><div class="ttname"><a href="structgsd__byte__buffer.html#a8ee2fd3c02e78149fe1b0ee269ce3965">gsd_byte_buffer::data</a></div><div class="ttdeci">char * data</div><div class="ttdoc">Data.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00249">gsd.h:249</a></div></div>
<div class="ttc" id="agsd_8c_html_a6c20ccb47eed1a3ea9995a47a8eebdbd"><div class="ttname"><a href="gsd_8c.html#a6c20ccb47eed1a3ea9995a47a8eebdbd">gsd_index_buffer_sort</a></div><div class="ttdeci">static int gsd_index_buffer_sort(struct gsd_index_buffer *buf)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00899">gsd.c:899</a></div></div>
<div class="ttc" id="agsd_8h_html_a23a9970f53fda4e8902697670300ec98a987636cdb7cdac06ae7173d291abec40"><div class="ttname"><a href="gsd_8h.html#a23a9970f53fda4e8902697670300ec98a987636cdb7cdac06ae7173d291abec40">GSD_OPEN_APPEND</a></div><div class="ttdeci">@ GSD_OPEN_APPEND</div><div class="ttdoc">Open only for writing.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00065">gsd.h:65</a></div></div>
<div class="ttc" id="astructgsd__header_html_a31b0992efad0ec0288ce7064f773dbda"><div class="ttname"><a href="structgsd__header.html#a31b0992efad0ec0288ce7064f773dbda">gsd_header::schema</a></div><div class="ttdeci">char schema[GSD_NAME_SIZE]</div><div class="ttdoc">Name of data schema.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00154">gsd.h:154</a></div></div>
<div class="ttc" id="agsd_8h_html_a5813a2a637516567a2b42dc745ec1118"><div class="ttname"><a href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118">gsd_type</a></div><div class="ttdeci">gsd_type</div><div class="ttdoc">Identifiers for the gsd data chunk element types.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00022">gsd.h:22</a></div></div>
<div class="ttc" id="agsd_8c_html_a726ca809ffd3d67ab4b8476646f26635a9e41ab940950d400d353438f87a6f559"><div class="ttname"><a href="gsd_8c.html#a726ca809ffd3d67ab4b8476646f26635a9e41ab940950d400d353438f87a6f559">GSD_CURRENT_FILE_VERSION</a></div><div class="ttdeci">@ GSD_CURRENT_FILE_VERSION</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00081">gsd.c:81</a></div></div>
<div class="ttc" id="agsd_8c_html_abc6126af1d45847bc59afa0aa3216b04add62126eb596d9d505d4f4c33062528e"><div class="ttname"><a href="gsd_8c.html#abc6126af1d45847bc59afa0aa3216b04add62126eb596d9d505d4f4c33062528e">GSD_WRITE_BUFFER_SIZE</a></div><div class="ttdeci">@ GSD_WRITE_BUFFER_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00063">gsd.c:63</a></div></div>
<div class="ttc" id="astructgsd__handle_html_a7ae49d668bbd61ce9d022acf5e5a9e76"><div class="ttname"><a href="structgsd__handle.html#a7ae49d668bbd61ce9d022acf5e5a9e76">gsd_handle::write_buffer</a></div><div class="ttdeci">struct gsd_byte_buffer write_buffer</div><div class="ttdoc">Buffered write data.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00299">gsd.h:299</a></div></div>
<div class="ttc" id="agsd_8h_html_a5813a2a637516567a2b42dc745ec1118a25b4572782ed785491f8b5b666692212"><div class="ttname"><a href="gsd_8h.html#a5813a2a637516567a2b42dc745ec1118a25b4572782ed785491f8b5b666692212">GSD_TYPE_INT64</a></div><div class="ttdeci">@ GSD_TYPE_INT64</div><div class="ttdoc">Signed 64-bit integer.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00046">gsd.h:46</a></div></div>
<div class="ttc" id="astructgsd__handle_html_a17f63ed60cc1f9e456bf2d5ce301ecf8"><div class="ttname"><a href="structgsd__handle.html#a17f63ed60cc1f9e456bf2d5ce301ecf8">gsd_handle::name_map</a></div><div class="ttdeci">struct gsd_name_id_map name_map</div><div class="ttdoc">Access the names in the namelist.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00317">gsd.h:317</a></div></div>
<div class="ttc" id="agsd_8c_html_a7479046d4d6e15c33cb24034ddd87562"><div class="ttname"><a href="gsd_8c.html#a7479046d4d6e15c33cb24034ddd87562">gsd_get_nframes</a></div><div class="ttdeci">uint64_t gsd_get_nframes(struct gsd_handle *handle)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l02029">gsd.c:2029</a></div></div>
<div class="ttc" id="agsd_8c_html_a61dadd085c1777f559549e05962b2c9ea09f6f8b0215767f2ed4321a8e26cc287"><div class="ttname"><a href="gsd_8c.html#a61dadd085c1777f559549e05962b2c9ea09f6f8b0215767f2ed4321a8e26cc287">GSD_NAME_MAP_SIZE</a></div><div class="ttdeci">@ GSD_NAME_MAP_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00075">gsd.c:75</a></div></div>
<div class="ttc" id="astructgsd__handle_html_a0b9b163d35869b802a8937e958ea410c"><div class="ttname"><a href="structgsd__handle.html#a0b9b163d35869b802a8937e958ea410c">gsd_handle::header</a></div><div class="ttdeci">struct gsd_header header</div><div class="ttdoc">The file header.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00287">gsd.h:287</a></div></div>
<div class="ttc" id="agsd_8c_html_ab7b8e133941184a32c2d90414dfba6a5"><div class="ttname"><a href="gsd_8c.html#ab7b8e133941184a32c2d90414dfba6a5">gsd_heap_parent</a></div><div class="ttdeci">static size_t gsd_heap_parent(size_t i)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00814">gsd.c:814</a></div></div>
<div class="ttc" id="agsd_8c_html_adc29c2ff13d900c2f185ee95427fb06ca4cede151f20532731cb30ac33609508f"><div class="ttname"><a href="gsd_8c.html#adc29c2ff13d900c2f185ee95427fb06ca4cede151f20532731cb30ac33609508f">GSD_COPY_BUFFER_SIZE</a></div><div class="ttdeci">@ GSD_COPY_BUFFER_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00069">gsd.c:69</a></div></div>
<div class="ttc" id="astructgsd__header_html_aabd428d9147218283e07bad362c522da"><div class="ttname"><a href="structgsd__header.html#aabd428d9147218283e07bad362c522da">gsd_header::namelist_allocated_entries</a></div><div class="ttdeci">uint64_t namelist_allocated_entries</div><div class="ttdoc">Number of bytes in the namelist divided by GSD_NAME_SIZE.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00142">gsd.h:142</a></div></div>
<div class="ttc" id="agsd_8c_html_ae1948c93f77d642c4e3797fe7e5f2095"><div class="ttname"><a href="gsd_8c.html#ae1948c93f77d642c4e3797fe7e5f2095">gsd_index_buffer_allocate</a></div><div class="ttdeci">static int gsd_index_buffer_allocate(struct gsd_index_buffer *buf, size_t reserve)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00558">gsd.c:558</a></div></div>
<div class="ttc" id="astructgsd__index__entry_html_a0fd668ac1b940ccb0b22793709145091"><div class="ttname"><a href="structgsd__index__entry.html#a0fd668ac1b940ccb0b22793709145091">gsd_index_entry::flags</a></div><div class="ttdeci">uint8_t flags</div><div class="ttdoc">Flags (for internal use).</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00187">gsd.h:187</a></div></div>
<div class="ttc" id="agsd_8c_html_a6c8c2e5a49ac4eb01a95be2e0df06eb9"><div class="ttname"><a href="gsd_8c.html#a6c8c2e5a49ac4eb01a95be2e0df06eb9">gsd_name_id_map_insert</a></div><div class="ttdeci">static int gsd_name_id_map_insert(struct gsd_name_id_map *map, const char *str, uint16_t id)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00318">gsd.c:318</a></div></div>
<div class="ttc" id="agsd_8h_html_a03a578779769ed7e288df22c6a75f07ba72c4d63d4cbec5412ab1ab57716afe80"><div class="ttname"><a href="gsd_8h.html#a03a578779769ed7e288df22c6a75f07ba72c4d63d4cbec5412ab1ab57716afe80">GSD_ERROR_INVALID_GSD_FILE_VERSION</a></div><div class="ttdeci">@ GSD_ERROR_INVALID_GSD_FILE_VERSION</div><div class="ttdoc">The GSD file version cannot be read.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00084">gsd.h:84</a></div></div>
<div class="ttc" id="agsd_8c_html_a61daeaa70162e9bac3d241832b460278"><div class="ttname"><a href="gsd_8c.html#a61daeaa70162e9bac3d241832b460278">gsd_flush_write_buffer</a></div><div class="ttdeci">static int gsd_flush_write_buffer(struct gsd_handle *handle)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l01081">gsd.c:1081</a></div></div>
<div class="ttc" id="agsd_8c_html_accc971ec12e75a165ffef6e1ee854681"><div class="ttname"><a href="gsd_8c.html#accc971ec12e75a165ffef6e1ee854681">gsd_heap_shift_down</a></div><div class="ttdeci">static void gsd_heap_shift_down(struct gsd_index_buffer *buf, size_t start, size_t end)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00847">gsd.c:847</a></div></div>
<div class="ttc" id="agsd_8c_html_a06fc87d81c62e9abb8790b6e5713c55bab2d4762a429d1bedec72663852e3c4ba"><div class="ttname"><a href="gsd_8c.html#a06fc87d81c62e9abb8790b6e5713c55bab2d4762a429d1bedec72663852e3c4ba">GSD_INITIAL_INDEX_SIZE</a></div><div class="ttdeci">@ GSD_INITIAL_INDEX_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8c_source.html#l00045">gsd.c:45</a></div></div>
<div class="ttc" id="astructgsd__header_html_a62903e5e531a982796c3a5133ff18b85"><div class="ttname"><a href="structgsd__header.html#a62903e5e531a982796c3a5133ff18b85">gsd_header::magic</a></div><div class="ttdeci">uint64_t magic</div><div class="ttdoc">Magic number marking that this is a GSD file.</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00130">gsd.h:130</a></div></div>
<div class="ttc" id="astructgsd__index__buffer_html_aa4cf014343ec2746f964695d5502cc87"><div class="ttname"><a href="structgsd__index__buffer.html#aa4cf014343ec2746f964695d5502cc87">gsd_index_buffer::mapped_data</a></div><div class="ttdeci">void * mapped_data</div><div class="ttdoc">Pointer to mapped data (NULL if not mapped)</div><div class="ttdef"><b>Definition:</b> <a href="gsd_8h_source.html#l00235">gsd.h:235</a></div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_5619d3ff040d238c5bcfe0ac1235817d.html">data_io</a></li><li class="navelem"><a class="el" href="gsd_8c.html">gsd.c</a></li>
    <li class="footer">Generated on Thu Oct 14 2021 10:34:12 for BodiesinPotentialFlow by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
